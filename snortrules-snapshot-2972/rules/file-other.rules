# Copyright 2001-2015 Sourcefire, Inc. All Rights Reserved.
#
# This file contains (i) proprietary rules that were created, tested and certified by
# Sourcefire, Inc. (the "VRT Certified Rules") that are distributed under the VRT
# Certified Rules License Agreement (v 2.0), and (ii) rules that were created by
# Sourcefire and other third parties (the "GPL Rules") that are distributed under the
# GNU General Public License (GPL), v2.
# 
# The VRT Certified Rules are owned by Sourcefire, Inc. The GPL Rules were created
# by Sourcefire and other third parties. The GPL Rules created by Sourcefire are
# owned by Sourcefire, Inc., and the GPL Rules not created by Sourcefire are owned by
# their respective creators. Please see http://www.snort.org/snort/snort-team/ for a
# list of third party owners and their respective copyrights.
# 
# In order to determine what rules are VRT Certified Rules or GPL Rules, please refer
# to the VRT Certified Rules License Agreement (v2.0).
#
#------------------
# FILE-OTHER RULES
#------------------

# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Multiple products dwmapi.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|dwmapi.dll"; nocase; http_uri; metadata:service http; reference:bugtraq,62836; reference:cve,2010-3127; reference:cve,2010-3131; reference:cve,2010-3191; reference:cve,2010-3976; reference:cve,2013-0733; reference:cve,2013-3485; reference:url,osvdb.org/show/osvdb/96228; reference:url,osvdb.org/show/osvdb/98163; reference:url,www.adobe.com/support/security/bulletins/apsb10-26.html; classtype:attempted-user; sid:19620; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER heapspray characters detected - binary"; flow:to_client,established; flowbits:isnotset,file.jpeg; file_data; content:"|0C 0C 0C 0C 0C 0C 0C 0C|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:attempted-user; sid:23861; rev:11;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER heapspray characters detected - binary"; flow:to_server,established; flowbits:isnotset,file.jpeg; file_data; content:"|0C 0C 0C 0C 0C 0C 0C 0C|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:attempted-user; sid:23858; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ClamAV MEW PE file integer overflow attempt"; flow:to_client,established; file_data; content:"MZ"; depth:2; content:"PE"; content:"MEW"; content:!"|00|"; within:1; distance:8; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,26927; reference:cve,2007-6335; classtype:attempted-user; sid:13361; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER NOD32 Anti-Virus ARJ Archive Handling Buffer Overflow attempt"; flow:to_client,established; file_data; content:"|60 EA|"; depth:2; byte_jump:2,0,relative,little; content:"|60 EA|"; within:2; distance:6; byte_test:2,>,256,0,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,14773; reference:cve,2005-2903; classtype:attempted-admin; sid:17356; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Nullsoft Winamp XM file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xm; file_data; content:"Extended Module|3A 20|"; nocase; byte_test:1,!=,26,20,relative; metadata:ruleset community, service ftp-data, service http, service imap, service pop3; reference:cve,2004-1896; reference:url,www.securityfocus.com/bid/10045; classtype:attempted-user; sid:2550; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GNOME Project libxslt RC4 key string buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"xsl|3A|stylesheet"; fast_pattern; nocase; content:"crypto|3A|rc4_"; nocase; pcre:"/^(encrypt|decrypt)\x28\x27[^\x27]{129}/smiR"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,30467; reference:cve,2008-2935; classtype:attempted-user; sid:14039; rev:19;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ClamAV CHM File Handling Integer Overflow attempt"; flow:to_client,established; flowbits:isset,file.chm; file_data; content:"|50 4D 47 4C 4A 0D 00 00 00 00 00 00 FF FF FF FF FF FF FF FF 01 2F 00 00 00 8F FF FF FF 7F 58 48 44 52|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,14359; reference:cve,2005-2450; classtype:attempted-user; sid:17352; rev:12;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Video Spirit visprj buffer overflow"; flow:established,to_client; flowbits:isset,file.visprj; file_data; content:"valitem"; nocase; pcre:"/<\s*valitem[^>]*\s(value|name)\s*=\s*([\x22\x27])[^\x22\x27]{104}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0499; classtype:attempted-user; sid:20889; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Autodesk 3D Studio Maxscript dangerous scripting method attempt"; flow:to_client,established; flowbits:isset,file.autodesk_max; file_data; content:"WriteString"; fast_pattern:only; content:"fopen"; nocase; pcre:"/^\s+(\w+)\s+\x22wb?\x22/R"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,36634; reference:cve,2009-3577; classtype:attempted-user; sid:20870; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Autodesk Maya dangerous scripting method attempt"; flow:to_client,established; flowbits:isset,file.autodesk_ma; file_data; content:"requires maya"; fast_pattern:only; content:"fopen"; nocase; content:"fwrite"; distance:0; nocase; pcre:"/(?P<q1>\x24\w+)\s*=\s*\x60\s*fopen[^\x60]*[\x22\x27]wb?.+?fwrite\s+(?P=q1)/i"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,36636; reference:cve,2009-3578; classtype:attempted-user; sid:20861; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER DAZ Studio dangerous scripting method attempt"; flow:to_client,established; flowbits:isset,file.daz_ds; file_data; content:"DzFile"; fast_pattern:only; pcre:"/var\s+(?P<q1>\w+)\s+=\s+new\s+DzFile.+?(?P=q1)\.open\(\s*2\s*\)/ms"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,37176; reference:cve,2009-4148; classtype:attempted-user; sid:20853; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ESTsoft ALZip MIM file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.mime; file_data; content:"Content-Type"; fast_pattern:only; content:"name"; nocase; content:"="; within:5; isdataat:300,relative; content:!"|3B|"; within:300; content:!"|0A|"; within:302; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1336; reference:url,osvdb.org/show/osvdb/73684; classtype:attempted-user; sid:20034; rev:16;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director remote code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"muhT|9B 00 00 00 00 04 00 00|FCRD|A8 00 00 00|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2874; classtype:attempted-user; sid:17193; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director remote code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"EyeL|04 00 00 00 01 00 00 00 42 00 00 00 70 00 00 00 99 00 00 00 56 55 55 15|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2871; classtype:attempted-user; sid:17190; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|32 02 30 82 02 31 30 02 38 38 02 30 82 02 31 30 02 38 38 03 30 30 30 41 30 30 30 30 30 30 31 33 00 00 30 30 30 30 30 32 02 30 82 02 31 30 02 38|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2879; classtype:attempted-user; sid:17197; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director remote code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|00 23 6F 98 00 00 00 00 00 00 00 62 00 00 00 01 00 0F FF FF|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2873; classtype:attempted-user; sid:17192; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|01 36 01 00 00 00 80 80 00 00 00 15 00 00 00 03 00 00 00 27 00 00 00 24 00 00 00 02 00 00 00 06 00 00 00 00 00 00 00 00 00 00 00 06 00 01 00 00 00 0F E1 FD|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2877; classtype:attempted-user; sid:17196; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director remote code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"39VMpami|18 00 00 00 01 41 41 41 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2872; classtype:attempted-user; sid:17191; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|6D 9E 54 65 78 74 00 00 00 00 00 00 00 00 00 00 00 00 0F 00 00 01 1A 3A 36 23 16 3A 37 0C 29 47 72 65 67 20 42 61 72 6E 65 74 74 00 80 80 00 04 74 65 78 74 00 00|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2878; classtype:attempted-user; sid:17198; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows MPEG Layer-3 audio heap corruption attempt"; flow:to_client,established; flowbits:isset,file.asx; file_data; content:"|FF FA 92 60 3C 6F|"; content:"|FF FA 92 C9 B9 56|"; within:6; distance:412; fast_pattern; content:"|A9 00 04 48 58 DC E1 83 4B 68 32 01 9B BC 04 A3 27 0E A5 3D 71 66 0D 2D A8 D3 84 AF 3C 14 88 94 3E 89 CA BF 80 9C|"; within:38; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-1882; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-052; classtype:attempted-user; sid:18463; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file tSAC tag exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|FF FF 00 00|shockwave3d|00 00 01|P3DPR|00 00 01|P|00 00 00 06 00 00 00 01|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,42668; reference:cve,2010-2875; reference:url,www.adobe.com/support/security/bulletins/apsb10-20.html; classtype:attempted-user; sid:17194; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Flash arbitrary memory access attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"BB|00 00 03|PAA|00 00 03|P|00 05 00 00 03|h"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-3465; reference:url,www.adobe.com/support/security/bulletins/apsb09-16.html; classtype:attempted-user; sid:16225; rev:14;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows C Run-Time Library remote code execution attempt"; flow:to_client,established; flowbits:isset,file.asx; file_data; content:"<ASX"; fast_pattern; nocase; content:"VERSION"; within:50; nocase; pcre:"/<ASX[^>]*?VERSION\s*=\s*[0-9\x22\x27][0-9\x2e]{20}/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0150; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-013; classtype:attempted-user; sid:21308; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows download of .lnk file that executes cmd.exe detected"; flow:to_client,established; flowbits:isset,file.lnk; file_data; content:"WINDOWS|5C|system32|5C|cmd|2E|exe"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,15069; reference:cve,2005-2122; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-049; classtype:attempted-user; sid:17442; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Visual Studio .addin file access"; flow:to_client,established; flowbits:isset,file.addin; file_data; content:"<Assembly>"; fast_pattern; nocase; content:".dll"; distance:1; nocase; content:"</Assembly>"; distance:0; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-0008; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-021; classtype:attempted-user; sid:21576; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Visual Studio PKP file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pkp; file_data; content:"|22|projectname|22| = |22|"; nocase; content:!"|22|"; within:200; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2006-1043; reference:url,www.securityfocus.com/bid/16953; classtype:attempted-user; sid:22030; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Visual Studio DBP file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.dbp; file_data; content:"dataproject = |22|"; nocase; content:!"|22|"; within:200; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2006-1043; reference:url,www.securityfocus.com/bid/16953; classtype:attempted-user; sid:22029; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Visual Studio SLN file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.sln; file_data; content:"Project"; nocase; pcre:"/^\x28\x22[^\x22]+\x22\x29\s*\x3d\s*\x22[^\x22]{200}/iR"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2006-1043; reference:url,www.securityfocus.com/bid/16953; classtype:attempted-user; sid:22031; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Visual Studio VAP file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.vap; file_data; content:"|22|projectname|22| = |22|"; nocase; content:!"|22|"; within:200; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2006-1043; reference:url,www.securityfocus.com/bid/16953; classtype:attempted-user; sid:22032; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows True Type Font maxComponentPoints overflow attempt"; flow:to_client,established; flowbits:isset,file.ttf; file_data; content:"|00 01 00 00|"; depth:4; content:"maxp"; depth:250; byte_jump:4,4,relative,from_beginning, post_offset 10,big; byte_test:2,>,0x8000,0,relative,big; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0159; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-034; classtype:attempted-user; sid:22087; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Novell Groupwise Addressbook buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.nab; file_data; content:":::TAGMAP:::"; fast_pattern:only; content:"|2C|"; isdataat:750,relative; content:!"|2C|"; within:750; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,52233; reference:bugtraq,55729; reference:cve,2011-4189; reference:cve,2012-0418; reference:url,novell.com/support/kb/doc.php?id=7010205; reference:url,novell.com/support/kb/doc.php?id=7010771; reference:url,osvdb.org/show/osvdb/79720; reference:url,osvdb.org/show/osvdb/85802; classtype:attempted-user; sid:22947; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Photoshop asset elements stack based buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.collada; content:"<COLLADA"; content:"<asset>"; distance:0; content:">"; distance:0; isdataat:2048,relative; content:!"</"; within:2048; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,53464; reference:url,osvdb.org/show/osvdb/81832; classtype:attempted-user; sid:23014; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER OpenType Font file integer overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"OTTO"; depth:4; content:"cmap"; within:200; content:"name"; within:200; byte_test:4,>=,0x80000000,4,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2010-2741; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-078; classtype:attempted-user; sid:23154; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER OpenType Font file integer overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"OTTO"; depth:4; content:"cmap"; within:200; content:"head"; within:200; byte_test:4,>=,0x80000000,8,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2010-2741; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-078; classtype:attempted-user; sid:23153; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER OpenType Font file integer overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"OTTO"; depth:4; content:"cmap"; within:200; content:"name"; within:200; byte_test:4,>=,0x80000000,8,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2010-2741; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-078; classtype:attempted-user; sid:23155; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER OpenType Font file integer overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"OTTO"; depth:4; content:"cmap"; within:200; content:"head"; within:200; byte_test:4,>=,0x80000000,4,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2741; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-078; classtype:attempted-user; sid:23152; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ELF multiple antivirus evasion attempts"; flow:to_client,established; file_data; content:"|7F|ELF"; depth:4; content:"ustar"; depth:5; offset:257; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1429; classtype:attempted-user; sid:23318; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML Style attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"karaoke"; distance:0; content:"color="; distance:0; pcre:"/color\x3d\s*?[\x22\x27][^\x22\x27]{20}/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0663; classtype:attempted-user; sid:23465; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML description attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"description"; distance:0; content:"backgroundColor|3A|"; pcre:"/^\s*[^\x3e]{62}/Rsmi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0663; classtype:attempted-user; sid:23464; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; file_data; content:"|4A 46 49 46|"; depth:4; offset:6; content:"ustar"; depth:5; offset:257; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1428; classtype:attempted-user; sid:23358; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ACDSee FotoSlate PLP file buffer overflow attempt"; flow:established,to_client; flowbits:isset,file.plp; file_data; content:"<int"; fast_pattern:only; pcre:"/<int[^>]*?id\s*=\s*(\x22|\x27)[^\x22\x27]{50}/i"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49558; reference:cve,2011-2595; classtype:attempted-user; sid:23479; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"|19 04 00 10|"; depth:4; offset:8; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1424; classtype:attempted-user; sid:23326; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ACDSee FotoSlate PLP file buffer overflow attempt"; flow:established,to_client; flowbits:isset,file.plp; file_data; content:"<string"; fast_pattern:only; pcre:"/<string[^>]*?id\s*=\s*(\x22|\x27)[^\x22\x27]{50}/i"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49558; reference:cve,2011-2595; classtype:attempted-user; sid:23478; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"|50 4B 03 04|"; depth:4; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1425; classtype:attempted-user; sid:23325; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML sampleData attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"sampleData"; distance:0; content:"highlightColor|3A|"; pcre:"/^\s*[^\x3e]{62}/Rsmi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0663; classtype:attempted-user; sid:23463; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"MZ"; depth:2; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1423; classtype:attempted-user; sid:23327; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"[aliases]"; depth:9; nocase; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1419; classtype:attempted-user; sid:23351; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; file_data; content:"|7F|ELF"; depth:4; content:"ustar"; depth:5; offset:257; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1420; classtype:attempted-user; sid:23323; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime JPEG2000 length integer underflow attempt"; flow:to_client,established; file_data; content:"|6A 50 20 20|"; depth:4; offset:4; byte_jump:4,-8,relative; content:"|66 74 79 70|"; within:4; byte_jump:4,-8,relative; content:"|6A 70 32 68|"; within:4; byte_jump:4,-8,relative; content:"|6A 70 32 63 FF 4F FF 51|"; distance:0; byte_jump:2,0,relative; content:"|FF 52|"; within:2; distance:-2; byte_test:2,<,12,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-3250; classtype:attempted-user; sid:23400; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML Style attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"style"; distance:0; content:"color|3A|"; distance:0; pcre:"/color\x3a\s*?[^\x7d]{62}/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0663; classtype:attempted-user; sid:23462; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; file_data; content:"ITSF"; depth:4; content:"ustar"; depth:5; offset:257; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1422; classtype:attempted-user; sid:23328; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"BZh"; depth:3; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1426; classtype:attempted-user; sid:23324; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle outside in Lotus 1-2-3 heap overflow attempt"; flow:to_client,established; flowbits:isset,file.wk4; file_data; content:"|1B 00|"; byte_test:2,>,1024,0,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0110; reference:url,osvdb.org/show/osvdb/76571; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20111026-webex; classtype:attempted-user; sid:23346; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML Transform attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"transform"; distance:0; pcre:"/^\s*\x3d\s*[\x27\x22](translate|matrix)[^\x27\x22]{62}/Rsmi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0663; classtype:attempted-user; sid:23461; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ELF multiple antivirus evasion attempts"; flow:to_client,established; flowbits:isset,file.elf; file_data; content:"|19 04 00 10|"; depth:4; offset:8; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1430; classtype:attempted-user; sid:23357; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; file_data; content:"MSCF"; depth:4; content:"ustar"; depth:5; offset:257; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1421; classtype:attempted-user; sid:23329; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime TeXML sampleData attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"sampleData"; distance:0; content:"highlightColor|3A|"; pcre:"/^\s*[^\x3e]{62}/Rsmi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-0663; classtype:attempted-user; sid:23584; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows malformed ASF voice codec memory corruption attempt"; flow:to_server,established; file_data; content:"@|9E|i|F8|M[|CF 11 A8 FD 00 80|_|5C|D+"; isdataat:46,relative; pcre:"/^.{38}\x0a\x00..(?!(\x40\x1f|\x11\x2b|\x80\x3e|\x22\x56)\x00\x00)/R"; metadata:service smtp; reference:cve,2009-0555; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-051; classtype:attempted-user; sid:23578; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER VLC mms hostname buffer overflow attempt"; flow:to_server,established; file_data; content:"mms|3A 2F 2F|"; nocase; isdataat:4018,relative; pcre:"/^[^\x22\x27]{4018}/R"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1775; reference:url,osvdb.org/show/osvdb/80188; reference:url,www.videolan.org/security/sa1201.html; classtype:attempted-user; sid:23577; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Task Scheduler buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.job; file_data; content:"|00 14 73 0F|"; depth:4; offset:36; content:"|00 3A 00 5C|"; within:4; distance:33; byte_test:2,>,260,-7,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,10708; reference:cve,2004-0212; classtype:attempted-user; sid:23489; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft MHTML XSS attempt"; flow:to_server,established; flowbits:isset,file.mht; file_data; content:"MIME-Version"; fast_pattern:only; pcre:"/(\x3C\s*script|onload|onclick|onmouseover)/ims"; metadata:service smtp; reference:cve,2011-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-026; classtype:attempted-user; sid:23562; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime TeXML Style attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"style"; distance:0; content:"color|3A|"; pcre:"/^\s*[^\x7d]{62}/Rsmi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-0663; classtype:attempted-user; sid:23583; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows MHTML XSS attempt"; flow:to_server,established; file_data; content:"mhtml|3A|"; pcre:"/(location\x2ereplace\x28|window\x2elocation\x2ehref\s*?=|iframe\s*?src\s*?=|a\s*?href\s*?=)\s*?[\x22\x27]mhtml\x3a(http|file)\x3a\x2f\x2f/Rsmi"; metadata:service smtp; reference:cve,2011-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-026; classtype:attempted-user; sid:23563; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime TeXML Transform attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"transform"; distance:0; pcre:"/^\s*\x3d\s*[\x27\x22](translate|matrix)[^\x27\x22]{62}/Rsmi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-0663; classtype:attempted-user; sid:23582; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Illustrator DSC comment overflow attempt"; flow:to_server,established; file_data; content:"%!PS-Adobe-"; nocase; content:"EPSF-"; within:10; pcre:"/%[^\x0d\x0a]{1000}/smiR"; metadata:service smtp; reference:bugtraq,37192; reference:cve,2009-4195; classtype:attempted-user; sid:23564; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime TeXML description attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"description"; distance:0; content:"backgroundColor|3A|"; pcre:"/^\s*[^\x3e]{62}/Rsmi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-0663; classtype:attempted-user; sid:23585; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Embedded Open Type Font malformed name table overflow attempt"; flow:to_server,established; flowbits:isset,file.eot; file_data; content:"|00 01 00 01 00 00 00 01 FF FF|"; fast_pattern:only; metadata:service smtp; reference:cve,2009-0231; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-029; classtype:attempted-user; sid:23566; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Novell Groupwise Addressbook buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.nab; file_data; content:":::TAGMAP:::"; fast_pattern:only; content:"|2C|"; isdataat:750,relative; content:!"|2C|"; within:750; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,52233; reference:bugtraq,55729; reference:cve,2011-4189; reference:cve,2012-0418; reference:url,novell.com/support/kb/doc.php?id=7010205; reference:url,novell.com/support/kb/doc.php?id=7010771; reference:url,osvdb.org/show/osvdb/79720; reference:url,osvdb.org/show/osvdb/85802; classtype:attempted-user; sid:23580; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime TeXML Style attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"karaoke"; distance:0; content:"color|3A|"; pcre:"/^\s*[^\x7d]{62}/Rsmi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-0663; classtype:attempted-user; sid:23586; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Outside-In JPEG2000 QCD segment processing heap buffer overflow attempt"; flow:established,to_client; flowbits:isset,file.jp2; file_data; content:"|00 00 00 0C 6A 50 20 20|"; depth:8; content:"|6A 70 32 63|"; distance:0; content:"|FF 5C|"; within:70; byte_test:2,>,840,0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,54500; reference:cve,2012-1769; classtype:attempted-admin; sid:23806; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Sophos Anti-Virus zip file handling DoS attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"PK|03 04|"; content:"|0C 00|"; within:2; distance:4; content:"-|00 00 00 F9 00 00 00 05 00 FF FF|"; within:12; distance:8; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,14270; reference:cve,2005-1530; classtype:attempted-dos; sid:15957; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER PeaZip command injection attempt"; flow:established,to_client; flowbits:isset,file.zip; content:"README.TXT"; nocase; pcre:"/^\s*\x22?\s+\x22\s*\x7C[^\x7C]+\x7C\s*\.txt/R"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-2261; reference:url,osvdb.org/show/osvdb/54966; classtype:attempted-user; sid:21413; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer compressed skin overflow attempt"; flow:established,to_client; flowbits:isset,file.zip; file_data; content:"PK|01 02|"; depth:4; byte_test:4,>,33412,24,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,11555; reference:cve,2004-1094; classtype:attempted-user; sid:21420; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple OSX ZIP archive shell script execution attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"__MACOSX/._"; pcre:"/^[A-Za-z0-9\\x2b-]+?\.(mov|jpg)\x55/Ri"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,16736; reference:cve,2006-0848; reference:url,docs.info.apple.com/article.html?artnum=303382 ; reference:url,osvdb.org/show/osvdb/23510; classtype:attempted-user; sid:21557; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ZIP file name overflow attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"PK|03 04|"; depth:4; byte_test:2,>,128,22,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,41333; reference:bugtraq,46375; reference:cve,2004-1094; reference:cve,2010-3227; reference:cve,2011-4535; classtype:attempted-user; sid:21484; rev:14;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx recording integer overflow attempt"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 00 00 00 00 00 02|"; fast_pattern; content:"|BB|"; within:1; distance:-15; content:"|01|"; within:1; distance:50; byte_test:4,>=,0x15555555,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,52882; reference:cve,2012-1336; reference:url,osvdb.org/show/osvdb/81105; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120404-webex; classtype:attempted-user; sid:23269; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Agent Helper Malicious JAR download attempt"; flow:to_client,established; flowbits:isset,file.jar.agent_helper; file_data; content:"META-INF/MANIFEST.MF"; nocase; isdataat:128,relative; flowbits:unset,file.jar.agent_helper; content:!"META-INF/MICCORJA.SF"; nocase; content:!"META-INF/MICCORJA.RSA"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1969; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-079; classtype:attempted-user; sid:20259; rev:15;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_client,established; flowbits:isset,file.mid; file_data; content:"|4D 54 68 64|"; depth:4; content:"|4D 54 72 6B 00 00 01 74 00 C9 01 00 9F FF 7F 00 99 23 7F 78 89|"; distance:0; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:20900; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer zipped skin file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.rjs&file.zip; file_data; content:"|50 4B 03 04 14 00 00 00 08 00 91 98 6E 33 EB 71 F9 B3 1D 00 00 00 00 01 00 00 0B 00 00 00 53 68 75 66 66 6C 65 2E 62 6D 70 73 F2 DD C1 E5 08 04|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,15382; reference:cve,2005-2630; classtype:attempted-user; sid:17461; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle JDK image parsing library ICC buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"|BC 08 59 03 02 54 59 04 10 D8 54 59 05 02 54 59|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,24004; reference:cve,2007-2788; reference:url,scary.beasts.org/security/CESA-2006-004.html; classtype:attempted-user; sid:17727; rev:14;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_client,established; flowbits:isset,file.mid; file_data; content:"|00 B9 07 64 00 B9 0A 40 00 B9 7B 00 00 B9 5B 28 00 B9 5D 00 85 50 99 23|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:21167; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_client,established; flowbits:isset,file.mid; file_data; content:"|7F 00 43 7F 82 68 43 00 04 3C 00 14 3C 7F 00 43 7C 82 6C 3C 00 00 43 00 14 43 7F 00 3C 7E 82 68|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:21159; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle outside in Lotus 1-2-3 heap overflow attempt"; flow:to_server,established; flowbits:isset,file.wk4; file_data; content:"|1B 00|"; byte_test:2,>,1024,0,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-0110; reference:url,osvdb.org/show/osvdb/76571; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20111026-webex; classtype:attempted-user; sid:24029; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_server,established; flowbits:isset,file.mid; file_data; content:"|00 B9 07 64 00 B9 0A 40 00 B9 7B 00 00 B9 5B 28 00 B9 5D 00 85 50 99 23|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:24003; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_client,established; flowbits:isset,file.mid; file_data; content:"|9F 92 7F 00 9F B2 00 00 99 23 7F 78 89 23 7F 00 23 7F 78 23 7F 78 23 7F 78 23 7F 00 99 23 7F 78|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:23999; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_server,established; file_data; content:"|4D 54 68 64|"; depth:4; content:"|4D 54 72 6B 00 00 01 74 00 C9 01 00 9F FF 7F 00 99 23 7F 78 89|"; distance:0; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:24002; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_server,established; flowbits:isset,file.mid; file_data; content:"|7F 00 43 7F 82 68 43 00 04 3C 00 14 3C 7F 00 43 7C 82 6C 3C 00 00 43 00 14 43 7F 00 3C 7E 82 68|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:24001; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_server,established; flowbits:isset,file.mid; file_data; content:"|9F 92 7F 00 9F B2 00 00 99 23 7F 78 89 23 7F 00 23 7F 78 23 7F 78 23 7F 78 23 7F 00 99 23 7F 78|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:24000; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Winamp skin file arbitrary code execution attempt"; flow:established,to_server; flowbits:isset,file.zip; flowbits:isset,file.winampskin; file_data; content:"PK|03 04|"; depth:4; content:".exe"; metadata:service smtp; reference:bugtraq,11053; reference:cve,2004-0820; classtype:attempted-user; sid:24052; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Winamp skin file arbitrary code execution attempt"; flow:established,to_client; flowbits:isset,file.zip; flowbits:isset,file.winampskin; file_data; content:"PK|03 04|"; depth:4; content:".exe"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,11053; reference:cve,2004-0820; classtype:attempted-user; sid:24051; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"FILE-OTHER technote main.cgi file directory traversal attempt"; flow:to_server,established; content:"/technote/main.cgi"; fast_pattern; nocase; http_uri; content:"filename="; nocase; content:"../../"; metadata:ruleset community, service http; reference:bugtraq,2156; reference:cve,2001-0075; reference:nessus,10584; classtype:web-application-attack; sid:1051; rev:23;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER F-Secure AntiVirus library heap overflow attempt"; flow:to_client,established; flowbits:isset,file.arj; file_data; content:"|0A|`|EA|"; pcre:"/\x0a\x0d?\x0a\x60\xea(.{36}[^\x00]{256}|.+\x60\xea.{32}[^\x00]{256})/s"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,12515; reference:cve,2005-0350; classtype:attempted-user; sid:15583; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Flash memory corruption attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|FF FF FF FF 01 1F 02|H|00 00 00|6|00 00 FF FF 01 1F 1F EE|"; content:!"|FF FF FF FF|"; within:4; distance:-24; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-3463; classtype:attempted-user; sid:16293; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave DIR file PAMI chunk code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"XFIR"; depth:4; content:"pami"; distance:0; byte_test:4,>,0x7FFFFFFF,4,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-1292; reference:url,secunia.com/advisories/38751/; reference:url,www.adobe.com/support/security/bulletins/apsb10-12.html; classtype:attempted-user; sid:16673; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple OSX Finder DMG volume name memory corruption attempt"; flow:to_client,established; flowbits:isset,file.dmg; file_data; content:"|00 00 00 00 00 00 00 00|LABL"; byte_test:2,>,254,12,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2007-0197; classtype:attempted-user; sid:17363; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Director rcsL chunk memory corruption attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"rcsL"; isdataat:203,relative; content:"|FF F0 02 67|"; within:4; distance:203; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,42682; reference:cve,2010-2873; reference:url,www.adobe.com/support/security/bulletins/apsb10-20.html; classtype:attempted-user; sid:17803; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Director pamm chunk memory corruption attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"XFIR"; depth:4; content:"pamm"; distance:4; byte_test:2,>,0x14,6,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-4084; reference:url,www.adobe.com/support/security/bulletins/apsb10-25.html; classtype:attempted-user; sid:18776; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Player Lnam chunk processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"Lnam|00 00|"; content:!"|00 00|"; within:2; distance:20; content:"|FF|"; within:1; distance:22; isdataat:256; content:!"|00|"; within:256; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,44516; reference:cve,2010-3655; reference:url,www.adobe.com/support/security/bulletins/apsb10-25.html; classtype:attempted-user; sid:19011; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Player Lnam chunk processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"manL"; content:"|00 00|"; within:2; distance:2; content:!"|00 00|"; within:2; distance:18; content:"|FF|"; within:1; distance:20; isdataat:256,relative; content:!"|00|"; within:256; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,44516; reference:cve,2010-3655; reference:url,www.adobe.com/support/security/bulletins/apsb10-25.html; classtype:attempted-user; sid:19012; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file tSAC record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"tSAC|B7 00 00 00 00 00 00 01 00 00 00 8F|"; content:"|00 16 00 00 00 00 00 00 00 00 00 00 00 45 00 00|"; within:16; distance:24; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17183; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file rcsL record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"rcsL|0E 05 00 00 00 00 00 00 00 00 00 00|"; content:"|01 17 00 C0 FF FF 00 00 00 C1 00 00 01 84 00 00|"; within:16; distance:84; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17186; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file tSAC record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"tSAC|B7 00 00 00 00 00 00 01 00 00 00 8F|"; content:"|00 00 00 00 00 16 00 00 00 00 00 00 00 3F 00 00|"; within:16; distance:20; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17182; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file rcsL record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|8F 41 01 45 C2 AE 00 FF 45 B0 41 24 43 46 1F 42|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17187; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file LsCM overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"LsCM"; byte_test:4,>,4211081214,0,relative; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2864; classtype:attempted-user; sid:17200; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file rcsL record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"rcsL|0E 05 00 00 00 00 00 00 00 00 00 00 00 00 05 0E 00 00 05 0E 00 5C 00 40|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17185; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file file Shockwave 3D overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"Shockwave 3D"; fast_pattern:only; content:"XFIR"; nocase; content:"tSAC"; distance:0; nocase; byte_test:2,>,32767,36,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2866; reference:url,www.adobe.com/support/security/bulletins/apsb10-20.html; classtype:attempted-user; sid:17202; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file rcsL record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"rcsL|0E 05 00 00 00 00 00 00 00 00 00 00 00 00 05 0E|"; content:"|0A 08 19 1E 1C 1E 1F 1E 44 00 43 01 57 6E A1 9C|"; within:16; distance:512; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17188; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file LsCM record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"LsCM|3A 00 00 00 00 00 00 0C 00 00 00 01 00 04 00 00 40 05 00 00|"; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2864; classtype:attempted-user; sid:17181; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file tSAC record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"tSAC|B7 00 00 00 00 00 00 01 00 00 00 8F|"; content:"|00 00 00 00 00 00 00 00 00 06 00 00 00 45 00 00|"; within:16; distance:28; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17184; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file file rcsL overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"Shockwave 3D"; fast_pattern:only; content:"rcsL"; byte_test:1,>,127,76,relative; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2867; classtype:attempted-user; sid:17203; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file pamm record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"pamm"; byte_test:4,>,4294967118,20,relative; content:!"|FF FF FF FF|"; within:4; distance:20; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17179; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file mmap overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"RIFX"; depth:4; content:"mmap"; byte_test:4,>,32768,0,relative; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2870; classtype:attempted-user; sid:17204; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file LsCM record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"LsCM|3A 00 00 00 00 00 00 0C 00 00 40 01|"; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2864; classtype:attempted-user; sid:17180; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file rcsL record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|52 02 4C 00 61 46 43 01 57 C9 41 01 06 52 43 4C|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17189; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave director file malformed lcsr block memory corruption attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"p|00 00 00 01 00 00 00 A8 FF FB|m|10|http|3A|//www."; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-3466; reference:url,www.adobe.com/support/security/bulletins/apsb09-16.html; classtype:attempted-user; sid:16220; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave tSAC pointer overwrite attempt"; flow:to_client,established; flowbits:isset, file.dir; file_data; content:"tSAC<|04 00 00 00 04 00 00 04|2|0B 00 00 01 00 00 00 14 0C 0C 0C 0C|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-3464; reference:url,www.adobe.com/support/security/bulletins/apsb09-16.html; classtype:attempted-user; sid:16223; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER BACnet OPC client csv file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.csv; file_data; content:"OPC_TAG_NAME,OBJECT_TYPE,INSTANCE,OBJECT_NAME"; fast_pattern:only; pcre:"/^\x5c[^\x5c\x2c]{600,}\x5Cscada,0,0,$/m"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,43289; reference:cve,2010-4740; classtype:attempted-user; sid:21317; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Director KEY chunk buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"RIFX"; depth:4; fast_pattern; nocase; content:"KEY|2A|"; distance:0; byte_test:4,<,5,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,48300; reference:cve,2011-2111; classtype:attempted-user; sid:21371; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ELF file parsing in different antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.elf; file_data; content:"|19 04 00 10|"; depth:4; offset:8; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1430; reference:url,securityfocus.com/archive/1/522005; classtype:bad-unknown; sid:21630; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ELF file parsing in different antivirus evasion attempt"; flow:to_client,established; file_data; content:"|7F|ELF"; depth:4; content:"|4A 46 49 46|"; within:4; distance:2; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1431; reference:url,securityfocus.com/archive/1/522005; classtype:bad-unknown; sid:21629; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file file Shockwave 3D overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"Shockwave 3D"; fast_pattern:only; content:"XFIR"; nocase; content:"tSAC"; distance:0; nocase; byte_test:2,>,32767,40,relative; content:"shockwave3d"; distance:0; nocase; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2866; reference:url,www.adobe.com/support/security/bulletins/apsb10-20.html; classtype:attempted-user; sid:23371; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows HLP File Handling heap overflow attempt"; flow:to_client,established; file_data; content:"|3F 5F 03 00|"; depth:4; content:"TTLBTREE|00 2E 06 00 00 7C 62|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,23382; reference:cve,2007-1912; classtype:attempted-user; sid:17374; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Project Invalid Memory Pointer Code Execution attempt"; flow:to_client,established; file_data; content:"|00 0B 00 00 00 CC E5 1A 00 41 41 41 41 00 00 00 00 03 02 01 22|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,28607; reference:cve,2008-1088; classtype:attempted-user; sid:17382; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Avast Antivirus Engine Remote LHA buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.lzh; file_data; content:"|19 4C 2D 6C 68 30 2D 53 0C 00 00 2C 00 00 00 28 94 28 35 20|"; depth:20; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,19903; reference:cve,2006-4626; classtype:attempted-admin; sid:17541; rev:16;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows itss.dll CHM File Handling Heap Corruption attempt"; flow:to_client,established; file_data; content:"|74 03 9E 02 4A 02 9C 01 12 01 8B 00 3E 00 25 00 00 00 02 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,17926; reference:cve,2006-2297; classtype:attempted-admin; sid:17490; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Help File Heap Buffer Overflow attempt"; flow:to_client,established; file_data; content:"|80 80 00 00 C0 C0 C0 00 80 80 80 00 00 00 FF 00 00 FF 00 00 00 FF FF 00 FF 00 00 00 FF 00 FF 00 FF FF 00 00 FF FF FF 00 00 41 41 41 41 41 41 41|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,17325; reference:cve,2006-1591; classtype:attempted-user; sid:17489; rev:11;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER ClamAV UPX FileHandling Heap overflow attempt"; flow:to_server,established; content:"|34 66 75 67 34 41 74 41 6E 4E 49 62 67 42 54 4D 30 68 56 47|"; content:"|67 68 44 41 6B 43 43 50 51 6F 47 53 35 51 76 6A 52 6F 4B 33|"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,19381; reference:cve,2006-4018; classtype:attempted-user; sid:17493; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Pagemaker Font Name Buffer Overflow attempt"; flow:to_client,established; flowbits:isset,file.pmd; file_data; content:"Courier|20|New|61 61 61 61 61 61 61 61 61|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,25989; reference:cve,2007-5169; classtype:attempted-user; sid:17553; rev:17;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER IBM Lotus Notes Applix Graphics Parsing Buffer Overflow"; flow:to_server,established; content:"Content-Transfer-Encoding|3A 20|quoted-printable|0D 0A|"; nocase; content:"Content-Disposition|3A 20|attachment"; distance:0; nocase; content:"|2A|BEGIN GRAPHICS VERSION"; within:23; distance:25; nocase; pcre:"/VERSION\x3d3D\d{3}[^\r\n]*\r\n/i"; content:"ENCODING"; within:8; nocase; pcre:"/^\x3d3D7BIT[^\r\n]{20}/Ri"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,28454; reference:cve,2007-5405; classtype:attempted-admin; sid:17559; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Pagemaker Key Strings Stack Buffer Overflow attempt"; flow:to_client,established; flowbits:isset,file.pmd; file_data; content:"Magenta"; nocase; content:"|41 41 41 41 41|"; within:5; distance:241; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,31999; reference:cve,2007-6432; classtype:attempted-admin; sid:17650; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Pagemaker Font Name Buffer Overflow attempt"; flow:to_client,established; flowbits:isset,file.pmd; file_data; content:"|61 61 61 61 61 61 61 61 61 61 61 61 0F 42 01 05 41 41 41 41 41 41 41 41|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,25989; reference:cve,2007-5169; classtype:attempted-user; sid:17735; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Director rcsL chunk remote code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|FF FF FF FF FF FF FF 00 00|rcsL"; isdataat:484,relative; content:"|00 00 00 80 00 00 F0 41 41 41 41 41 41 AB 41 05 43 01 57 17|"; within:20; distance:484; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,44291; reference:cve,2010-3653; reference:url,www.adobe.com/support/security/advisories/apsa10-04.html; classtype:attempted-user; sid:17807; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Director rcsL chunk remote code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|FF FF 00 00|rcsL"; isdataat:192,relative; content:"|01 02 4C 00 00 00 00 80 00 00 F0 FF F0 02 67 25 A2 01 33 41|"; within:20; distance:192; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,44291; reference:cve,2010-3653; reference:url,www.adobe.com/support/security/advisories/apsa10-04.html; classtype:attempted-user; sid:17806; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER rich text format unexpected field type memory corruption attempt"; flow:to_client,established; file_data; content:"|4B 47 2D D7 6B CF 87 5D CF DB F3 1E FE 9F 9F 5F F4 A3 30 49 BC A4 DB 9E B3 C3 7B ED B9 C5 28 6E|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-1901; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-056; classtype:attempted-user; sid:18953; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows uniscribe fonts parsing memory corruption attempt"; flow:to_client,established; flowbits:isset,file.ttf; file_data; content:"|AA FF FF FF FF 00 00 00 20 00 00 00 03 00 00 00 21 00 00 00 7E 00 00 00 04 00 00 00 A0 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,43068; reference:cve,2010-2738; reference:url,osvdb.org/show/osvdb/67984; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-063; classtype:attempted-user; sid:18952; rev:16;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER rich text format unexpected field type memory corruption attempt"; flow:to_client,established; file_data; content:"|CB 5D 91 76 A2 A3 23 D7 EF 15 F9 A8 E3 7A DD A5 78 21 08 0E FE 17 FF 2F 2D AD 84 49 9C 65 41 B6|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-1901; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-056; classtype:attempted-user; sid:18954; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft OpenType font index remote code execution attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|FB 01 FF FF 00 00 FF 2F|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,45311; reference:cve,2010-3956; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-091; classtype:attempted-user; sid:19064; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave 3D stucture heap overflow"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"initmainVWTL"; content:"XMED"; within:4; distance:4; content:"|80 FF FF FF 00|"; within:5; distance:36; content:"|0C 0C 0C 0C FF 00 00 00|"; within:8; distance:25; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-4002; reference:url,www.adobe.com/support/security/bulletins/apsb10-03.html; classtype:attempted-user; sid:19112; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave 3D structure opcode 45 overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"initmainVWTL"; content:"XMED"; within:4; distance:4; content:"|45 FF FF FF 00 FF 00|"; within:7; distance:36; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-4003; reference:url,www.adobe.com/support/security/bulletins/apsb10-03.html; classtype:attempted-user; sid:19114; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave 3D structure opcode 81 overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"initmainVWTL"; content:"XMED"; within:4; distance:4; content:"|81 FF FF FF 00 FF 00|"; within:7; distance:36; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-4003; reference:url,www.adobe.com/support/security/bulletins/apsb10-03.html; classtype:attempted-user; sid:19113; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave 3D structure opcode 89 overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"initmainVWTL"; content:"XMED"; within:4; distance:4; content:"|89 FF FF FF 00 FF 00|"; within:7; distance:36; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-4003; reference:url,www.adobe.com/support/security/bulletins/apsb10-03.html; classtype:attempted-user; sid:19115; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows MPEG Layer-3 audio heap corruption attempt"; flow:to_client,established; flowbits:isset,file.asx; file_data; content:"|FF FA 92 60 41 41 41 41|"; depth:8; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,42298; reference:cve,2010-1882; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-052; classtype:attempted-user; sid:19144; rev:13;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows .NET Framework XAML browser applications stack corruption"; flow:to_client,established; flowbits:isset,file.manifest; file_data; content:"|2F 00 59 00 41 01 6B 00 61 00 41 01 6B 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,47223; reference:cve,2010-3958; classtype:attempted-user; sid:19170; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Fax Services Cover Page Editor Double Free Memory Corruption"; flow:to_client,established; flowbits:isset,file.cov; file_data; content:"|00 73 00 04 00 AD FE FF FF FE 01 00 00 2F FF FF|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,45942; reference:cve,2010-2701; classtype:attempted-admin; sid:19219; rev:13;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco Webex Player .wrf stack buffer overflow"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|02 01 78 02 69 C1 F0 FC|"; offset:690; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,46075; reference:cve,2010-3269; classtype:attempted-user; sid:19226; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Fax Services Cover Page Editor Double Free Memory Corruption"; flow:to_client,established; flowbits:isset,file.cov; file_data; content:"|00 00 42 00 55 00 47 00 0A 00 A7 FE FF FF DA 01|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,45942; reference:cve,2010-2701; classtype:attempted-admin; sid:19220; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows embedded OpenType EOT font integer overflow attempt"; flow:to_client,established; flowbits:isset,file.eot; file_data; content:"|52 E7 0D 2C 32 3E 1D FC BE E2 B2 A1 E9 94 6A 46 57 35 B4 FD|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,43775; reference:cve,2010-1883; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-076; classtype:attempted-user; sid:19308; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Server 2003 update service principal name spn dos executable attempt"; flow:to_client,established; file_data; content:"|62 00 61 00 64 00 2E 00 44 00 4E 00 53 00 65 00 6E 00 74 00 72 00 79 00 00 00|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2011-0040; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-005; classtype:attempted-admin; sid:18406; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Data Access Components library attempt"; flow:to_client,established; file_data; content:"|33 C0 66 89 45 F4 6A FD 8D 85 BC FF FE FF 50 6A FD 8D 8D D8 FF FE FF 51 6A FD 8D 95 F4 FF FE FF 52 8B 85 A4 FF FE FF 50 E8 9B FB FF FF 33 C0 52 8B CD 50 8D 15 14 15 41 00 E8 9E FB FF FF 58 5A 5F 5E 5B 8B 4D FC 33 CD E8 12 FB|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-002; classtype:attempted-user; sid:18276; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Media Player dvr-ms file parsing remote code execution attempt"; flow:to_client,established; file_data; content:"|00 00 00 00 A2 00 56 61 6C 69 02 00 00 00 90 00 42 42 42 42|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0042; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-015; classtype:attempted-user; sid:18498; rev:15;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows OpenType Fonts CompactFontFormat FontMatrix tranform memory corruption attempt"; flow:to_client,established; file_data; content:"|04 FB 61 0C 03 F1 0C 04 8C 8B 8B 8C 8B 8B 0C 07 1C F7 E9 FD|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-032; classtype:attempted-admin; sid:18644; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD Adobe font driver remote code execution attempt"; flow:to_client,established; file_data; content:"|64 A2 F7 60 A2 01 F7 A7 C8 03 14 E0 F7 E6 43 15 BE C9 A3 B0|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0033; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-007; classtype:attempted-user; sid:18402; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"FILE-OTHER Microsoft Windows Server 2003 update service principal name spn dos attempt"; flow:to_server,established; content:"|62 00 61 00 64 00 2E 00 44 00 4E 00 53 00 65 00 6E 00 74 00 72 00 79 00 00 00|"; fast_pattern:only; metadata:service netbios-ns; reference:cve,2011-0040; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-005; classtype:attempted-admin; sid:18407; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe malicious IFF memory corruption attempt"; flow:to_client,established; file_data; content:"|2F 33 44 41 37 3C 39 3B 34 2F 42 41 3A 2B 33 3A 2E 2C 30|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2011-0587; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-admin; sid:18452; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows TrueType font parsing engine sfac_GetSbitBitmap elevation of privileges attempt"; flow:to_client,established; flowbits:isset,file.ttf; file_data; content:"|00 00 00 00 00 01 00 03 48 0A 01 01 00 00 00 80 01 FF 00 00 00 00 00 01 00 03 40 52 00 02 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-3402; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-087; classtype:attempted-user; sid:20735; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_client,established; file_data; content:"VFRPAAsAgAADADBDRkYgDBtVwQAADFQAAKzyR1BPU1UZ4R4AAMFQAAAsHEdT"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-admin; sid:20771; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_server,established; file_data; content:"|4F 54 54 4F 00 0B 00 80 00 03 00 30 43 46 46 20 0C 1B 55 C1 00 00 0C 54 00 00 AC F2 47 50 4F 53 55 19 E1 1E 00 00 C1 50 00 00 2C 1C 47 53 55 42|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-admin; sid:20776; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_client,established; file_data; content:"VE8ACwCAAAMAMENGRiAMG1XBAAAMVAAArPJHUE9TVRnhHgAAwVAAACwcR1NV"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-admin; sid:20772; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_server,established; content:"VFRPAAsAgAADADBDRkYgDBtVwQAADFQAAKzyR1BPU1UZ4R4AAMFQAAAsHEdT"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-admin; sid:20774; rev:6;)
alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_client,established; file_data; content:"|4F 54 54 4F 00 0B 00 80 00 03 00 30 43 46 46 20 0C 1B 55 C1 00 00 0C 54 00 00 AC F2 47 50 4F 53 55 19 E1 1E 00 00 C1 50 00 00 2C 1C 47 53 55 42|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-admin; sid:20768; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_client,established; file_data; content:"T1RUTwALAIAAAwAwQ0ZGIAwbVcEAAAxUAACs8kdQT1NVGeEeAADBUAAALBxHU1VC"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-admin; sid:20770; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_server,established; content:"T1RUTwALAIAAAwAwQ0ZGIAwbVcEAAAxUAACs8kdQT1NVGeEeAADBUAAALBxHU1VC"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-admin; sid:20773; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_server,established; file_data; content:"|00 01 00 00 0E B7 AD 87 5F 0F 3C F5 00 03 03 E8 00 00 00 00 C9 D2 5F 76 00 00 00 00 C9 D2 5F 76 00 00 00 00 00 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-user; sid:20769; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_server,established; content:"VE8ACwCAAAMAMENGRiAMG1XBAAAMVAAArPJHUE9TVRnhHgAAwVAAACwcR1NV"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-admin; sid:20775; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows OpenType font parsing stack overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|04 FB 61 0C 03 F1 0C 04 8C 8B 8B 8C 8B 8B 0C 07 1C F7 E9 FD|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-032; classtype:attempted-admin; sid:20902; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows OpenType font parsing stack overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|03 00 01 04 09 00 0E 00 36 05 0E 00 03 00 01 04 09 00 11 00 18 05 44 43 6F 70|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-032; classtype:attempted-admin; sid:20904; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows OpenType font parsing stack overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|1E 1A 00 04 88 28 1F 8B 8B 1E 1A 00 04 88 28 1F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-032; classtype:attempted-admin; sid:20903; rev:12;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Java Applet Rhino script engine remote code execution attempt"; flow:to_client,established; flowbits:isset,file.universalbinary; file_data; content:"this.toString = function|28|"; nocase; content:"java.lang.System.setSecurityManager|28|null|29|"; distance:0; nocase; content:"return String.fromCharCode|28|97"; distance:0; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-3544; reference:url,osvdb.org/show/osvdb/76500; classtype:attempted-user; sid:21057; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco Webex selector and size2 subrecords corruption attempt"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|02 3C 00 3C 00 18 77 04 00 00 00 10 77 04 00 00 01 00 00 00 88 03 5B 00 18 00 00 40|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-3319; reference:url,osvdb.org/show/osvdb/76570; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-093; reference:url,www.securityfocus.com/bid/50373; classtype:attempted-user; sid:21116; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe shockwave director tSAC string termination memory corruption attempt"; flow:to_client,established; file_data; flowbits:isset,file.dir; content:"|00 00 00 01 00 00 12 47 00 00 00 00 F0 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2118; classtype:attempted-user; sid:21316; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows chm file malware related exploit"; flow:to_client,established; flowbits:isset,file.chm; file_data; content:"|78 07 2F 6D 79 2E 68 74 6D 01 84 A0 00 81 5C 0C 2F 73 65 72 76 69 63 65 2E 65 78 65 01 00 84 A0|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/file/508508b8105d7d9b5289813b385f9be233d76e09a2ad3c647e8dc5078db8eff1/analysis/; classtype:trojan-activity; sid:21489; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Java JRE sandbox breach attempt"; flow:to_client,established; flowbits:isset,file.universalbinary; file_data; content:"AtomicReferenceArray"; content:"localAtomicReferenceArray = (AtomicReferenceArray)arrayofObject"; distance:0; nocase; metadata:policy balanced-ips alert, policy connectivity-ips alert, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,52161; reference:cve,2012-0507; classtype:attempted-user; sid:21869; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Expat xml UTF-8 buffer over-read attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"<?xml version|C2 85|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,36097; reference:cve,2009-3720; classtype:denial-of-service; sid:24069; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Expat xml UTF-8 buffer over-read attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"<?xml version|C2 85|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,36097; reference:cve,2009-3720; classtype:denial-of-service; sid:24070; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Expat xml UTF-8 bufer over-read attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"<?xml |D8 B6|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,36097; reference:cve,2009-3720; classtype:denial-of-service; sid:24068; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Expat xml UTF-8 buffer over-read attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"<?xml |D8 B6|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,36097; reference:cve,2009-3720; classtype:denial-of-service; sid:24067; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER ESTsoft ALZip MIM file buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.mime; file_data; content:"Content-Type"; fast_pattern:only; content:"name"; nocase; content:"="; within:5; isdataat:300,relative; content:!"|3B|"; within:300; content:!"|0A|"; within:302; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1336; reference:url,osvdb.org/show/osvdb/73684; classtype:attempted-user; sid:24083; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ACD Systems ACDSee Products XPM values section buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xpm; file_data; content:"static"; content:"char"; within:50; pcre:"/^static\s+(\w+\s+)?char\s*\x2A\s*\w+\s*\x5B\x5D\s*\x3D\s*\x7B.*\x22[^\x22]{200}/smiH"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,26554; reference:cve,2007-6009; classtype:attempted-user; sid:16062; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft SQL Server Backup Database File integer overflow attempt"; flow:to_client,established; flowbits:isset,file.bak; file_data; content:"MQCI"; content:"SFIN"; within:4; distance:18; fast_pattern; byte_test:4,<,8,0,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2008-0107; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-040; classtype:attempted-admin; sid:13888; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft SQL Server Backup Database File integer overflow attempt"; flow:to_client,established; flowbits:isset,file.bak; file_data; content:"MQCI"; content:"SCIN"; within:4; distance:18; fast_pattern; byte_test:4,<,8,0,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2008-0107; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-040; classtype:attempted-admin; sid:13889; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft SQL Server Backup Database File integer overflow attempt"; flow:to_client,established; flowbits:isset,file.bak; file_data; content:"MQCI"; content:"SFGI"; within:4; distance:18; fast_pattern; byte_test:4,<,8,0,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2008-0107; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-040; classtype:attempted-admin; sid:13890; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft HTML help workshop buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.hlp; file_data; content:"["; depth:1; content:"]"; within:12; content:"file"; distance:0; nocase; content:"="; distance:0; pcre:"/\x5B(OPTIONS|WINDOWS|MERGE FILES|MAP|ALIAS|TEXT\x20POPUPS|INFOTYPES|SUBSETS)\x5D.*?(Contents|Index|Compiled|Sample List|Full text search stop list)\x20file\s*\x3D[^\r\n]{200}/smi"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2006-0564; reference:cve,2009-0133; reference:url,users.pandora.be/bratax/advisories/b008.html; reference:url,www.frsirt.com/english/advisories/2006/0446; classtype:attempted-user; sid:5741; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Download Manger dm.ini stack overflow attempt"; flow:to_client,established; flowbits:isset,file.aom; file_data; content:"<?aom"; nocase; content:"<url>"; isdataat:271; content:!"</url>"; within:271; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,21453; reference:cve,2006-5856; classtype:attempted-user; sid:9637; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER libxml2 file processing long entity overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"<!ENTITY"; isdataat:200,relative; pcre:"/^\s+([^\x22\x20\x3E]{200}|[^\s]*\s+\x22[^\x22\x20\x3E]{200})/smR"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,31126; reference:cve,2008-3529; classtype:attempted-user; sid:15866; rev:16;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Vista Feed Headlines Gagdet code execution attempt"; flow:to_client,established; flowbits:isset,file.rss; file_data; content:"&lt|3B|"; fast_pattern; nocase; content:"<title>"; nocase; pcre:"/\x3ctitle\x3e[^\x3c]*\x26lt\x3b[^\x3c]*(>|\x26gt\x3b)/i"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,25287; reference:cve,2007-3033; classtype:attempted-user; sid:15946; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Free Download Manager .torrent parsing path overflow attempt"; flow:to_client,established; flowbits:isset,file.torrent; file_data; content:"4:pathl"; nocase; byte_test:6,>,10000,0,relative,dec,string; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16520; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Free Download Manager .torrent parsing name overflow attempt"; flow:to_client,established; flowbits:isset,file.torrent; file_data; content:"4:name"; nocase; byte_test:6,>,10000,0,relative,dec,string; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16519; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Free Download Manager .torrent parsing comment overflow attempt"; flow:to_client,established; flowbits:isset,file.torrent; file_data; content:"7:comment"; nocase; byte_test:6,>,100000,0,relative,dec,string; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16517; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Free Download Manager .torrent parsing announce overflow attempt"; flow:to_client,established; flowbits:isset,file.torrent; file_data; content:"8:announce"; nocase; byte_test:6,>,100000,0,relative,dec,string; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16518; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER UltraISO CUE file handling stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.cue; file_data; content:"FILE |22|"; depth:6; isdataat:512,relative; content:!"|22|"; within:512; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,24140; reference:cve,2007-2888; classtype:attempted-user; sid:16734; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ACD Systems ACDSee Products XBM file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xbm; file_data; content:"|23|define"; content:"|5F|width"; distance:0; pcre:"/\x23define\s*(?=[\S]{57})\S*\x5Fwidth/"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,37685; reference:url,osvdb.org/show/osvdb/63643; classtype:attempted-user; sid:17238; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Help Workshop HPJ OPTIONS section buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.hpj; file_data; content:"[OPTIONS]"; content:"HLP"; distance:0; nocase; pcre:"/^\s*HLP\s*\x3d\s*[^\n]{257}/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,22135; reference:cve,2007-0427; classtype:attempted-user; sid:17366; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER OpenOffice.org XPM file processing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.xpm; file_data; content:"/* XPM */"; fast_pattern; content:"static char *"; distance:0; pcre:"/^[^\x22]+\x22(\d+\x20+){2}/R"; byte_test:10,>,419062,0,relative,string; byte_test:10,>,10244,1,relative,string; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,38218; reference:cve,2009-2949; classtype:attempted-user; sid:18537; rev:12;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft SYmbolic LinK stack overflow attempt"; flow:to_client,established; flowbits:isset,file.slk; file_data; content:"P|3B|"; fast_pattern:only; pcre:"/(^P\x3B[^\x3B]*\x0D\x0A){200}/mi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,48161; reference:cve,2011-1276; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-045; classtype:attempted-user; sid:19911; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft MHTML XSS attempt"; flow:to_client,established; flowbits:isset,file.mht; file_data; content:"MIME-Version"; fast_pattern:only; pcre:"/(\x3C\s*script|onload|onclick|onmouseover)/ims"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2011-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-026; classtype:attempted-user; sid:20133; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver remote code execution attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|01 00 04 04 00 01 01 01 03 49 57 00 01 02 80 01 00 40 F8 0F|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-3957; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-091; classtype:attempted-user; sid:18219; rev:16;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Embedded Open Type Font malformed name table integer overflow attempt"; flow:to_client,established; flowbits:isset,file.eot; file_data; content:"|00 01 00 00|"; content:"|00 01|"; within:2; distance:2; content:"|00 01 00 00|"; within:100; content:"|00 04|"; within:2; distance:2; byte_test:2,>,0xffc1,0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-0232; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-029; classtype:attempted-user; sid:15694; rev:17;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Embedded Open Type Font malformed name table platform type 3 integer overflow attempt"; flow:to_client,established; flowbits:isset,file.eot; file_data; content:"|00 01 00 00|"; content:"|00 01|"; within:2; distance:2; content:"|00 03 00|"; within:100; content:"|00 04|"; within:2; distance:3; byte_test:2,>,0xffc1,0,relative; byte_test:1,<,2,-5,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-0232; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-029; classtype:attempted-user; sid:15695; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Embedded Open Type Font malformed name table overflow attempt"; flow:to_client,established; flowbits:isset,file.eot; file_data; content:"|00 01 00 01 00 12 00 01 00 01 00 00 00 01 FF FF|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-0231; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-029; classtype:attempted-user; sid:15693; rev:16;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft malformed saved search heap corruption attempt"; flow:to_client,established; flowbits:isset,file.search-ms; file_data; content:"type=|22|notCondition|22|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2008-1435; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-038; classtype:attempted-admin; sid:13893; rev:17;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Nullsoft Winamp AMF file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.amf; file_data; content:"AMF"; depth:3; byte_test:1,>,12,3; byte_test:1,>,32,40; metadata:service ftp-data, service http, service imap, service pop3; reference:url,forums.winamp.com/showthread.php?t=332010; reference:url,www.osvdb.org/show/osvdb/76635; classtype:attempted-user; sid:20566; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Nullsoft Winamp AMF file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.amf; file_data; content:"AMF"; depth:3; byte_test:1,<,12,3; byte_test:1,>,16,40; metadata:service ftp-data, service http, service imap, service pop3; reference:url,forums.winamp.com/showthread.php?t=332010; reference:url,www.osvdb.org/show/osvdb/76635; classtype:attempted-user; sid:20565; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cytel Studio USE command overflow attempt"; flow:to_client,established; flowbits:isset,file.cyb; file_data; content:"USE"; isdataat:512,relative; content:!")|3B|"; within:512; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,49924; reference:url,aluigi.altervista.org/adv/cytel_1-adv.txt; reference:url,osvdb.org/show/osvdb/75991; reference:url,www.exploit-db.com/exploits/18027/; classtype:attempted-user; sid:21021; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cytel Studio row overflow attempt"; flow:to_client,established; flowbits:isset,file.cy3; file_data; content:"90"; depth:2; content:"|0A|"; within:2; pcre:"/90\x0D?\x0A\w{8}/s"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,49924; reference:url,aluigi.altervista.org/adv/cytel_1-adv.txt; reference:url,osvdb.org/show/osvdb/75991; reference:url,www.exploit-db.com/exploits/18027/; classtype:attempted-user; sid:21020; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cytel Studio string stack overflow attempt"; flow:to_client,established; flowbits:isset,file.cy3; file_data; content:"90"; depth:2; content:"|0A|"; within:2; isdataat:512,relative; pcre:"/\w{512}/Rs"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,49924; reference:url,aluigi.altervista.org/adv/cytel_1-adv.txt; reference:url,osvdb.org/show/osvdb/75991; reference:url,www.exploit-db.com/exploits/18027/; classtype:attempted-user; sid:21019; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER VisiWave VWR file parsing code execution attempt"; flow:to_client,established; flowbits:isset,file.vwr; file_data; content:"Type|3A|"; nocase; isdataat:500,relative; content:!"|0A|"; within:500; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,47948; reference:cve,2011-2386; classtype:attempted-user; sid:21587; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows CUR file parsing overflow attempt"; flow:to_client,established; flowbits:isset,file.cur; file_data; content:"|00 00 02 00|"; depth:4; byte_test:4,>,0xfffffffc,10,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,12095; reference:cve,2004-1049; classtype:attempted-user; sid:23499; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Multiple vendor Antivirus magic byte detection evasion attempt"; flow:to_client,established; content:"Content|2D|Type|3A|"; nocase; http_header; content:"text|2F|html"; within:20; fast_pattern; nocase; http_header; file_data; pcre:"/^(MZ|PK|BZh|BZ|GIF8|BM|IC|PI|CI|CP)/"; metadata:policy max-detect-ips drop, service http; reference:cve,2005-3370; reference:cve,2005-3371; reference:cve,2005-3372; reference:cve,2005-3373; reference:cve,2005-3374; reference:cve,2005-3375; reference:cve,2005-3376; reference:cve,2005-3377; reference:cve,2005-3378; reference:cve,2005-3379; reference:cve,2005-3380; reference:cve,2005-3381; reference:cve,2005-3382; classtype:attempted-user; sid:17276; rev:19;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Multiple vendor Antivirus magic byte detection evasion attempt"; flow:to_client,established; flowbits:isset,file.eml; content:"Content|2D|Type:"; nocase; http_header; content:"message|2F|rfc822"; within:30; fast_pattern; nocase; http_header; file_data; pcre:"/(MZ|PK|BZh|BZ|GIF8|BM|IC|PI|CI|CP)/R"; metadata:service http; reference:cve,2005-3370; reference:cve,2005-3371; reference:cve,2005-3372; reference:cve,2005-3373; reference:cve,2005-3374; reference:cve,2005-3375; reference:cve,2005-3376; reference:cve,2005-3377; reference:cve,2005-3378; reference:cve,2005-3379; reference:cve,2005-3380; reference:cve,2005-3381; reference:cve,2005-3382; classtype:attempted-user; sid:17277; rev:13;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Multiple vendor Antivirus magic byte detection evasion attempt"; flow:to_client,established; flowbits:isset,file.bat; content:"Content|2D|Type|3A|"; nocase; http_header; content:"application|2F|bat"; within:30; fast_pattern; nocase; http_header; file_data; pcre:"/(MZ|PK|BZh|BZ|GIF8|BM|IC|PI|CI|CP)/R"; metadata:service http; reference:cve,2005-3370; reference:cve,2005-3371; reference:cve,2005-3372; reference:cve,2005-3373; reference:cve,2005-3374; reference:cve,2005-3375; reference:cve,2005-3376; reference:cve,2005-3377; reference:cve,2005-3378; reference:cve,2005-3379; reference:cve,2005-3380; reference:cve,2005-3381; reference:cve,2005-3382; classtype:attempted-user; sid:17278; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Font Library file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.fon; file_data; content:"MZ"; depth:2; nocase; byte_test:4,>,50,120,little; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2003; reference:url,secunia.com/advisories/46405/; reference:url,www.exploit-db.com/exploits/17978/; reference:url,www.kb.cert.org/vuls/id/619281; classtype:attempted-user; sid:20572; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Interactive Data eSignal stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.esignal; file_data; content:"|00 00 00|"; depth:3; offset:1; byte_test:1,<,12,0; byte_test:1,>,20,13; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-3494; reference:url,osvdb.org/show/osvdb/75456; classtype:attempted-user; sid:20842; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Interactive Data eSignal stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.esignal; file_data; content:"<StyleTemplate>"; fast_pattern; nocase; isdataat:512,relative; content:!"</StyleTemplate>"; within:512; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-3494; reference:url,osvdb.org/show/osvdb/75456; classtype:attempted-user; sid:20843; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx recording integer overflow attempt"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 02|"; depth:2000; fast_pattern; content:"|01 00 00 00|"; within:4; distance:15; byte_test:2,>=,0x8000,2,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20111026-webex; classtype:attempted-user; sid:23101; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx recording integer overflow attempt"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 02|"; depth:2000; fast_pattern; content:"|01 00 00 00|"; within:4; distance:15; byte_test:2,>=,0x8000,0,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20111026-webex; classtype:attempted-user; sid:23100; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER AOL Desktop RTX file parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.rtx; file_data; content:"<meta"; nocase; isdataat:2000,relative; content:!">"; within:2000; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,46129; reference:url,www.exploit-db.com/exploits/16107; classtype:attempted-user; sid:24165; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER AOL Desktop RTX file parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.rtx; file_data; content:"<html"; nocase; isdataat:2000,relative; content:!">"; within:2000; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,46129; reference:url,www.exploit-db.com/exploits/16107; classtype:attempted-user; sid:24161; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER AOL Desktop RTX file parsing buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.rtx; file_data; content:"<meta"; nocase; isdataat:2000,relative; content:!">"; within:2000; metadata:service smtp; reference:bugtraq,46129; reference:url,www.exploit-db.com/exploits/16107; classtype:attempted-user; sid:24166; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER AOL Desktop RTX file parsing buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.rtx; file_data; content:"<html"; nocase; isdataat:2000,relative; content:!">"; within:2000; metadata:service smtp; reference:bugtraq,46129; reference:url,www.exploit-db.com/exploits/16107; classtype:attempted-user; sid:24162; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER AOL Desktop RTX file parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.rtx; file_data; content:"<base"; nocase; isdataat:2000,relative; content:!">"; within:2000; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,46129; reference:url,www.exploit-db.com/exploits/16107; classtype:attempted-user; sid:24163; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER AOL Desktop RTX file parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.rtx; file_data; content:"<a "; nocase; isdataat:2000,relative; content:!">"; within:2000; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,46129; reference:url,www.exploit-db.com/exploits/16107; classtype:attempted-user; sid:24159; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER AOL Desktop RTX file parsing buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.rtx; file_data; content:"<base"; nocase; isdataat:2000,relative; content:!">"; within:2000; metadata:service smtp; reference:bugtraq,46129; reference:url,www.exploit-db.com/exploits/16107; classtype:attempted-user; sid:24164; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER AOL Desktop RTX file parsing buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.rtx; file_data; content:"<a "; nocase; isdataat:2000,relative; content:!">"; within:2000; metadata:service smtp; reference:bugtraq,46129; reference:url,www.exploit-db.com/exploits/16107; classtype:attempted-user; sid:24160; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER eZip Wizard stack overflow attempt"; flow:established,to_client; file_data; content:"|61 61 7A 04 10 07 02 10 61|"; content:"|58 58 41|"; within:31; distance:28; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,34044; reference:cve,2009-1028; classtype:attempted-user; sid:24176; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER eZip Wizard stack overflow attempt"; flow:established,to_client; file_data; content:"|BB 21 F4 DB C9 CA 1B 10 86 71 E0 4C 27 71 D0 58 D4 92 1E 1E 84 16 C0 AF 5C 9C C3 36 E2 C9 A2 38|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,34044; reference:cve,2009-1028; classtype:attempted-user; sid:24177; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER IBM Lotus Notes LZH Attachment Viewer buffer overflow"; flow:to_server,established; flowbits:isset,file.lzh; file_data; byte_test:1,<,19,0; content:"-lh"; depth:3; offset:2; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,48018; reference:cve,2011-1213; reference:url,osvdb.org/show/osvdb/72706; classtype:attempted-user; sid:24208; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER eZip Wizard stack overflow attempt"; flow:established,to_client; file_data; content:"|74 70 54 70 56 69 6F 68 57 69 6F 68 50 41 2E 74 78 74 50 4B 01 02 14 00 14 00 00 00 00 00 B7 AC|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,34044; reference:cve,2009-1028; classtype:attempted-user; sid:24178; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER IBM Lotus Notes LZH Attachment Viewer buffer overflow"; flow:to_server,established; flowbits:isset,file.lzh; content:"|0D 0A 0D 0A|CBotbGgwLXwaAAB8"; fast_pattern:4,16; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,48018; reference:cve,2011-1213; reference:url,osvdb.org/show/osvdb/72706; classtype:attempted-user; sid:24207; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER eZip Wizard stack overflow attempt"; flow:established,to_server; file_data; content:"|74 70 54 70 56 69 6F 68 57 69 6F 68 50 41 2E 74 78 74 50 4B 01 02 14 00 14 00 00 00 00 00 B7 AC|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,34044; reference:cve,2009-1028; classtype:attempted-user; sid:24181; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER eZip Wizard stack overflow attempt"; flow:established,to_server; file_data; content:"|61 61 7A 04 10 07 02 10 61|"; content:"|58 58 41|"; within:31; distance:28; metadata:service smtp; reference:bugtraq,34044; reference:cve,2009-1028; classtype:attempted-user; sid:24179; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER IBM Lotus Notes LZH Attachment Viewer buffer overflow"; flow:to_client,established; flowbits:isset,file.lzh; file_data; byte_test:1,<,19,0; content:"-lh"; depth:3; offset:2; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,48018; reference:cve,2011-1213; reference:url,osvdb.org/show/osvdb/72706; classtype:attempted-user; sid:24209; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER eZip Wizard stack overflow attempt"; flow:established,to_server; file_data; content:"|BB 21 F4 DB C9 CA 1B 10 86 71 E0 4C 27 71 D0 58 D4 92 1E 1E 84 16 C0 AF 5C 9C C3 36 E2 C9 A2 38|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,34044; reference:cve,2009-1028; classtype:attempted-user; sid:24180; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RealNetworks Netzip Classic zip archive long filename buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"|50 4B 03 04|"; depth:4; byte_test:2,>,256,22,little,relative; metadata:service smtp; reference:bugtraq,46059; classtype:attempted-user; sid:24230; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks Netzip Classic zip archive long filename buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"|50 4B 03 04|"; depth:4; byte_test:2,>,256,22,little,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,46059; classtype:attempted-user; sid:24229; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Shockwave Director rcsL chunk memory corruption attempt"; flow:to_server,established; flowbits:isset,file.dir; file_data; content:"|FF FF FF FF 00 00|rcsL"; isdataat:484,relative; content:"|00 00 00 80 00 00 F0 00 6B 2B 2B 45 46 AB 41 05 43 01 57 17|"; within:20; distance:484; metadata:policy security-ips drop, service smtp; reference:bugtraq,44291; reference:cve,2010-3653; reference:url,www.adobe.com/support/security/advisories/apsa10-04.html; classtype:attempted-user; sid:24278; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Director file file Shockwave 3D overflow attempt"; flow:to_server,established; flowbits:isset,file.dir; file_data; content:"Shockwave 3D"; fast_pattern:only; content:"XFIR"; nocase; content:"tSAC"; distance:0; nocase; byte_test:2,>,32767,40,relative; content:"shockwave3d"; distance:0; nocase; metadata:policy security-ips drop, service smtp; reference:cve,2010-2866; reference:url,www.adobe.com/support/security/bulletins/apsb10-20.html; classtype:attempted-user; sid:24272; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Shockwave Director rcsL chunk remote code execution attempt"; flow:to_server,established; flowbits:isset,file.dir; file_data; content:"|FF FF 00 00|rcsL"; isdataat:192,relative; content:"|01 02 4C 00 00 00 00 80 00 00 F0 FF F0 02 67 25 A2 01 33 41|"; within:20; distance:192; metadata:policy security-ips drop, service smtp; reference:bugtraq,44291; reference:cve,2010-3653; reference:url,www.adobe.com/support/security/advisories/apsa10-04.html; classtype:attempted-user; sid:24280; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Director rcsL chunk memory corruption attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|FF FF FF FF 00 00|rcsL"; isdataat:484,relative; content:"|00 00 00 80 00 00 F0 00 6B 2B 2B 45 46 AB 41 05 43 01 57 17|"; within:20; distance:484; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,44291; reference:cve,2010-3653; reference:url,www.adobe.com/support/security/advisories/apsa10-04.html; classtype:attempted-user; sid:24277; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Director file file Shockwave 3D overflow attempt"; flow:to_server,established; flowbits:isset,file.dir; file_data; content:"Shockwave 3D"; fast_pattern:only; content:"XFIR"; nocase; content:"tSAC"; distance:0; nocase; byte_test:2,>,32767,36,relative; metadata:policy security-ips drop, service smtp; reference:cve,2010-2866; reference:url,www.adobe.com/support/security/bulletins/apsb10-20.html; classtype:attempted-user; sid:24273; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Shockwave Director rcsL chunk remote code execution attempt"; flow:to_server,established; flowbits:isset,file.dir; file_data; content:"|FF FF FF FF FF FF FF 00 00|rcsL"; isdataat:484,relative; content:"|00 00 00 80 00 00 F0 41 41 41 41 41 41 AB 41 05 43 01 57 17|"; within:20; distance:484; metadata:policy security-ips drop, service smtp; reference:bugtraq,44291; reference:cve,2010-3653; reference:url,www.adobe.com/support/security/advisories/apsa10-04.html; classtype:attempted-user; sid:24279; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML Style attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"<description"; distance:0; content:"backgroundColor="; distance:0; pcre:"/color\x3d\s*?[\x22\x27][^\x22\x27]{20}/smi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0663; classtype:attempted-user; sid:24338; rev:7;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Adobe Photoshop wintab32.dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"w|00|i|00|n|00|t|00|a|00|b|00|3|00|2|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2010-3127; reference:url,osvdb.org/show/osvdb/67545; classtype:attempted-user; sid:18489; rev:7;)
# alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:"FILE-OTHER Microsoft LNK shortcut arbitary dll load attempt"; flow:to_client,established; content:"|FF|SMB"; depth:4; offset:4; content:"|00 00 00 00|"; within:4; distance:1; content:"|4C 00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00 46|"; content:"|20 20 EC 21 EA 3A 69 10 A2 DD 08 00 2B 30 30 9D|"; distance:0; pcre:"/\x2E\x00?d\x00?l\x00?l\x00?/Ri"; metadata:policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2010-2568; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-046; classtype:attempted-user; sid:19290; rev:9;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Adobe Audition assist.dll dll-load exploit attempt"; flow:to_server,established; content:"a|00|s|00|s|00|i|00|s|00|t|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; classtype:attempted-user; sid:19617; rev:4;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Multiple products dwmapi.dll dll-load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"d|00|w|00|m|00|a|00|p|00|i|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:bugtraq,62836; reference:cve,2010-3127; reference:cve,2010-3131; reference:cve,2010-3191; reference:cve,2010-3976; reference:cve,2013-0733; reference:cve,2013-3485; reference:url,osvdb.org/show/osvdb/96228; reference:url,osvdb.org/show/osvdb/98163; reference:url,www.adobe.com/support/security/bulletins/apsb10-26.html; classtype:attempted-user; sid:19618; rev:8;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Adobe Acrobat Reader d3dref9.dll dll-load exploit attempt"; flow:to_server,established; content:"d|00|3|00|d|00|r|00|e|00|f|00|9|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-0588; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18433; rev:9;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Adobe Acrobat Reader plugin cooltype.dll dll-load exploit attempt"; flow:to_server,established; content:"c|00|o|00|o|00|l|00|t|00|y|00|p|00|e|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18437; rev:10;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Adobe Acrobat Reader plugin bibutils.dll dll-load exploit attempt"; flow:to_server,established; content:"b|00|i|00|b|00|u|00|t|00|i|00|l|00|s|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18436; rev:10;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Adobe Acrobat Reader plugin agm.dll dll-load exploit attempt"; flow:to_server,established; content:"a|00|g|00|m|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18435; rev:10;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Adobe Acrobat Reader plugin sqlite.dll dll-load exploit attempt"; flow:to_server,established; content:"s|00|q|00|l|00|i|00|t|00|e|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18426; rev:10;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Adobe Acrobat Reader plugin ace.dll dll-load exploit attempt"; flow:to_server,established; content:"a|00|c|00|e|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18434; rev:10;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Adobe Acrobat Reader plugin cryptocme2.dll dll-load exploit attempt"; flow:to_server,established; content:"c|00|r|00|y|00|p|00|t|00|o|00|c|00|m|00|e|00|2|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18438; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft LNK shortcut arbitrary dll load attempt"; flow:to_client,established; file_data; content:"|4C 00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00 46|"; content:"|20 20 EC 21 EA 3A 69 10 A2 DD 08 00 2B 30 30 9D|"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-2568; reference:cve,2015-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-046; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-020; classtype:attempted-user; sid:17042; rev:16;)
# alert tcp $HOME_NET 445 -> $HOME_NET any (msg:"FILE-OTHER Adobe Premier Pro ibfs32.dll dll-load exploit attempt"; flow:to_client,established; content:"i|00|b|00|f|00|s|00|3|00|2|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:policy security-ips drop, service netbios-ssn; reference:cve,2010-3150; reference:url,osvdb.org/show/osvdb/67554; classtype:attempted-user; sid:18530; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Multiple vendor AV gateway virus detection bypass attempt"; flow:to_client,established; file_data; content:"<a href=|22|data|3A|application/octet-stream|3B|base64,WDVPIVAlQEFQWzRcUFpYNTQoUF4pN0NDKTd9JEVJQ0FSLVNUQU5EQVJELUFOVElWSVJVUy1URVNULUZJTEUhJEgrSCo=|22|>"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,12269; reference:cve,2005-0218; classtype:misc-attack; sid:16087; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Panda Antivirus ZOO archive decompression buffer overflow attempt"; flow:to_client,established; file_data; content:"|40 29 23 28 00 00 83 08 24 48 B0 A0 C1 83 08 13 2A 5C C8 B0 A1 C3 87 10 23 4A 9C 48 B1 A2 C5 8B|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2005-3922; classtype:attempted-user; sid:17281; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Visual Basic for Applications document properties overflow attempt"; flow:to_client,established; file_data; content:"Attribut|00|e VB_Nam|00|e = "; fast_pattern; nocase; content:"|22|ThiAsDocumen|22|t"; within:15; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,19414; reference:cve,2006-3649; classtype:attempted-user; sid:17286; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Multiple vendor malformed ZIP archive Antivirus detection bypass attempt"; flow:to_client,established; file_data; content:"|73 74 07 1B 5B 32 4A 1B 5B 32 3B 35 6D 1B 5B 31 3B 33 31 6D 48 41 43 4B 45 52 20 41 54 54 41 43|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,12793; reference:url,ftp.aerasec.de/pub/advisories/unfiltered-escape-sequences/unfiltered-escape-sequences.txt; reference:url,lists.grok.org.uk/pipermail/full-disclosure/2005-March/032530.html; classtype:attempted-user; sid:17267; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Multiple vendor malformed ZIP archive Antivirus detection bypass attempt"; flow:to_client,established; file_data; content:"|13 00 00 00 46 53 43 1B 5B 32 50 4F 43 1B 5B 30 3B 35 39 2E 74 78 74 0B F0 66 66 E1 62 00 01 A3|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,12793; reference:url,ftp.aerasec.de/pub/advisories/unfiltered-escape-sequences/unfiltered-escape-sequences.txt; reference:url,lists.grok.org.uk/pipermail/full-disclosure/2005-March/032530.html; classtype:attempted-user; sid:17266; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Multiple AV vendor invalid archive checksum bypass attempt"; flow:to_client,established; file_data; content:"|50 4B 03 04 0A 00 00 00 00 00 E0 98 B8 28 00 00 00 00 44 00 00 00 44 00 00 00 09 00 00 00 65 69 63 61 72 2E 63 6F 6D 58|"; depth:40; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,12771; reference:url,archives.neohapsis.com/archives/fulldisclosure/2005-03/0207.html; classtype:attempted-user; sid:17651; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER McAfee LHA file parsing buffer overflow attempt"; flow:to_client,established; file_data; content:"-lh0-"; nocase; content:"AAAAAAAA"; within:50; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,10243; reference:cve,2005-0643; classtype:attempted-user; sid:17704; rev:13;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe CFF font storage memory corruption attempt"; flow:to_client,established; file_data; content:"|00 01 00 12 00 01 00 1C 00 81 00 00 00 1A 00 02 00 01 01 D4 01 D4 00 00 00 02 00 23 00 82 00 83 00 00 00 85 00 86 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-2417; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19684; rev:10;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Embedded Open Type Font malformed name table integer overflow attempt"; flow:to_server,established; flowbits:isset,file.eot; file_data; content:"|00 01 00 00|"; content:"|00 01|"; within:2; distance:2; content:"|00 01 00 00|"; within:100; content:"|00 04|"; within:2; distance:2; byte_test:2,>,0xffc1,0,relative; metadata:service smtp; reference:cve,2009-0232; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-029; classtype:attempted-user; sid:24535; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft LNK shortcut arbitrary dll load attempt"; flow:to_server,established; file_data; content:"|4C 00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00 46|"; content:"|20 20 EC 21 EA 3A 69 10 A2 DD 08 00 2B 30 30 9D|"; distance:0; pcre:"/\x2E\x00?d\x00?l\x00?l\x00?/Ri"; metadata:policy security-ips drop, service smtp; reference:cve,2010-2568; reference:cve,2015-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-046; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-020; classtype:attempted-user; sid:24500; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows TTF parsing counter overflow attempt"; flow:to_server,established; flowbits:isset,file.ttf; file_data; content:"cmap"; content:"|00 04|"; distance:0; content:"|00 02|"; within:2; distance:4; content:"|FF FF 00 00 00 00|"; within:6; distance:6; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-2897; reference:cve,2012-4786; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-078; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-075; classtype:attempted-admin; sid:24650; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft proxy autoconfig script system namespace import attempt"; flow:to_client,established; flowbits:isset,file.pac; file_data; content:"import"; nocase; content:"system"; distance:0; fast_pattern; nocase; pcre:"/import\s+?system[^\x3b]*?\x3b/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2012-4776; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-074; classtype:policy-violation; sid:24652; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows TTF parsing counter overflow attempt"; flow:to_client,established; flowbits:isset,file.ttf; file_data; content:"cmap"; content:"|00 04|"; distance:0; content:"|00 02|"; within:2; distance:4; content:"|FF FF 00 00 00 00|"; within:6; distance:6; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2897; reference:cve,2012-4786; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-078; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-075; classtype:attempted-admin; sid:24649; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Cisco WebEx recording format buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.wrf; content:"|1F|"; content:"|14 00 00 00 02|"; within:5; distance:4; byte_jump:4,25,relative,little; content:"|01|"; within:1; content:"|00 00|"; within:2; distance:7; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1335; classtype:attempted-user; sid:24684; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Cisco WebEx recording format buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.wrf; content:"|1F|"; content:"|14 00 00 00 02|"; within:5; distance:4; byte_jump:4,25,relative,little; content:"|01|"; within:1; content:"|00 00|"; within:2; distance:5; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1335; classtype:attempted-user; sid:24685; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx recording format buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.wrf; content:"|1F|"; content:"|14 00 00 00 02|"; within:5; distance:4; content:"|01|"; within:1; distance:24; content:"|00 00|"; within:2; distance:7; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1335; classtype:attempted-user; sid:24679; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Director rcsL chunk parsing denial of service attempt"; flow:to_server,established; flowbits:isset,file.dir; file_data; content:"|2C 52 02 4C 00 4C 33 4C 02 4C 01 61|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-2030; classtype:denial-of-service; sid:24703; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx recording format buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.wrf; content:"|1F|"; content:"|14 00 00 00 02|"; within:5; distance:4; content:"|01|"; within:1; distance:24; content:"|00 00|"; within:2; distance:5; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1335; classtype:attempted-user; sid:24678; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx recording format buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.wrf; content:"|1F|"; content:"|14 00 00 00 02|"; within:5; distance:4; byte_jump:4,25,relative,little; content:"|01|"; within:1; content:"|00 00|"; within:2; distance:5; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1335; classtype:attempted-user; sid:24680; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Cisco WebEx recording format buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.wrf; content:"|1F|"; content:"|14 00 00 00 02|"; within:5; distance:4; content:"|01|"; within:1; distance:24; content:"|00 00|"; within:2; distance:5; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1335; classtype:attempted-user; sid:24682; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director rcsL chunk parsing denial of service attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|2C 52 02 4C 00 4C 33 4C 02 4C 01 61|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2030; classtype:denial-of-service; sid:24702; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx recording format buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.wrf; content:"|1F|"; content:"|14 00 00 00 02|"; within:5; distance:4; byte_jump:4,25,relative,little; content:"|01|"; within:1; content:"|00 00|"; within:2; distance:7; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1335; classtype:attempted-user; sid:24681; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Cisco WebEx recording format buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.wrf; content:"|1F|"; content:"|14 00 00 00 02|"; within:5; distance:4; content:"|01|"; within:1; distance:24; content:"|00 00|"; within:2; distance:7; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1335; classtype:attempted-user; sid:24683; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director rcsL chunk parsing denial of service attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|42 00 57 C6 42 DD 57 C0 43 00 66 BD 42 01 57 BE|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2031; classtype:denial-of-service; sid:24761; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Director rcsL chunk parsing denial of service attempt"; flow:to_server,established; flowbits:isset,file.dir; file_data; content:"|42 00 57 C6 42 DD 57 C0 43 00 66 BD 42 01 57 BE|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-2031; classtype:denial-of-service; sid:24762; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cain & Abel Remote Desktop Protocol file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.rdp; file_data; pcre:"/^[a-z0-9]{500}/i"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,32543; reference:cve,2008-5405; classtype:attempted-user; sid:16743; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Help Workshop CNT Help contents buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.cnt; content:"Content-Type: text/plain"; fast_pattern:only; file_data; pcre:"/^[^\n]{513}/si"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,22100; reference:cve,2007-0352; classtype:web-application-attack; sid:17365; rev:13;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx recording format buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 00 00 00 00 00 02|"; byte_test:1,=,0xBB,-15,relative; content:"|CC 7C 01 00 00 00 00 00 FD|"; within:9; distance:8; content:"|01|"; within:1; distance:6; byte_test:1,>=,0x2d,10,relative; byte_test:1,>=,0x58,11,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1337; classtype:attempted-user; sid:24998; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Cisco WebEx recording format buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 00 00 00 00 00 02|"; byte_test:1,=,0xBB,-15,relative; content:"|CC 7C 01 00 00 00 00 00 FD|"; within:9; distance:8; content:"|01|"; within:1; distance:6; byte_test:1,>=,0x2d,10,relative; byte_test:1,>=,0x58,11,relative; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1337; classtype:attempted-user; sid:25000; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Cisco WebEx recording format buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 00 00 00 00 00 02|"; byte_test:1,=,0xBB,-15,relative; content:"|CC 7C 01 00 00 00 00 00 FD|"; within:9; distance:8; content:"|01|"; within:1; distance:6; byte_test:1,>=,0x2d,8,relative; byte_test:1,>=,0x58,9,relative; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1337; classtype:attempted-user; sid:24999; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx recording format buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 00 00 00 00 00 02|"; byte_test:1,=,0xBB,-15,relative; content:"|CC 7C 01 00 00 00 00 00 FD|"; within:9; distance:8; content:"|01|"; within:1; distance:6; byte_test:1,>=,0x2d,8,relative; byte_test:1,>=,0x58,9,relative; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1337; classtype:attempted-user; sid:24997; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Sophos CAB CFDATA cbData overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.cab; content:"|E7 59 20 00 77 65 6C 63 6F 6D 65 2E 63 00 BD 5A A6 30 FF FF 97 00 23 69 6E 63 6C 75 64 65 20 3C|"; fast_pattern:only; metadata:service smtp; reference:url,lock.cmpxchg8b.com/sophailv2.pdf; classtype:attempted-user; sid:25013; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Sophos CAB CFDATA cbData overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.cab; content:"|E7 59 20 00 77 65 6C 63 6F 6D 65 2E 63 00 BD 5A A6 30 FF FF 97 00 23 69 6E 63 6C 75 64 65 20 3C|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:url,lock.cmpxchg8b.com/sophailv2.pdf; classtype:attempted-user; sid:25012; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Lattice PAC Designer symbol value buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"<PacDesignData>|0A|"; depth:30; offset:15; content:"<SymbolicSchematicData>|0A|"; distance:0; content:"<Symbol>"; distance:0; content:"<Value>"; distance:0; isdataat:96,relative; content:!"</Value>"; within:96; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2915; classtype:attempted-user; sid:25247; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Lattice PAC Designer symbol value buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"<PacDesignData>|0A|"; depth:30; offset:15; content:"<SymbolicSchematicData>|0A|"; distance:0; content:"<Symbol>"; distance:0; content:"<Value>"; distance:0; isdataat:96,relative; content:!"</Value>"; within:96; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-2915; classtype:attempted-user; sid:25248; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER MSXML dynamic pointer casting arbitrary code execution attempt"; flow:to_client,established; file_data; content:"//doesnotexist[position|28 29| != 3]"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0007; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-002; classtype:attempted-user; sid:25275; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER overly large XML file MSXML heap overflow attempt"; flow:to_client,established; content:"Content-Length: 900000000"; fast_pattern:only; content:"<?xml version=|22|1.0|22|?>|0A|<catalog>"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0006; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-002; classtype:attempted-user; sid:25270; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Audition Session file stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.ses; file_data; content:"|43 4F 4F 4C 4E 45 53 53|"; depth:8; content:"|68 64 72 20|"; within:4; distance:4; content:"|01 00|"; within:2; distance:18; content:!"|00 00 00 00|"; within:4; distance:24; isdataat:841,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,47841; reference:cve,2011-0614; reference:url,www.adobe.com/support/security/bulletins/apsb11-10.html; classtype:attempted-user; sid:25309; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx WRF memory corruption attempt"; flow:to_client, established; flowbits:isset,file.wrf; file_data; content:"|1F 6A 4E 00 00 14 00 00 00 02 FF 7F 8C 02 18|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-3939; classtype:attempted-user; sid:25303; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Audition Session file stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.ses; file_data; content:"|43 4F 4F 4C 4E 45 53 53|"; depth:8; content:"|68 64 72 20|"; within:4; distance:4; content:"|01 00|"; within:2; distance:18; content:!"|00 00 00 00|"; within:4; distance:24; isdataat:841,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,47841; reference:cve,2011-0614; reference:url,www.adobe.com/support/security/bulletins/apsb11-10.html; classtype:attempted-user; sid:25310; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Audition Session file tkrm stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.ses; file_data; content:"|43 4F 4F 4C 4E 45 53 53|"; depth:8; content:"|54 52 4B 4D|"; distance:0; byte_jump:4,16,relative,multiplier 2,little; byte_jump:4,8,relative,multiplier 2,little; byte_jump:4,48,relative,multiplier 2,little; byte_jump:4,4,relative,multiplier 2,little; byte_jump:4,0,relative,multiplier 2,little; byte_jump:4,4,relative,multiplier 2,little; byte_test:4,>,12,20,relative,little; content:!"|00 00|"; within:24; distance:24; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,47841; reference:cve,2011-0614; reference:url,www.adobe.com/support/security/bulletins/apsb11-10.html; classtype:attempted-user; sid:25332; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Cisco WebEx WRF memory corruption attempt"; flow:to_server, established; flowbits:isset,file.wrf; file_data; content:"|1F 6A 4E 00 00 14 00 00 00 02 FF 7F 8C 02 18|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2012-3939; classtype:attempted-user; sid:25304; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx player remote code execution attempt"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|FF 7F 25 00 88 03 8C 02 CC 7C 01 00 00 00 00 00 FD 7E 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-4004; classtype:attempted-user; sid:25341; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER CoolPlayer Playlist File Handling Buffer Overflow"; flow:to_client,established; content:"Content-Type|3A|"; nocase; http_header; content:"audio|2F|x-mpegurl"; within:30; fast_pattern; nocase; http_header; file_data; content:"aaaaaaaaaaaaa"; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,30418; reference:cve,2008-3408; classtype:attempted-user; sid:17309; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"FILE-OTHER CoolPlayer Playlist File Handling Buffer Overflow"; flow:to_client,established; content:"AAAAAAAAAAAAA|EB 06|u|F5 95 7C|AAAA|81 C4|T|F2 FF FF|j"; fast_pattern:only; reference:bugtraq,30418; reference:cve,2008-3408; classtype:attempted-user; sid:18591; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"FILE-OTHER Adobe RoboHelp Server Arbitrary File Upload"; flow:to_server,established; content:"POST"; http_method; content:"/robohelp/server?PUBLISH"; fast_pattern; nocase; http_uri; content:"Content-Disposition"; nocase; content:"filename="; distance:0; nocase; metadata:service http; reference:bugtraq,36245; reference:cve,2009-3068; classtype:attempted-admin; sid:18800; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple QuickTime TeXML style sub-element buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"<text3GTrack"; fast_pattern:only; content:"<style"; nocase; content:"line-height|3A|"; distance:0; nocase; content:!"|7D|"; within:16; pcre:"/line-height\x3a\s*?\d{16}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,56557; reference:cve,2012-3752; reference:url,support.apple.com/kb/HT5581; classtype:attempted-user; sid:25649; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER ELF file parsing in different antivirus evasion attempt"; flow:to_server,established; file_data; content:"|7F|ELF"; depth:4; content:"|4A 46 49 46|"; within:4; distance:2; metadata:service smtp; reference:cve,2012-1431; reference:url,securityfocus.com/archive/1/522005; classtype:bad-unknown; sid:25633; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple QuickTime TeXML style sub-element buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"<text3GTrack"; fast_pattern:only; content:"<style"; nocase; content:"font-table|3A|"; distance:0; nocase; content:!"|7D|"; within:16; pcre:"/font-table\x3a\s*?\d{16}/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56438; reference:bugtraq,56557; reference:cve,2012-3752; reference:cve,2012-3758; reference:url,support.apple.com/kb/HT5581; classtype:attempted-user; sid:25644; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple QuickTime TeXML style sub-element buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"<text3GTrack"; fast_pattern:only; content:"<style"; nocase; content:"font-size|3A|"; distance:0; nocase; content:!"|7D|"; within:16; pcre:"/font-size\x3a\s*?\d{16}/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56557; reference:cve,2012-3752; reference:url,support.apple.com/kb/HT5581; classtype:attempted-user; sid:25645; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Csound hetro audio file buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.csd; file_data; content:"|81 C4 54 F2 FF FF|"; fast_pattern:only; content:"|46 54 95 6E|"; metadata:service smtp; reference:cve,2012-0270; classtype:attempted-user; sid:25608; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple QuickTime TeXML style sub-element buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"<text3GTrack"; fast_pattern:only; content:"<style"; nocase; content:"font-table|3A|"; distance:0; nocase; content:!"|7D|"; within:16; pcre:"/font-table\x3a\s*?\d{16}/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,56557; reference:cve,2012-3752; reference:url,support.apple.com/kb/HT5581; classtype:attempted-user; sid:25647; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple QuickTime TeXML style sub-element buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"<text3GTrack"; fast_pattern:only; content:"<style"; nocase; content:"line-height|3A|"; distance:0; nocase; content:!"|7D|"; within:16; pcre:"/line-height\x3a\s*?\d{16}/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56557; reference:cve,2012-3752; reference:url,support.apple.com/kb/HT5581; classtype:attempted-user; sid:25646; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Csound hetro audio file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.csd; file_data; content:"|81 C4 54 F2 FF FF|"; fast_pattern:only; content:"|46 54 95 6E|"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-0270; classtype:attempted-user; sid:25607; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple QuickTime TeXML style sub-element buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"<text3GTrack"; fast_pattern:only; content:"<style"; nocase; content:"font-size|3A|"; distance:0; nocase; content:!"|7D|"; within:16; pcre:"/font-size\x3a\s*?\d{16}/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,56438; reference:bugtraq,56557; reference:cve,2012-3752; reference:cve,2012-3758; reference:url,support.apple.com/kb/HT5581; classtype:attempted-user; sid:25648; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Visual Basic VBP file reference overflow attempt"; flow:to_client,established; file_data; content:"Reference"; nocase; pcre:"/^Reference\s*=\s*\*\x5CG\{[A-Z\d-]{36}\}\x23\d+\.\d+\x23\d+\x23[^\r\n]{474}/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,25629; reference:cve,2007-4776; classtype:attempted-user; sid:12618; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft EMF+ GpFont.SetData buffer overflow attempt"; flow:to_client,established; file_data; content:"|01 00 00 00|"; content:" EMF"; within:4; distance:36; byte_jump:4,-40,relative,little; content:"F|00 00 00|,|00 00 00| |00 00 00|"; within:12; distance:-8; content:"F|00 00 00|"; distance:0; content:"|08|@|00 06|"; within:4; distance:12; byte_test:4,>,4261412864,28,relative,little; metadata:service http; reference:bugtraq,34250; reference:cve,2009-1217; classtype:attempted-user; sid:15430; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Apple Mac OS X installer package filename format string vulnerability"; flow:to_server,established; content:".distz"; nocase; http_uri; pcre:"/GET\s+[^\x0D\x0A]*\x25[^\x0D\x0A]*\x2Edistz/smi"; metadata:service http; reference:cve,2007-0465; classtype:attempted-admin; sid:16003; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Apple Mac OS X installer package filename format string vulnerability"; flow:to_server,established; content:".pkg"; nocase; http_uri; pcre:"/GET\s+[^\x0D\x0A]*\x25[^\x0D\x0A]*\x2Epkg/smi"; metadata:service http; reference:cve,2007-0465; classtype:attempted-admin; sid:16002; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Apple Mac OS X installer package filename format string vulnerability"; flow:to_server,established; content:".mpkg"; nocase; http_uri; pcre:"/GET\s+[^\x0D\x0A]*\x25[^\x0D\x0A]*\x2Empkg/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2007-0465; classtype:attempted-admin; sid:16004; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER VMWare OVF Tool format string exploit attempt"; flow:to_server,established; file_data; content:"ovf:name"; nocase; content:"%"; within:50; pcre:"/<Description>[^<]*?\x25(\d+\x24)?(\d+)?[nxcsd]/i"; metadata:policy security-ips drop, service smtp; reference:bugtraq,56468; reference:cve,2012-3569; reference:url,osvdb.org/show/osvdb/87117; reference:url,www.vmware.com/security/advisories/VMSA-2012-0015; classtype:attempted-user; sid:25813; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER VMWare OVF Tool format string exploit attempt"; flow:to_client,established; file_data; content:"ovf:diskId"; nocase; content:"%"; within:75; distance:-75; pcre:"/^(\d+\x24)?(\d+)?[nxcsd]/iR"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56468; reference:cve,2012-3569; reference:url,osvdb.org/show/osvdb/87117; reference:url,www.vmware.com/security/advisories/VMSA-2012-0015; classtype:attempted-user; sid:25810; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER VMWare OVF Tool format string exploit attempt"; flow:to_client,established; file_data; content:"ovf:name"; nocase; content:"%"; within:50; pcre:"/<Description>[^<]*?\x25(\d+\x24)?(\d+)?[nxcsd]/i"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56468; reference:cve,2012-3569; reference:url,osvdb.org/show/osvdb/87117; reference:url,www.vmware.com/security/advisories/VMSA-2012-0015; classtype:attempted-user; sid:25811; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER VMWare OVF Tool format string exploit attempt"; flow:to_server,established; file_data; content:"ovf:diskId"; nocase; content:"%"; within:75; distance:-75; pcre:"/^(\d+\x24)?(\d+)?[nxcsd]/iR"; metadata:policy security-ips drop, service smtp; reference:bugtraq,56468; reference:cve,2012-3569; reference:url,osvdb.org/show/osvdb/87117; reference:url,www.vmware.com/security/advisories/VMSA-2012-0015; classtype:attempted-user; sid:25812; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Director remote code execution attempt"; flow:to_server,established; flowbits:isset,file.dir; file_data; content:"|00 23 6F 98 00 00 00 00 00 00 00 62 00 00 00 01 00 0F FF FF|"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:cve,2010-2873; classtype:attempted-user; sid:26029; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Known malicious jar archive download attempt"; flow:to_client,established; flowbits:isset,file.jar; file_data; content:"ImAlpha$MyColorSpace.classPK"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,58238; reference:cve,2013-1493; classtype:attempted-admin; sid:26030; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Shockwave Director rcsL chunk memory corruption attempt"; flow:to_server,established; flowbits:isset,file.dir; file_data; content:"rcsL"; isdataat:203,relative; content:"|FF F0 02 67|"; within:4; distance:203; metadata:policy security-ips drop, service smtp; reference:bugtraq,42682; reference:cve,2010-2873; reference:url,www.adobe.com/support/security/bulletins/apsb10-20.html; classtype:attempted-user; sid:26028; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Director file file rcsL overflow attempt"; flow:to_server,established; flowbits:isset,file.dir; file_data; content:"Shockwave 3D"; fast_pattern:only; content:"rcsL"; nocase; byte_test:1,>,127,76,relative; metadata:policy security-ips drop, service smtp; reference:cve,2010-2867; classtype:attempted-user; sid:26027; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Sophos Anti-Virus CAB file overflow attempt"; flow:to_client,established; file_data; content:"MSCF"; depth:4; byte_test:2,>,8192,22,little,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,17876; reference:cve,2006-0994; classtype:attempted-admin; sid:6504; rev:14;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Lattice Semiconductor ispXCF version attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"<ispXCF version=|22|"; isdataat:512,relative; content:!"</ispXCF>"; within:512; metadata:service smtp; reference:bugtraq,53562; classtype:attempted-user; sid:26123; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Lattice Semiconductor ispXCF version attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"<ispXCF version=|22|"; isdataat:512,relative; content:!"</ispXCF>"; within:512; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,53562; classtype:attempted-user; sid:26122; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER CyberLink Power2Go name parameter overflow attempt"; flow:to_server,established; flowbits:isset,file.p2g; file_data; content:"<File"; content:"name=|22|"; within:10; isdataat:200,relative; content:!"|22|"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,50997; reference:cve,2011-5171; reference:url,osvdb.org/show/osvdb/77600; classtype:attempted-user; sid:26210; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER CyberLink Power2Go name parameter overflow attempt"; flow:to_client,established; flowbits:isset,file.p2g; file_data; content:"<File"; content:"name=|22|"; within:10; isdataat:200,relative; content:!"|22|"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,50997; reference:cve,2011-5171; reference:url,osvdb.org/show/osvdb/77600; classtype:attempted-user; sid:26209; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Watering Hole Campaign applet download"; flow:established,to_server; content:"/AppletLow.jar"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:cve,2011-3544; classtype:trojan-activity; sid:26295; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Watering Hole Campaign applet download"; flow:established,to_server; content:"/AppletHigh.jar"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:cve,2013-0422; classtype:trojan-activity; sid:26294; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Corel WordPerfect document parsing buffer overflow attempt"; flow:to_client,established; file_data; content:"|FF|WPC"; depth:4; content:"|01 0A 02|"; within:3; distance:4; content:"|DD 0A|"; distance:0; content:"|01|"; within:1; distance:3; content:!"|03 00|"; within:2; distance:2; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-4900; classtype:misc-activity; sid:26340; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 445 (msg:"FILE-OTHER SMI file download request"; flow:to_server,established; content:"|FF|SMB|A2|"; content:"s|00|m|00|i|00|"; distance:0; flowbits:set,smb.smi; flowbits:noalert; metadata:service netbios-ssn; reference:bugtraq,49149; reference:url,osvdb.org/show/osvdb/74604; classtype:misc-activity; sid:20225; rev:6;)
# alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"FILE-OTHER MPlayer SMI file buffer overflow attempt"; flow:to_client,established; flowbits:isset,smb.smi; content:"|3C|SAMI|3E|"; content:"Start|3D|"; distance:0; nocase; isdataat:500,relative; content:!"Start|3D|"; within:500; nocase; metadata:service netbios-ssn; reference:bugtraq,49149; reference:url,osvdb.org/show/osvdb/74604 ; classtype:attempted-user; sid:20226; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER readme.eml autoload attempt"; flow:to_client,established; file_data; content:"window.open|28 22|readme.eml|22|"; nocase; metadata:ruleset community, service http; reference:url,www.cert.org/advisories/CA-2001-26.html; classtype:attempted-user; sid:1290; rev:16;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER local resource redirection attempt"; flow:to_client,established; content:"Location|3A|"; nocase; http_header; pcre:"/^Location\x3a(\s*|\s*\r?\n\s+)*URL\s*\x3a/smiH"; metadata:ruleset community, service http; reference:cve,2004-0549; reference:url,www.kb.cert.org/vuls/id/713878; classtype:attempted-user; sid:2577; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER HCP URI uplddrvinfo access"; flow:to_client,established; file_data; content:"hcp|3A|"; nocase; content:"uplddrvinfo.htm?"; distance:0; nocase; content:"file|3A|"; distance:0; nocase; pcre:"/hcp\x3A[^\r\n]+uplddrvinfo\x2Ehtm\x3F[^\r\n]*file\x3A/smi"; metadata:service http; reference:bugtraq,5478; reference:cve,2002-0974; reference:url,technet.microsoft.com/en-us/security/bulletin/ms02-060; classtype:misc-activity; sid:8413; rev:8;)
# alert tcp $EXTERNAL_NET [80,5190,8090] -> $HOME_NET any (msg:"FILE-OTHER Ultravox-Max-Msg header integer overflow attempt"; flow:to_client,established; content:"Ultravox-Max-Msg|3A|"; nocase; byte_test:10,>,65535,0,relative,string; metadata:policy max-detect-ips drop, service http; reference:bugtraq,20744; reference:cve,2006-5567; reference:url,www.winamp.com/player/version_history.php; classtype:attempted-user; sid:9434; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Gnu gv buffer overflow attempt"; flow:to_client,established; file_data; content:"%%DocumentMedia|3A|"; nocase; isdataat:257,relative; content:!"|0A|"; within:257; metadata:service http; reference:bugtraq,20978; reference:cve,2006-5864; classtype:attempted-user; sid:9619; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER PCRE character class heap buffer overflow attempt"; flow:to_client,established; file_data; content:"RegExp"; content:"[[!!]][[!!]][[!!]]"; within:50; fast_pattern; metadata:policy max-detect-ips drop, service http; reference:bugtraq,25002; reference:cve,2007-3944; reference:url,osvdb.org/show/osvdb/36453; classtype:attempted-user; sid:12286; rev:16;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER fCreateShellLink function use - potential attack"; flow:to_client,established; file_data; content:"fCreateShellLink|28|"; fast_pattern:only; metadata:service http; reference:bugtraq,29792; reference:cve,2008-2959; classtype:misc-activity; sid:15893; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GNU tar PAX extended headers handling overflow attempt"; flow:to_client,established; file_data; content:"GNU.sparse.numblocks=0|0A|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,16764; reference:cve,2006-0300; classtype:attempted-dos; sid:16053; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Kaspersky antivirus library heap buffer overflow - without optional fields"; flow:to_client,established; file_data; content:"MSCF"; byte_test:2,&,0x0003,26,relative,little; byte_test:2,!&,0x0004,26,relative,little; pcre:"/^.{32}([^\x00]*\x00)?[^\x00]{256}/sR"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,14998; reference:cve,2005-3142; classtype:attempted-user; sid:16295; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Kaspersky antivirus library heap buffer overflow - with optional fields"; flow:to_client,established; file_data; content:"MSCF"; depth:4; byte_test:2,&,0x0003,26,relative,little; byte_test:2,&,0x0004,26,relative,little; byte_jump:2,32,relative,little; pcre:"/^.{2}([^\x00]*\x00)?[^\x00]{256}/sR"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,14998; reference:cve,2005-3142; classtype:attempted-user; sid:16296; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER IBM Informix Client SDK NFX file InformixServerList processing stack buffer overflow attempt"; flow:to_client,established; file_data; content:"[Setnet32]"; fast_pattern; nocase; content:"ServerSize="; distance:0; byte_test:4,>,293,0,relative,dec,string; pcre:"/InformixServerList=([^\r\n\x3B]{,293}\x3B)*[^\r\n\x3B]{294}/i"; metadata:service http; reference:bugtraq,36588; reference:cve,2009-3691; classtype:attempted-user; sid:16346; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER IBM Informix Client SDK NFX file HostList processing stack buffer overflow attempt"; flow:to_client,established; file_data; content:"[Setnet32]"; fast_pattern; nocase; content:"HostSize="; distance:0; byte_test:4,>,296,0,relative,dec,string; pcre:"/HostList=([^\r\n\x3B]{,296}\x3B)*[^\r\n\x3B]{297}/i"; metadata:service http; reference:bugtraq,36588; reference:cve,2009-3691; classtype:attempted-user; sid:16345; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Illustrator DSC comment overflow attempt"; flow:to_client,established; file_data; content:"%!PS-Adobe-"; nocase; content:"EPSF-"; within:10; pcre:"/%[^\x0d\x0a]{1000}/smiR"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,37192; reference:cve,2009-4195; classtype:attempted-user; sid:16359; rev:15;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle JRE Java Platform SE and Java Deployment Toolkit plugins code execution attempt - npruntime-scriptable-plugin"; flow:to_client,established; content:"application/npruntime-scriptable-plugin|3B|deploymenttoolkit"; nocase; http_header; file_data; content:"-J-jar"; pcre:"/http\x3A\s+-J-jar\s+-J[^\s]+\x2Ejar/i"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16549; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle JRE Java Platform SE and Java Deployment Toolkit plugins code execution attempt - java-deployment-toolkit"; flow:to_client,established; content:"application/java-deployment-toolkit"; nocase; http_header; file_data; content:"-J-jar"; pcre:"/http\x3A\s+-J-jar\s+-J[^\s]+\x2Ejar/i"; metadata:policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16550; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Un4seen Developments XMPlay crafted ASX file buffer overflow attempt"; flow:to_client,established; file_data; content:"<ASX VERSION=|22|3|22|>"; nocase; content:"<Entry>"; distance:0; nocase; content:"<ref href=|22|file|3A|//"; distance:0; nocase; pcre:"/^\S{501}/R"; metadata:service http; reference:bugtraq,21206; reference:cve,2006-6063; classtype:attempted-user; sid:16582; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Amaya web editor XML and HTML Parser Buffer overflow attempt"; flow:to_client,established; file_data; content:"<bdo"; nocase; pcre:"/^.*?dir\s*=\s*(\x22[^\x22]{500}|\x27[^\x27]{500}|[^\s\>]{500})/isR"; metadata:service http; reference:bugtraq,33047; reference:cve,2009-0323; classtype:attempted-user; sid:16601; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Astonsoft Deepburner db file path buffer overflow attempt"; flow:to_client,established; file_data; content:"|3C|DeepBurner_record"; nocase; content:"|3C|data_cd"; distance:0; nocase; content:"|3C|file"; distance:0; nocase; content:"path|3D|"; nocase; isdataat:272,relative; content:!"imp|3D 22 30 22 20 2F 3E|"; within:272; metadata:service http; reference:bugtraq,21657; reference:cve,2006-6665; reference:url,osvdb.org/show/osvdb/32356; classtype:attempted-user; sid:16696; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER gAlan malformed file stack overflow attempt"; flow:to_client,established; file_data; content:"Mjik"; depth:4; pcre:"/^[^\s\x00]{512}/R"; metadata:service ftp-data, service http, service imap, service pop3; reference:url,osvdb.org/show/osvdb/60897; classtype:attempted-user; sid:16726; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER UltraISO CCD file handling overflow attempt"; flow:to_client,established; file_data; content:"[CloneCD]"; depth:9; content:"INDEX 1="; distance:0; isdataat:256,relative; content:!"|0A|"; within:256; metadata:service http; reference:cve,2009-1260; reference:url,osvdb.org/show/osvdb/53275; classtype:attempted-user; sid:16733; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER CA multiple product AV engine CAB header parsing stack overflow attempt"; flow:to_client,established; file_data; content:"MSCF"; depth:4; byte_test:2,=,1,24,relative,little; byte_jump:4,12,relative,post_offset -20,little; pcre:"/^.{16}[^\x00]{256}/sR"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,24330; reference:cve,2007-2864; classtype:attempted-user; sid:16719; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Orbital Viewer .orb stack buffer overflow attempt"; flow:to_client,established; file_data; content:"OrbitalFileV1.0|0D 0A|"; nocase; pcre:"/^[^\x00]{512}/R"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,38436; reference:cve,2010-0688; classtype:attempted-user; sid:16721; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER IDEAL Administration IPJ file handling stack overflow attempt"; flow:to_client,established; file_data; content:"|0D 0A|[Group,Export,Yes]|0D 0A|"; depth:22; content:"Computer="; distance:0; pcre:"/^[^\s\x00]{512}/R"; metadata:service http; reference:cve,2009-4265; reference:url,osvdb.org/show/osvdb/60681; classtype:attempted-user; sid:16727; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER SafeNet SoftRemote multiple policy file local overflow attempt"; flow:to_client,established; file_data; content:"|5B|HKEY_LOCAL_MACHINE|5C|SOFTWARE|5C|IRE|5C|SafeNet|2F|Soft-PK|5C|ACL|5C|GROUPDEFS|5C|_SafeNet_Default_Group|5D|"; content:"|22|GROUPNAME|22 3D 22|"; distance:0; isdataat:256,relative; content:!"|22|"; within:256; metadata:service http; reference:cve,2009-3861; reference:url,osvdb.org/show/osvdb/59724; classtype:attempted-user; sid:16732; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER VariCAD multiple products DWB file handling overflow attempt"; flow:to_client,established; file_data; content:"|34 87 01 00 00 00 00 00 25 5C 1F 85|"; depth:12; pcre:"/^[^\x0a\x3d]{512}/R"; metadata:service http; reference:bugtraq,38815; reference:url,osvdb.org/show/osvdb/63067; classtype:attempted-user; sid:16736; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER ProShow Gold PSH file handling overflow attempt"; flow:to_client,established; file_data; content:"Photodex|28|R|29| ProShow|28|TM|29| Show File Version"; depth:41; content:"cell[0].images[0].image="; distance:0; isdataat:512,relative; content:!"|0A|"; within:512; metadata:service http; reference:cve,2009-3214; reference:url,osvdb.org/show/osvdb/57226; classtype:attempted-user; sid:16730; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER FeedDemon OPML file handling buffer overflow attempt"; flow:to_client,established; file_data; content:"|3C|opml"; nocase; content:"|3C|outline"; distance:0; nocase; pcre:"/[^\x3E]*?text\s*\x3D\s*(\x27[^\x27]{500}|\x22[^\x22]{500}|\S{500})/iR"; metadata:service http; reference:bugtraq,33630; reference:cve,2009-0546; classtype:attempted-user; sid:17104; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER FeedDemon unicode OPML file handling buffer overflow attempt"; flow:to_client,established; file_data; content:"|3C 00|o|00|p|00|m|00|l|00|"; nocase; content:"|3C 00|o|00|u|00|t|00|l|00|i|00|n|00|e|00|"; distance:0; nocase; pcre:"/[^\x3E]*?t\x00e\x00x\x00t\x00(\s\x00)*\x3D\x00(\s\x00)*(\x27\x00(?!(..){0,500}\x27\x00)|\x22\x00(?!(..){0,500}\x22\x00)|(?!(..){0,500}\s\x00))/isOR"; metadata:service http; reference:bugtraq,33630; reference:cve,2009-0546; classtype:attempted-user; sid:17105; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Nullsoft Winamp ID3v2 Tag Handling Buffer Overflow attempt"; flow:to_client,established; file_data; content:"ID3"; depth:3; pcre:"/T(PE(1|2)|IT2)/iR"; byte_test:4,>,0x190,0,relative,big; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,14276; reference:cve,2005-2310; classtype:attempted-user; sid:17351; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"PK|01 02|"; byte_test:2,<,99,6; byte_extract:2,24,name_len,relative,little; content:">"; within:name_len; distance:16; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-0850; classtype:attempted-user; sid:17459; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"PK|01 02|"; byte_extract:2,24,name_len,relative,little; content:"<"; within:name_len; distance:16; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-0850; classtype:attempted-user; sid:17458; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_client,established; content:"gzip"; http_header; content:"|0D 0A 0D 0A 1F 8B|"; byte_test:1,&,0x08,1,relative; content:"<"; within:20; distance:8; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-0850; classtype:attempted-user; sid:17460; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer SWF frame handling buffer overflow attempt"; flow:to_client,established; file_data; content:"|E5 05 00 00 78 00 05 5F 00 00 0F A0 00 00 0C 01 00 43 02 FF FF FF BF 00 39 00 00 00 01 00 70 F2|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,30370; reference:cve,2007-5400; classtype:attempted-user; sid:17633; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER ClamAV antivirus CHM file handling DOS"; flow:to_client,established; file_data; content:"ITSF"; content:"|11 FD 01 7C AA 7B D0 11 9E 0C 00 A0 C9 22 E6 EC|"; within:16; distance:36; content:"ITSP"; distance:0; byte_test:4,<,8,12,relative,little; metadata:policy max-detect-ips drop, service http; reference:bugtraq,30994; reference:cve,2008-1389; reference:url,sourceforge.net/project/shownotes.php?group_id=86638&release_id=623661; classtype:attempted-dos; sid:17602; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Adobe Photoshop wintab32.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|wintab32.dll"; nocase; http_uri; metadata:policy security-ips drop, service http; reference:cve,2010-3127; reference:url,osvdb.org/show/osvdb/67545; classtype:attempted-user; sid:18488; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Adobe Premiere Pro ibfs32.dll dll-load exploit attempt"; flow:to_server,established; content:"ibfs32.dll"; nocase; http_uri; metadata:policy security-ips drop, service http; reference:cve,2010-3150; reference:url,osvdb.org/show/osvdb/67554; classtype:attempted-user; sid:18529; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Adobe Audition assist.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|assist.dll"; nocase; http_uri; metadata:service http; classtype:attempted-user; sid:19619; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Wireshark DECT packet dissector overflow attempt"; flow:to_client,established; file_data; content:"|D4 C3 B2 A1 02 00 04 00|"; depth:8; byte_test:4,>,1499,36,little; content:"|FF FF FF FF FF FF 00 00 00 00 00 00 23 23|"; depth:14; offset:40; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,47392; reference:cve,2011-1591; reference:url,osvdb.org/show/osvdb/71848; classtype:attempted-user; sid:20431; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Telnet protocol specifier command injection attempt"; flow:to_client,established; file_data; content:"telnet|3A 2F 2F|"; nocase; pcre:"/(src|href)\s*=\s*(\x22|\x27|)telnet\x3a\x2f\x2f\x2D/i"; metadata:service http; reference:bugtraq,10358; reference:cve,2004-0411; classtype:attempted-user; sid:20698; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER multiple products GeckoActiveX COM object recon attempt"; flow:to_client,established; file_data; content:"GeckoActiveXObject"; fast_pattern; nocase; content:"COM"; pcre:"/var\s*?\w+?\s*\x3D\s*new\s*GeckoActiveXObject[^\x7B]*?catch\s*\x28(?P<exceptionname>\w+?)\x29.*?var\s*?(?P<errormessage>\w+?)\s*\x3D\s*(?P=exceptionname)\x2EtoString\x28\x29.[^\x7B]*?(?P=errormessage)\x2Ematch\x28.*?COM/smi"; metadata:service http; reference:bugtraq,37360; reference:cve,2009-3987; classtype:attempted-recon; sid:21165; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER WordPerfect WP3TablesGroup heap overflow attempt"; flow:to_client,established; file_data; content:"|FF|WPC"; depth:4; pcre:"/^.{5}\x2C[\x02\x03\x04]/R"; content:"|E2 01|"; byte_extract:2,0,test,relative; byte_jump:2,-2,relative,post_offset -4; byte_test:2,=,test,0,relative; content:"|01 E2|"; within:2; distance:2; byte_test:1,>,32,79,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2007-0002; classtype:attempted-user; sid:21437; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER IBM Installation Manager iim uri code execution attempt"; flow:established,to_client; file_data; content:"iim|3A 2F 2F|"; nocase; pcre:"/^\x22(%20|\s)-vm/Ri"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,36549; reference:cve,2009-3518; classtype:attempted-user; sid:21607; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER VLC mms hostname buffer overflow attempt"; flow:to_client,established; file_data; content:"mms|3A 2F 2F|"; nocase; isdataat:4018,relative; pcre:"/^[^\x22\x27]{4018}/R"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1775; reference:url,osvdb.org/show/osvdb/80188; reference:url,www.videolan.org/security/sa1201.html; classtype:attempted-user; sid:21922; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER zlib Denial of Service"; flow:to_client,established; file_data; content:"x|9C 85 C1 B9 11 80|0|10 04|A|EC A9 9A A0 C4|+|1E 91 7F FE D8 EB|p|DD AD FD 93 B9| KA|D6 82|l|05 D9 0B|r|14 A4|'9|93 5C|I|EE 24|O|92 91 E4|M2}yw[|86|"; metadata:service http; reference:bugtraq,11051; reference:cve,2004-0797; classtype:attempted-user; sid:15981; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER McAfee LHA file handling overflow attempt"; flow:to_client,established; file_data; content:"testfile|F8 1B|U|05 00|P|B4 81 94 01 01|AAAA"; metadata:service http; reference:bugtraq,10243; reference:cve,2005-0643; classtype:attempted-user; sid:15949; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Trend Micro Products Antivirus Library overflow attempt"; flow:to_client,established; file_data; content:"NEKP2E|00 00 00|E|00 00 00 DB|+|D0 1D 00 00| |00 00 00|AAAA"; metadata:service http; reference:bugtraq,12643; reference:cve,2005-0533; classtype:attempted-user; sid:15992; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER F-Secure Anti-Virus LHA processing buffer overflow attempt"; flow:to_client,established; file_data; content:"!|C3|-lh0-|18 00 00 00 05 00 00 00 FA BB|m0 |01 08|testfile|F8 1B|U|05 00|P|B4 81 94 01 01|UUUU"; metadata:service http; reference:bugtraq,10243; reference:cve,2004-0234; classtype:attempted-user; sid:15966; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER X.org PCF parsing buffer overflow attempt"; flow:to_client,established; file_data; content:"|01|fcp|08 00 00 00 01 00 00 00 0E 00 00 00 A0 02 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,27352; reference:cve,2008-0006; classtype:attempted-user; sid:16070; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER 2imaegshack/lmageshack IM worm get request attempt"; flow:to_server,established; content:"/s/im.php"; nocase; http_uri; flowbits:set,lmageshack.request; flowbits:noalert; metadata:service http; reference:url,anubis.iseclab.org/?action=result&task_id=1d4d78a7507bb63143d45d2a5898fe3bf&format=html; classtype:misc-activity; sid:16556; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER 2imaegshack/lmageshack IM worm inbound communication attempt"; flow:to_client,established; flowbits:isset,lmageshack.request; file_data; content:"lmageshack"; nocase; metadata:service http; reference:url,anubis.iseclab.org/?action=result&task_id=1d4d78a7507bb63143d45d2a5898fe3bf&format=html; classtype:misc-activity; sid:16557; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Symantec multiple products AeXNSConsoleUtilities buffer overflow attempt"; flow:to_client,established; file_data; content:"<object classid='clsid|3A|B44D252D-98FC-4D5C-948C-BE868392A004'"; fast_pattern:only; content:"=String|28|310,|22|A|22 29|"; content:"=unescape"; distance:0; metadata:service http; reference:bugtraq,36698; reference:cve,2009-3031; classtype:attempted-user; sid:16587; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER URSoft W32Dasm Import/Export function buffer overflow attempt"; flow:to_client,established; file_data; content:"|D4 30 00 00 00 00 00 00 00 00 00 00 E0 30 00 00 F0 30 00 00 F8 30 00 00 00 31 00 00 00 00 00 00 78 02|"; isdataat:256,relative; content:!"|00|"; within:256; metadata:service http; reference:bugtraq,12352; reference:cve,2005-0308; classtype:attempted-user; sid:16735; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER ProShow Gold PSH file handling overflow attempt"; flow:to_client,established; file_data; content:"ProShow Gold - Built-In Content/Backgrounds/Abstract_02.jpgAAAAAAAAAAAAAAA"; fast_pattern:only; metadata:service http; reference:cve,2009-3214; reference:url,osvdb.org/show/osvdb/57226; classtype:attempted-user; sid:16731; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Symantec multiple products AeXNSConsoleUtilities RunCMD buffer overflow attempt"; flow:to_client,established; file_data; content:"|2E|RunCMD|28|"; fast_pattern:only; content:"catch|28| e |29 20 7B| window|2E|location|20 3D|"; metadata:service http; reference:bugtraq,37092; reference:cve,2009-3033; reference:url,osvdb.org/show/osvdb/60496; classtype:attempted-user; sid:16787; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Orbit Downloader long URL buffer overflow attempt"; flow:to_client,established; file_data; content:"classid|3D 27|clsid|3A|3F1D494B-0CEF-4468-96C9-386E2E4DEC90|27|"; content:"String|28 27|http|3A 2F 2F|"; distance:0; content:!"|27|"; within:255; metadata:service http; reference:cve,2008-1602; reference:cve,2009-0187; classtype:attempted-user; sid:16798; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Antivirus ACE file handling buffer overflow attempt"; flow:to_client,established; file_data; content:"|2A 2A 41 43 45 2A 2A|"; depth:7; offset:7; content:"|01 80 1C 00 00 00 BE 02 00 00 C5 5A 08 33 20 00 00 00 80 98 92 84 02 03 0A 00 54 45 07 02|"; distance:0; metadata:policy max-detect-ips drop, service http; reference:cve,2005-2385; reference:cve,2005-2720; classtype:attempted-user; sid:17244; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GNU gzip LZH decompression make_table overflow attempt"; flow:to_client,established; file_data; content:"|1F A0 AB CD FF FF FF FF FF FF FF FF FF FF FF FF|"; depth:16; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2006-4335; reference:url,secunia.com/advisories/21996/; classtype:attempted-user; sid:17289; rev:14;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER ClamAV libclamav PE file handling integer overflow attempt"; flow:to_client,established; file_data; content:"|4D 5A 90 00 03 00 00 00 04 00 00 00 FF FF 00 00 B8 00 00 00 00 00 00 00 40 00|"; isdataat:288,relative; content:"|00 00 2E 70 65 74 69 74 65 00 00 D0 0D 00 00 30 FF FF A3 D1|"; within:20; distance:288; metadata:policy max-detect-ips drop, service http; reference:cve,2008-0318; classtype:attempted-user; sid:17305; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER probable multi-mesh injection attack"; flow:to_client,established; flowbits:isset,http.multimesh; file_data; content:"document.createElement|28|"; depth:50; metadata:service http; reference:url,blog.armorize.com/2011/06/mass-meshing-injection-sidenamejs.html; classtype:attempted-user; sid:19300; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Ultra Shareware Office HttpUpload buffer overflow attempt"; flow:to_client,established; file_data; content:".HttpUpload"; fast_pattern; nocase; isdataat:10,relative; content:!"|29|"; within:10; metadata:service http; reference:bugtraq,30861; reference:cve,2008-3878; classtype:attempted-user; sid:21759; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Cisco WebEx recording integer overflow attempt"; flow:to_server,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 02|"; depth:2000; fast_pattern; content:"|01 00 00 00|"; within:4; distance:15; byte_test:2,>=,0x8000,0,relative,little; metadata:service smtp; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20111026-webex; classtype:attempted-user; sid:26432; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Shadow Stream Recorder asx file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.asx; file_data; content:"<asx "; depth:5; content:"href=|22|"; distance:0; isdataat:500,relative; content:!"|22|"; within:500; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,34864; reference:cve,2009-1641; reference:cve,2009-1642; reference:cve,2009-1645; classtype:attempted-user; sid:26459; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Shadow Stream Recorder asx file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.asx; file_data; content:"http|3A 2F 2F|"; depth:7; isdataat:500,relative; content:!"|22|"; within:500; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,34864; reference:cve,2009-1641; reference:cve,2009-1642; reference:cve,2009-1645; classtype:attempted-user; sid:26460; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Cisco WebEx recording integer overflow attempt"; flow:to_server,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 02|"; depth:2000; fast_pattern; content:"|01 00 00 00|"; within:4; distance:15; byte_test:2,>=,0x8000,2,relative,little; metadata:service smtp; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20111026-webex; classtype:attempted-user; sid:26433; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Shadow Stream Recorder asx file buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.asx; file_data; content:"http|3A 2F 2F|"; depth:7; isdataat:200; content:!"|22|"; within:200; metadata:service smtp; reference:bugtraq,34864; reference:cve,2009-1641; reference:cve,2009-1642; reference:cve,2009-1645; classtype:attempted-user; sid:26462; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Shadow Stream Recorder asx file buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.asx; file_data; content:"<asx "; depth:5; content:"href=|22|"; distance:0; isdataat:200,relative; content:!"|22|"; within:200; metadata:service smtp; reference:bugtraq,34864; reference:cve,2009-1641; reference:cve,2009-1642; reference:cve,2009-1645; classtype:attempted-user; sid:26461; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER CoolPlayer playlist file handling buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.m3u; file_data; content:"|28 B0 9F 7C|"; depth:20; offset:215; metadata:service smtp; reference:bugtraq,30418; reference:cve,2008-3408; reference:url,osvdb.org/show/osvdb/47194; classtype:attempted-user; sid:26476; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER CoolPlayer playlist file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.m3u; file_data; content:"|28 B0 9F 7C|"; depth:20; offset:215; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,30418; reference:cve,2008-3408; reference:url,osvdb.org/show/osvdb/47194; classtype:attempted-user; sid:26475; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER CoolPlayer playlist file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.m3u; file_data; content:"|40 69 83 7C|"; depth:20; offset:215; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,30418; reference:cve,2008-3408; reference:url,osvdb.org/show/osvdb/47194; classtype:attempted-user; sid:26473; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER CoolPlayer playlist file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.m3u; file_data; content:"|32 4C 3C 7E|"; depth:20; offset:215; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,30418; reference:cve,2008-3408; reference:url,osvdb.org/show/osvdb/47194; classtype:attempted-user; sid:26477; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER CoolPlayer playlist file handling buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.m3u; file_data; content:"|32 4C 3C 7E|"; depth:20; offset:215; metadata:service smtp; reference:bugtraq,30418; reference:cve,2008-3408; reference:url,osvdb.org/show/osvdb/47194; classtype:attempted-user; sid:26478; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER CoolPlayer playlist file handling buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.m3u; file_data; content:"|40 69 83 7C|"; depth:20; offset:215; metadata:service smtp; reference:bugtraq,30418; reference:cve,2008-3408; reference:url,osvdb.org/show/osvdb/47194; classtype:attempted-user; sid:26474; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER WellinTech KingView KingMessage log file parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.kvl; file_data; content:"6.00|00 00 00 00|"; depth:8; isdataat:280,relative; content:!"|00|"; within:128; distance:152; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-4711; reference:url,osvdb.org/show/osvdb/89690; classtype:attempted-admin; sid:26495; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER WellinTech KingView KingMessage log file parsing buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.kvl; file_data; content:"6.00|00 00 00 00|"; depth:8; isdataat:280,relative; content:!"|00|"; within:128; distance:152; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4711; reference:url,osvdb.org/show/osvdb/89690; classtype:attempted-admin; sid:26496; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Maple Maplet File Creation and Command Execution attempt"; flow:to_client,established; flowbits:isset,file.maplet|file.maplet.bin; file_data; content:"writebytes("; nocase; content:"system[launch]("; distance:0; nocase; pcre:"/(?P<q1>(\x22|\x27|))[^\n]\x2eexe(?P=q1)/Ri"; metadata:service ftp-data, service http, service imap, service pop3; reference:url,osvdb.org/show/osvdb/64541; classtype:attempted-user; sid:26520; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Maple Maplet File Creation and Command Execution attempt"; flow:to_server,established; flowbits:isset,file.maplet|file.maplet.bin; file_data; content:"writebytes("; nocase; content:"system[launch]("; distance:0; nocase; pcre:"/(?P<q1>(\x22|\x27|))[^\n]\x2eexe(?P=q1)/Ri"; metadata:service smtp; reference:url,osvdb.org/show/osvdb/64541; classtype:attempted-user; sid:26521; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER .tar multiple antivirus evasion attempt"; flow:to_client,established; file_data; content:"|57 69 6E 5A 69 70|"; depth:6; offset:29; content:"ustar"; depth:5; offset:257; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1427; classtype:attempted-user; sid:26598; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows uniscribe fonts parsing memory corruption attempt"; flow:to_client,established; flowbits:isset,file.ttf; file_data; content:"|00 43 FF F1 02 3B 02 D8 00 25 00 00 01 32 35 34 26 23 22|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,43068; reference:cve,2010-2738; reference:url,osvdb.org/show/osvdb/67984; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-063; classtype:attempted-user; sid:26649; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows uniscribe fonts parsing memory corruption attempt"; flow:to_client,established; flowbits:isset,file.doc; file_data; content:"|00 47 3E 34 CB 58 A7 A2 F5 3F D0 B9 1B CA 20 05 7E 6D|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,43068; reference:cve,2010-2738; reference:url,osvdb.org/show/osvdb/67984; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-063; classtype:attempted-user; sid:26648; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Multiple products ZIP archive virus detection bypass attempt"; flow:to_client,established; file_data; content:"|50 4B 03 04|"; content:"|00 00 00 00|"; within:4; distance:18; content:!"|00 00 00 00|"; within:4; distance:-8; content:!"META-INF"; content:!"class.pk"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,11448; reference:cve,2004-0932; classtype:bad-unknown; sid:26926; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Multiple products ZIP archive virus detection bypass attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"|50 4B 01 02|"; content:"|00 00 00 00|"; within:4; distance:20; content:!"|00 00 00 00|"; within:4; distance:-8; content:!"META-INF"; content:!"class.pk"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,11448; reference:cve,2004-0932; classtype:bad-unknown; sid:26989; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER XML exponential entity expansion attack attempt"; flow:to_client,established; file_data; content:"<?xml"; content:"<!DOCTYPE "; fast_pattern:only; content:"<!ENTITY"; pcre:"/<!ENTITY\s*(?P<entity1>[&\x3b\w]+)\s.*?<!ENTITY\s*(?P<entity2>[&\x3b\w]+)\s*[\x22\x27].*?&\s*(?P=entity1)\s*\x3b\s*&\s*(?P=entity1).*?<!ENTITY\s*[&\x3b\w]+\s*[\x22\x27].*?&\s*(?P=entity2)\s*\x3b\s*&\s*(?P=entity2)/smi"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-1664; reference:cve,2013-1665; reference:cve,2013-1821; classtype:attempted-user; sid:27096; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows HLP File Handling heap overflow attempt"; flow:to_server,established; flowbits:isset,file.hlp; file_data; content:"TTLBTREE|00 5B 21 00 00 7C 56|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,23382; reference:cve,2007-1912; classtype:attempted-user; sid:27168; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows HLP File Handling heap overflow attempt"; flow:to_server,established; file_data; content:"|3F 5F 03 00|"; depth:4; content:"TTLBTREE|00 2E 06 00 00 7C 62|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,23382; reference:cve,2007-1912; classtype:attempted-user; sid:27167; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows HLP File Handling heap overflow attempt"; flow:to_client,established; file_data; content:"|3F 5F 03 00|"; depth:4; content:"TTLBTREE|00 5B 21 00 00 7C 56|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,23382; reference:cve,2007-1912; classtype:attempted-user; sid:27166; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Embedded Open Type Font malformed name table platform type 3 integer overflow attempt"; flow:to_server,established; flowbits:isset,file.eot; file_data; content:"|00 01 00 00|"; content:"|00 01|"; within:2; distance:2; content:"|00 03 00|"; within:100; content:"|00 04|"; within:2; distance:3; byte_test:2,>,0xffc1,0,relative; byte_test:1,<,2,-5,relative; metadata:service smtp; reference:cve,2009-0232; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-029; classtype:attempted-user; sid:27251; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Trimble SketchUp PICT color entries buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.skp; file_data; content:"|12 00 01|"; offset:524; byte_test:2,>,256,60,relative,big; metadata:service smtp; reference:bugtraq,60248; reference:cve,2013-3664; classtype:attempted-user; sid:27281; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Trimble SketchUp PICT color entries buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pct|file.skp; file_data; content:"|12 00 01|"; content:"|00 00 00 00|"; within:4; distance:50; byte_test:2,>,255,6,relative,big; metadata:service smtp; reference:bugtraq,60248; reference:cve,2013-3664; classtype:attempted-user; sid:27280; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Trimble SketchUp PICT color entries buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pct|file.skp; file_data; content:"|12 00 01|"; offset:524; content:"|00 00 00 00|"; within:4; distance:50; byte_test:2,>,255,6,relative,big; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,60248; reference:cve,2013-3664; classtype:attempted-user; sid:27279; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Trimble SketchUp PICT color entries buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.skp; file_data; content:"|12 00 01|"; offset:524; byte_test:2,>,256,60,relative,big; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,60248; reference:cve,2013-3664; classtype:attempted-user; sid:27278; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_server,established; flowbits:isset,file.rar; file_data; content:"|74|"; byte_test:1,<,4,12,relative; byte_extract:2,23,name_len,relative,little; content:">"; within:name_len; distance:4; metadata:service smtp; reference:cve,2009-0850; classtype:attempted-user; sid:27591; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_server,established; flowbits:isset,file.rar; file_data; content:"|74|"; byte_test:1,<,4,12,relative; byte_extract:2,23,name_len,relative,little; content:"<"; within:name_len; distance:4; metadata:service smtp; reference:cve,2009-0850; classtype:attempted-user; sid:27590; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_server,established; content:"gzip"; http_header; content:"|0D 0A 0D 0A 1F 8B|"; byte_test:1,&,0x10,1,relative; byte_jump:2,8,relative,little; content:">"; within:20; metadata:service smtp; reference:cve,2009-0850; classtype:attempted-user; sid:27589; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_server,established; content:"gzip"; http_header; content:"|0D 0A 0D 0A 1F 8B|"; byte_test:1,&,0x10,1,relative; byte_jump:2,8,relative,little; content:"<"; within:20; metadata:service smtp; reference:cve,2009-0850; classtype:attempted-user; sid:27588; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_server,established; content:"gzip"; http_header; content:"|0D 0A 0D 0A 1F 8B|"; byte_test:1,&,0x10,1,relative; content:">"; within:20; distance:8; metadata:service smtp; reference:cve,2009-0850; classtype:attempted-user; sid:27587; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_server,established; content:"gzip"; http_header; content:"|0D 0A 0D 0A 1F 8B|"; byte_test:1,&,0x10,1,relative; content:"<"; within:20; distance:8; metadata:service smtp; reference:cve,2009-0850; classtype:attempted-user; sid:27586; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"PK|01 02|"; byte_extract:2,24,name_len,relative,little; content:">"; within:name_len; distance:16; metadata:service smtp; reference:cve,2009-0850; classtype:attempted-user; sid:27585; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"PK|01 02|"; byte_extract:2,24,name_len,relative,little; content:"<"; within:name_len; distance:16; metadata:service smtp; reference:cve,2009-0850; classtype:attempted-user; sid:27584; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_client,established; flowbits:isset,file.rar; file_data; content:"|74|"; byte_test:1,<,4,12,relative; byte_extract:2,23,name_len,relative,little; content:">"; within:name_len; distance:4; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-0850; classtype:attempted-user; sid:27583; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_client,established; flowbits:isset,file.rar; file_data; content:"|74|"; byte_test:1,<,4,12,relative; byte_extract:2,23,name_len,relative,little; content:"<"; within:name_len; distance:4; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-0850; classtype:attempted-user; sid:27582; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_client,established; content:"gzip"; http_header; content:"|0D 0A 0D 0A 1F 8B|"; byte_test:1,&,0x10,1,relative; byte_jump:2,8,relative,little; content:"<"; within:20; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-0850; classtype:attempted-user; sid:27581; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_client,established; content:"gzip"; http_header; content:"|0D 0A 0D 0A 1F 8B|"; byte_test:1,&,0x10,1,relative; byte_jump:2,8,relative,little; content:">"; within:20; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2009-0850; classtype:attempted-user; sid:27580; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows True Type Font maxComponentPoints overflow attempt"; flow:to_server,established; flowbits:isset,file.ttf; file_data; content:"|00 01 00 00|"; depth:4; content:"maxp"; depth:250; byte_jump:4,4,relative,from_beginning, post_offset 10,big; byte_test:2,>,0x8000,0,relative,big; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-0159; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-034; classtype:attempted-user; sid:27576; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER BitDefender Internet Security script code execution attempt"; flow:to_client,established; content:"gzip"; http_header; content:"|0D 0A 0D 0A 1F 8B|"; byte_test:1,&,0x08,1,relative; content:">"; within:20; distance:8; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-0850; classtype:attempted-user; sid:17778; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows XP .theme file remote code execution attempt"; flow:to_client,established; file_data; content:"[Theme]"; content:"SCRNSAVE.EXE=|5C 5C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-0810; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-071; classtype:attempted-admin; sid:27822; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER VBScript potential executable write attempt"; flow:to_client,established; file_data; content:"VBScript"; nocase; content:"|22|4D5A"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/ecfb852662d8127673332939f8b062645797e91bce6acae0615e24334a3df2ad/analysis/; classtype:attempted-user; sid:28054; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER PCRE character class heap buffer overflow attempt"; flow:to_client,established; file_data; content:"RegExp"; content:"[[**]][[**]][[**]]"; within:50; fast_pattern; metadata:service http; reference:bugtraq,25002; reference:cve,2007-3944; reference:url,osvdb.org/show/osvdb/36453; classtype:attempted-user; sid:28124; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER ATMFD Adobe font driver reserved command denial of service attempt"; flow:to_server,established; flowbits:isset,file.otf; file_data; content:"|F7 1B DF 30 61 61 0D 8B 86 8A 85 8B 85 08 F7 43|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3128; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-082; classtype:denial-of-service; sid:28203; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ATMFD Adobe font driver reserved command denial of service attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|F7 1B DF 30 61 61 0D 8B 86 8A 85 8B 85 08 F7 43|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3128; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-082; classtype:denial-of-service; sid:28202; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft .NET XML digital signature denial of service attempt"; flow:to_server,established; file_data; content:"<SignedInfo>"; fast_pattern:only; content:"<Transform"; content:"Algorithm="; within:32; content:!"/>"; within:32; content:"base64"; within:56; content:"<?xml"; nocase; content:"<root>"; distance:0; nocase; base64_decode:bytes 953, offset 0, relative; base64_data; content:"<!DOCTYPE "; content:"<!ENTITY"; distance:0; pcre:"/<!ENTITY\s*(?P<entity1>[&\x3b\w]+)\s.*?<!ENTITY\s*(?P<entity2>[&\x3b\w]+)\s*[\x22\x27].*?&\s*(?P=entity1)\s*\x3b\s*&\s*(?P=entity1).*?<!ENTITY\s*[&\x3b\w]+\s*[\x22\x27].*?&\s*(?P=entity2)\s*\x3b\s*&\s*(?P=entity2)/smi"; metadata:service smtp; reference:cve,2013-3860; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-082; classtype:attempted-user; sid:28162; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft .NET XML digital signature denial of service attempt"; flow:to_client,established; file_data; content:"<SignedInfo>"; fast_pattern:only; content:"<Transform"; content:"Algorithm="; within:32; content:!"/>"; within:32; content:"base64"; within:56; content:"<?xml"; nocase; content:"<root>"; distance:0; nocase; base64_decode:bytes 953, offset 0, relative; base64_data; content:"<!DOCTYPE "; content:"<!ENTITY"; distance:0; pcre:"/<!ENTITY\s*(?P<entity1>[&\x3b\w]+)\s.*?<!ENTITY\s*(?P<entity2>[&\x3b\w]+)\s*[\x22\x27].*?&\s*(?P=entity1)\s*\x3b\s*&\s*(?P=entity1).*?<!ENTITY\s*[&\x3b\w]+\s*[\x22\x27].*?&\s*(?P=entity2)\s*\x3b\s*&\s*(?P=entity2)/smi"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-3860; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-082; classtype:attempted-user; sid:28161; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER overly large XML file MSXML heap overflow attempt"; flow:to_client,established; content:"var doc = new ActiveXObject('Msxml2.DOMDocument')|3B|"; fast_pattern:only; content:"while (longstr.length < 0x40000000) {"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2013-0006; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-002; classtype:attempted-user; sid:28286; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Cisco WebEx recording integer overflow attempt"; flow:to_server,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 00 00 00 00 00 02|"; fast_pattern; content:"|BB|"; within:1; distance:-15; content:"|01|"; within:1; distance:50; byte_test:4,>=,0x15555555,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,52882; reference:cve,2012-1336; reference:url,osvdb.org/show/osvdb/81105; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120404-webex; classtype:attempted-user; sid:28263; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office Image filter BMP overflow attempt"; flow:to_server,established; file_data; content:"BM"; depth:2; content:"|04|"; within:1; distance:26; byte_test:4,>,16,22,relative,little; metadata:service smtp; reference:cve,2008-3020; classtype:attempted-user; sid:28322; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office Image filter BMP overflow attempt"; flow:to_client,established; file_data; content:"BM"; depth:2; content:"|04|"; within:1; distance:26; byte_test:4,>,16,22,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2008-3020; classtype:attempted-user; sid:28321; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office Image filter BMP overflow attempt"; flow:to_server,established; file_data; content:"BM"; depth:2; content:"|01|"; within:1; distance:26; byte_test:4,>,2,22,relative,little; metadata:service smtp; reference:cve,2008-3020; classtype:attempted-user; sid:28320; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office Image filter BMP overflow attempt"; flow:to_client,established; file_data; content:"BM"; depth:2; content:"|01|"; within:1; distance:26; byte_test:4,>,2,22,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2008-3020; classtype:attempted-user; sid:28319; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office Image filter BMP overflow attempt"; flow:to_client,established; file_data; content:"BM"; depth:2; content:"|08|"; within:1; distance:26; byte_test:4,>,256,18,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2008-3020; classtype:attempted-user; sid:28318; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office Image filter BMP overflow attempt"; flow:to_server,established; file_data; content:"BM"; depth:2; content:"|08|"; within:1; distance:26; byte_test:4,>,256,18,relative,little; metadata:service smtp; reference:cve,2008-3020; classtype:attempted-user; sid:28317; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office Image filter BMP overflow attempt"; flow:to_server,established; file_data; content:"BM"; depth:2; content:"|08|"; within:1; distance:26; byte_test:4,>,256,22,relative,little; metadata:service smtp; reference:cve,2008-3020; classtype:attempted-user; sid:28316; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office Image filter BMP overflow attempt"; flow:to_client,established; file_data; content:"BM"; depth:2; content:"|08|"; within:1; distance:26; byte_test:4,>,256,22,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2008-3020; classtype:attempted-user; sid:28315; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office Image filter BMP overflow attempt"; flow:to_server,established; file_data; content:"BM"; depth:2; content:"|04|"; within:1; distance:26; byte_test:4,>,16,18,relative,little; metadata:service smtp; reference:cve,2008-3020; classtype:attempted-user; sid:28314; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office Image filter BMP overflow attempt"; flow:to_client,established; file_data; content:"BM"; depth:2; content:"|04|"; within:1; distance:26; byte_test:4,>,16,18,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2008-3020; classtype:attempted-user; sid:28313; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office Image filter BMP overflow attempt"; flow:to_server,established; file_data; content:"BM"; depth:2; content:"|01|"; within:1; distance:26; byte_test:4,>,2,18,relative,little; metadata:service smtp; reference:cve,2008-3020; classtype:attempted-user; sid:28312; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office Image filter BMP overflow attempt"; flow:to_client,established; file_data; content:"BM"; depth:2; content:"|01|"; within:1; distance:26; byte_test:4,>,2,18,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2008-3020; classtype:attempted-user; sid:28311; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Wordpad embedded BMP overflow attempt"; flow:to_client,established; flowbits:isset,file.wri; file_data; content:"|07 F0 65 08 00 00 07 07 A5 8A 88 29 45 68 51 89 93 1C B0 5D C1 F0 4B B8 FF 00 41 08 00 00 09 00 00 00 44 00 00 00|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3940; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-089; classtype:attempted-user; sid:28521; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Wordpad embedded BMP overflow attempt"; flow:to_server,established; flowbits:isset,file.wri|file.doc; file_data; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; content:"|01 00 08 00|"; within:4; distance:16; fast_pattern; byte_test:4,>,256,18,relative,little; metadata:policy security-ips drop, service smtp; reference:cve,2013-3940; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-089; classtype:attempted-user; sid:28517; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Wordpad embedded BMP overflow attempt"; flow:to_server,established; flowbits:isset,file.doc|file.wri; file_data; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; content:"|01 00 04 00|"; within:4; distance:16; fast_pattern; byte_test:4,>,16,18,relative,little; metadata:policy security-ips drop, service smtp; reference:cve,2013-3940; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-089; classtype:attempted-user; sid:28516; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Wordpad embedded BMP overflow attempt"; flow:to_server,established; flowbits:isset,file.wri|file.doc; file_data; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; content:"|01 00 01 00|"; within:4; distance:16; fast_pattern; byte_test:4,>,2,18,relative,little; metadata:policy security-ips drop, service smtp; reference:cve,2013-3940; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-089; classtype:attempted-user; sid:28515; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Wordpad embedded BMP overflow attempt"; flow:to_client,established; flowbits:isset,file.doc|file.wri; file_data; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; content:"|01 00 04 00|"; within:4; distance:16; fast_pattern; byte_test:4,>,16,18,relative,little; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3940; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-089; classtype:attempted-user; sid:28511; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Wordpad embedded BMP overflow attempt"; flow:to_client,established; flowbits:isset,file.wri|file.doc; file_data; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; content:"|01 00 01 00|"; within:4; distance:16; fast_pattern; byte_test:4,>,2,18,relative,little; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3940; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-089; classtype:attempted-user; sid:28510; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Wordpad embedded BMP overflow attempt"; flow:to_client,established; flowbits:isset,file.wri|file.doc; file_data; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; content:"|01 00 08 00|"; within:4; distance:16; fast_pattern; byte_test:4,>,256,18,relative,little; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3940; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-089; classtype:attempted-user; sid:28509; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Word WordPerfect CSTYL border element stack overflow attempt"; flow:to_server,established; flowbits:isset,file.corel; file_data; content:"|DC 01|"; byte_extract:2,0,rowLength,relative,little; content:"|03 00 00 88 00 00 00 00 00 00 00 00 03 00 00 88|"; within:rowLength; byte_test:2,>,32,0,relative,little; content:"|01 DC|"; within:rowLength; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-1324; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-091; classtype:attempted-user; sid:28503; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Word WordPerfect CSTYL border element stack overflow attempt"; flow:to_client,established; flowbits:isset,file.corel; file_data; content:"|DC 01|"; byte_extract:2,0,rowLength,relative,little; content:"|03 00 00 88 00 00 00 00 00 00 00 00 03 00 00 88|"; within:rowLength; byte_test:2,>,32,0,relative,little; content:"|01 DC|"; within:rowLength; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1324; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-091; classtype:attempted-user; sid:28502; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER WordPerfect file magic with .doc extension"; flow:to_server,established; flowbits:isset,file.doc; file_data; content:"|FF|WPC"; depth:4; metadata:service smtp; reference:cve,2013-0082; reference:cve,2013-1324; reference:cve,2013-1325; reference:url,www.magicdb.org/magic.db; classtype:misc-activity; sid:28501; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER WordPerfect file magic with .doc extension"; flow:to_client,established; flowbits:isset,file.doc; file_data; content:"|FF|WPC"; depth:4; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-0082; reference:cve,2013-1324; reference:cve,2013-1325; reference:url,www.magicdb.org/magic.db; classtype:misc-activity; sid:28500; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Word WordPerfect CSTYL border element stack overflow attempt"; flow:to_server,established; flowbits:isset,file.corel; file_data; content:"|DC 01|"; byte_extract:2,0,rowLength,relative,little; content:"|03 00 00 88 00 00 00 00 00 00 00 00 03 00 00 88|"; within:rowLength; byte_test:2,>,32,2,relative,little; content:"|01 DC|"; within:rowLength; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-1325; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-091; classtype:attempted-user; sid:28499; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Word WordPerfect CSTYL border element stack overflow attempt"; flow:to_client,established; flowbits:isset,file.corel; file_data; content:"|DC 01|"; byte_extract:2,0,rowLength,relative,little; content:"|03 00 00 88 00 00 00 00 00 00 00 00 03 00 00 88|"; within:rowLength; byte_test:2,>,32,2,relative,little; content:"|01 DC|"; within:rowLength; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1325; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-091; classtype:attempted-user; sid:28498; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime TeXML description attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; fast_pattern:only; content:"textBox "; nocase; pcre:"/text3Gtrack.*?textBox.*?[xy]\s*\x3D*[\x22\x27\s]*\x2d\d/smi"; metadata:policy security-ips drop, service smtp; reference:bugtraq,60110; reference:cve,2013-1015; reference:url,osvdb.org/show/osvdb/93615; reference:url,support.apple.com/kb/HT5770; classtype:attempted-user; sid:28537; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime TeXML description attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; fast_pattern:only; content:"textBox "; nocase; pcre:"/textBox.*?[xy]\s*\x3D[\x22\x27\s]+\d{5}/smi"; metadata:policy security-ips drop, service smtp; reference:bugtraq,60110; reference:cve,2013-1015; reference:url,osvdb.org/show/osvdb/93615; reference:url,support.apple.com/kb/HT5770; classtype:attempted-user; sid:28536; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML description attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; fast_pattern:only; content:"textBox "; nocase; pcre:"/text3Gtrack.*?textBox.*?[xy]\s*\x3D*[\x22\x27\s]*\x2d\d/smi"; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,60110; reference:cve,2013-1015; reference:url,osvdb.org/show/osvdb/93615; reference:url,support.apple.com/kb/HT5770; classtype:attempted-user; sid:28535; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML description attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; fast_pattern:only; content:"textBox "; nocase; pcre:"/textBox.*?[xy]\s*\x3D[\x22\x27\s]+\d{5}/smi"; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,60110; reference:cve,2013-1015; reference:url,osvdb.org/show/osvdb/93615; reference:url,support.apple.com/kb/HT5770; classtype:attempted-user; sid:28534; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Acrobat Reader FDF submitForm cross-site scripting attempt"; flow:to_server,established; flowbits:isset,file.fdf; file_data; content:"/JavaScript"; nocase; content:"submitForm"; distance:0; fast_pattern; nocase; content:"|3A|//"; within:15; content:"|23|FDF"; within:100; nocase; pcre:"/\x2fF(?i)\s*?\(\s*?http\x3a\x2f\x2f(?P<domain>[^\x2f]+)\x2f[^\x29]*?\x2epdf[^>]*?submitForm\s*?\(\s*?[\x22\x27]?\s*?http\x3a\x2f\x2f(?!(?P=domain))[^\x29]*?\x2efdf\x23FDF/"; metadata:policy balanced-ips alert, policy security-ips alert, service smtp; reference:bugtraq,62888; reference:cve,2013-5325; reference:url,osvdb.org/show/osvdb/98225; reference:url,www.adobe.com/support/security/bulletins/apsb13-25.html; classtype:misc-attack; sid:28576; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Acrobat Reader FDF submitForm cross-site scripting attempt"; flow:to_client,established; flowbits:isset,file.fdf; file_data; content:"/JavaScript"; nocase; content:"submitForm"; distance:0; fast_pattern; nocase; content:"|3A|//"; within:15; content:"|23|FDF"; within:100; nocase; pcre:"/\x2fF(?i)\s*?\(\s*?http\x3a\x2f\x2f(?P<domain>[^\x2f]+)\x2f[^\x29]*?\x2epdf[^>]*?submitForm\s*?\(\s*?[\x22\x27]?\s*?http\x3a\x2f\x2f(?!(?P=domain))[^\x29]*?\x2efdf\x23FDF/"; metadata:policy balanced-ips alert, policy security-ips alert, service ftp-data, service http, service imap, service pop3; reference:bugtraq,62888; reference:cve,2013-5325; reference:url,osvdb.org/show/osvdb/98225; reference:url,www.adobe.com/support/security/bulletins/apsb13-25.html; classtype:misc-attack; sid:28575; rev:1;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Corel PaintShop Pro wintab32.dll dll-load exploit attempt"; flow:to_server,established; content:"w|00|i|00|n|00|t|00|a|00|b|00|3|00|2|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:bugtraq,62836; reference:cve,2013-0733; reference:url,osvdb.org/show/osvdb/98163; classtype:attempted-user; sid:28842; rev:1;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Corel PaintShop Pro uvipl.dll dll-load exploit attempt"; flow:to_server,established; content:"u|00|v|00|i|00|p|00|l|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:bugtraq,62836; reference:cve,2013-0733; reference:url,osvdb.org/show/osvdb/98163; classtype:attempted-user; sid:28841; rev:1;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Corel PaintShop Pro uipl.dll dll-load exploit attempt"; flow:to_server,established; content:"u|00|i|00|p|00|l|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:bugtraq,62836; reference:cve,2013-0733; reference:url,osvdb.org/show/osvdb/98163; classtype:attempted-user; sid:28840; rev:1;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Corel PaintShop Pro ipl.dll dll-load exploit attempt"; flow:to_server,established; content:"i|00|p|00|l|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:bugtraq,62836; reference:cve,2013-0733; reference:url,osvdb.org/show/osvdb/98163; classtype:attempted-user; sid:28839; rev:1;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Corel PaintShop Pro d2d1.dll dll-load exploit attempt"; flow:to_server,established; content:"d|00|2|00|d|00|1|00|.|00|d|00|l|00|l|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:bugtraq,62836; reference:cve,2013-0733; reference:url,osvdb.org/show/osvdb/98163; classtype:attempted-user; sid:28837; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Corel PaintShop Pro wintab32.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|wintab32.dll"; fast_pattern:only; http_uri; metadata:service http; reference:bugtraq,62836; reference:cve,2013-0733; reference:url,osvdb.org/show/osvdb/98163; classtype:attempted-user; sid:28836; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Corel PaintShop Pro uvipl.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|uvipl.dll"; fast_pattern:only; http_uri; metadata:service http; reference:bugtraq,62836; reference:cve,2013-0733; reference:url,osvdb.org/show/osvdb/98163; classtype:attempted-user; sid:28835; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Corel PaintShop Pro uipl.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|uipl.dll"; fast_pattern:only; http_uri; metadata:service http; reference:bugtraq,62836; reference:cve,2013-0733; reference:url,osvdb.org/show/osvdb/98163; classtype:attempted-user; sid:28834; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Corel PaintShop Pro ipl.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|ipl.dll"; fast_pattern:only; http_uri; metadata:service http; reference:bugtraq,62836; reference:cve,2013-0733; reference:url,osvdb.org/show/osvdb/98163; classtype:attempted-user; sid:28833; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Corel PaintShop Pro d2d1.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|d2d1.dll"; fast_pattern:only; http_uri; metadata:service http; reference:bugtraq,62836; reference:cve,2013-0733; reference:url,osvdb.org/show/osvdb/98163; classtype:attempted-user; sid:28831; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER 7-Zip ARJ archive handling buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.arj; file_data; content:"|60 EA|"; byte_test:2,>,2600,0,relative,little; metadata:service smtp; reference:bugtraq,14925; reference:bugtraq,21208; reference:cve,2005-3051; reference:url,osvdb.org/show/osvdb/19639; classtype:attempted-user; sid:28819; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER 7-Zip ARJ archive handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.arj; file_data; content:"|60 EA|"; byte_test:2,>,2600,0,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,14925; reference:bugtraq,21208; reference:cve,2005-3051; reference:url,osvdb.org/show/osvdb/19639; classtype:attempted-user; sid:28818; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Interactive Data eSignal stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.esignal; file_data; content:"|00 00 00|"; depth:3; offset:1; byte_test:1,<,12,0; byte_test:1,>,20,13; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-3494; reference:url,osvdb.org/show/osvdb/75456; classtype:attempted-user; sid:28907; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Interactive Data eSignal stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.esignal; file_data; content:"<StyleTemplate>|0A|aaaaaaaaaaaaaaaa"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-3494; reference:url,osvdb.org/show/osvdb/75456; classtype:attempted-user; sid:28906; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Interactive Data eSignal stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.esignal; file_data; content:"<StyleTemplate>"; fast_pattern; nocase; isdataat:512,relative; content:!"</StyleTemplate>"; within:512; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-3494; reference:url,osvdb.org/show/osvdb/75456; classtype:attempted-user; sid:28905; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Interactive Data eSignal stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.esignal; file_data; content:"<Font>|0A|<FaceName>aaaaaaaaaaaaaaaa"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-3494; reference:url,osvdb.org/show/osvdb/75456; classtype:attempted-user; sid:28904; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Interactive Data eSignal stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.esignal; file_data; content:"<Font>"; fast_pattern; nocase; isdataat:512,relative; content:!"</Font>"; within:512; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-3494; reference:url,osvdb.org/show/osvdb/75456; classtype:attempted-user; sid:28903; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Interactive Data eSignal stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.esignal; file_data; content:"<Font>"; fast_pattern; nocase; isdataat:512,relative; content:!"</Font>"; within:512; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-3494; reference:url,osvdb.org/show/osvdb/75456; classtype:attempted-user; sid:28902; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER CHM LZX compression reset interval anti-virus evasion attempt"; flow:to_server,established; flowbits:isset,file.chm; content:"LZXC"; byte_test:4,<,3,0,relative,little; byte_extract:4,4,reset_interval,relative,little; byte_test:4,>,reset_interval,0,relative,little; metadata:service smtp; reference:cve,2012-1458; classtype:trojan-activity; sid:28979; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER CHM LZX compression reset interval anti-virus evasion attempt"; flow:to_client,established; flowbits:isset,file.chm; content:"LZXC"; byte_test:4,<,3,0,relative,little; byte_extract:4,4,reset_interval,relative,little; byte_test:4,>,reset_interval,0,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1458; classtype:trojan-activity; sid:28978; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER GIMP XWD file heap buffer overflow attempt"; flow:to_server,established; file_data; content:"|00 00 00 07 00 00 00 02|"; depth:12; offset:4; byte_extract:4,72,colormap_entries; byte_test:4,>,colormap_entries,76; metadata:service smtp; reference:cve,2013-1978; classtype:attempted-user; sid:29010; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GIMP XWD file heap buffer overflow attempt"; flow:to_client,established; file_data; content:"|00 00 00 07 00 00 00 02|"; depth:12; offset:4; byte_extract:4,72,colormap_entries; byte_test:4,>,colormap_entries,76; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-1978; classtype:attempted-user; sid:29009; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RealNetworks RealPlayer RMP stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.rmp; file_data; content:"version="; isdataat:1024,relative; pcre:"/version\x3D[\x22\x27][^\x22\x27]{1024}/"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,64398; reference:cve,2013-6877; reference:url,osvdb.org/show/osvdb/101356; classtype:attempted-admin; sid:29185; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RealNetworks RealPlayer RMP stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.rmp; file_data; content:"encoding="; isdataat:1024,relative; pcre:"/encoding\x3D[\x22\x27][^\x22\x27]{1024}/"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,64398; reference:cve,2013-6877; reference:url,osvdb.org/show/osvdb/101356; classtype:attempted-admin; sid:29184; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer RMP stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.rmp; file_data; content:"version="; isdataat:1024,relative; pcre:"/version\x3D[\x22\x27][^\x22\x27]{1024}/"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64398; reference:cve,2013-6877; reference:url,osvdb.org/show/osvdb/101356; classtype:attempted-admin; sid:29183; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer RMP stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.rmp; file_data; content:"encoding="; isdataat:1024,relative; pcre:"/encoding\x3D[\x22\x27][^\x22\x27]{1024}/"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64398; reference:cve,2013-6877; reference:url,osvdb.org/show/osvdb/101356; classtype:attempted-admin; sid:29182; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER IBM Forms Viewer XFDL form processing stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xfdl; file_data; content:"<fontname>"; nocase; content:!"</fontname>"; within:42; nocase; pcre:"/^[\r\n\t\s]*?[^<]{31}/iR"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2013-5447; reference:url,osvdb.org/show/osvdb/100732; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21657500; classtype:attempted-user; sid:29280; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER IBM Forms Viewer XFDL form processing stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xfdl; file_data; content:"<fontinfo>"; nocase; content:"<ae>"; within:50; nocase; content:!"</ae>"; within:36; nocase; pcre:"/^[\r\n\t\s]*?[^<]{31}/iR"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2013-5447; reference:url,osvdb.org/show/osvdb/100732; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21657500; classtype:attempted-user; sid:29279; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER IBM Forms Viewer XFDL form processing stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xfdl; file_data; content:"<fontname>"; nocase; content:!"</fontname>"; within:42; nocase; pcre:"/^[\r\n\t\s]*?[^<]{31}/iR"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5447; reference:url,osvdb.org/show/osvdb/100732; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21657500; classtype:attempted-user; sid:29278; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER IBM Forms Viewer XFDL form processing stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xfdl; file_data; content:"<fontinfo>"; nocase; content:"<ae>"; within:50; nocase; content:!"</ae>"; within:36; nocase; pcre:"/^[\r\n\t\s]*?[^<]{31}/iR"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-5447; reference:url,osvdb.org/show/osvdb/100732; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21657500; classtype:attempted-user; sid:29277; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RealNetworks RealPlayer RMP file heap buffer overflow attempt"; flow:to_server, established; flowbits:isset,file.rmp; file_data; content:"|3C|ACTION|3E|"; content:"import"; distance:0; content:"|3C 2F|ACTION|3E|"; distance:0; content:"|3C|TRACK|3E|"; content:"|3C|LOCATION|3E|"; content:"|25|fid"; distance:0; content:"|3C 2F|LOCATION|3E|"; distance:0; content:"|3C|TRACKID|3E|"; isdataat:255,relative; content:!"|3C 2F|TRACKID|3E|"; within:255; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,64398; reference:cve,2013-6877; reference:url,osvdb.org/show/osvdb/101356; classtype:attempted-admin; sid:29212; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RealNetworks RealPlayer RMP file heap buffer overflow attempt"; flow:to_server, established; flowbits:isset,file.rmp; file_data; content:"|3C|ACTION|3E|"; content:"import"; distance:0; content:"|3C 2F|ACTION|3E|"; distance:0; content:"|3C|TRACK|3E|"; content:"|3C|LOCATION|3E|"; content:"|25|f"; distance:0; content:!"id"; within:2; content:"|3C 2F|LOCATION|3E|"; distance:0; content:"|3C|FILENAME|3E|"; isdataat:255,relative; content:!"|3C 2F|FILENAME|3E|"; within:255; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,64398; reference:cve,2013-6877; reference:url,osvdb.org/show/osvdb/101356; classtype:attempted-admin; sid:29211; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RealNetworks RealPlayer RMP file heap buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.rmp; file_data; content:"|3C|ACTION|3E|"; content:"import"; distance:0; content:"|3C 2F|ACTION|3E|"; distance:0; content:"|3C|TRACK|3E|"; content:"|3C|LOCATION|3E|"; isdataat:255,relative; content:!"|3C 2F|LOCATION|3E|"; within:255; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,64398; reference:cve,2013-6877; reference:url,osvdb.org/show/osvdb/101356; classtype:attempted-admin; sid:29210; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer RMP file heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.rmp; file_data; content:"|3C|ACTION|3E|"; content:"import"; distance:0; content:"|3C 2F|ACTION|3E|"; distance:0; content:"|3C|TRACK|3E|"; content:"|3C|LOCATION|3E|"; content:"|25|fid"; distance:0; content:"|3C 2F|LOCATION|3E|"; distance:0; content:"|3C|TRACKID|3E|"; isdataat:255,relative; content:!"|3C 2F|TRACKID|3E|"; within:255; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64398; reference:cve,2013-6877; reference:url,osvdb.org/show/osvdb/101356; classtype:attempted-admin; sid:29209; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer RMP file heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.rmp; file_data; content:"|3C|ACTION|3E|"; content:"import"; distance:0; content:"|3C 2F|ACTION|3E|"; distance:0; content:"|3C|TRACK|3E|"; content:"|3C|LOCATION|3E|"; content:"|25|f"; distance:0; content:!"id"; within:2; content:"|3C 2F|LOCATION|3E|"; distance:0; content:"|3C|FILENAME|3E|"; isdataat:255,relative; content:!"|3C 2F|FILENAME|3E|"; within:255; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64398; reference:cve,2013-6877; reference:url,osvdb.org/show/osvdb/101356; classtype:attempted-admin; sid:29208; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer RMP file heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.rmp; file_data; content:"|3C|ACTION|3E|"; content:"import"; distance:0; content:"|3C 2F|ACTION|3E|"; distance:0; content:"|3C|TRACK|3E|"; content:"|3C|LOCATION|3E|"; isdataat:255,relative; content:!"|3C 2F|LOCATION|3E|"; within:255; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64398; reference:cve,2013-6877; reference:url,osvdb.org/show/osvdb/101356; classtype:attempted-admin; sid:29207; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Corel PDF fusion XPS stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xps; file_data; content:"PK|03 04|"; byte_test:2,>,2048,22,little,relative; content:!"PK|03 04|"; within:2048; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3248; reference:url,osvdb.org/show/osvdb/94933; classtype:attempted-user; sid:29468; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Corel PDF fusion XPS stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xps; file_data; content:"PK|01 02|"; byte_test:2,>,2048,24,little,relative; content:!"PK|01 02|"; within:2048; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3248; reference:url,osvdb.org/show/osvdb/94933; classtype:attempted-user; sid:29467; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Corel PDF fusion XPS stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xps; file_data; content:"PK|03 04|"; byte_test:2,>,2048,22,little,relative; content:!"PK|03 04|"; within:2048; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3248; reference:url,osvdb.org/show/osvdb/94933; classtype:attempted-user; sid:29466; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Corel PDF fusion XPS stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xps; file_data; content:"PK|01 02|"; byte_test:2,>,2048,24,little,relative; content:!"PK|01 02|"; within:2048; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3248; reference:url,osvdb.org/show/osvdb/94933; classtype:attempted-user; sid:29465; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Outside In OS2 metafile parser stack buffer overflow attempt"; flow:to_server,established; file_data; content:"|D3 A8 A8|"; depth:3; offset:2; content:"|D3 A6 BB|"; within:250; content:"|D3 EE BB|"; within:130; content:"|66|"; within:4; byte_test:1,>,0x08,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,63741; reference:cve,2013-5763; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-105; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21660964; reference:url,www.osvdb.org/show/osvdb/98894; classtype:attempted-user; sid:29577; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Outside In OS2 metafile parser stack buffer overflow attempt"; flow:to_server,established; file_data; content:"|D3 A8 A8|"; depth:3; offset:2; content:"|D3 A6 BB|"; within:250; content:"|D3 EE BB|"; within:130; content:"|65|"; distance:0; byte_test:1,>,0x08,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,63741; reference:cve,2013-5763; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-105; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21660964; reference:url,www.osvdb.org/show/osvdb/98894; classtype:attempted-user; sid:29576; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Outside In OS2 metafile parser stack buffer overflow attempt"; flow:to_server,established; file_data; content:"|D3 A8 A8|"; depth:3; offset:2; content:"|D3 A6 BB|"; within:250; content:"|D3 EE BB|"; within:130; content:"|26|"; within:4; byte_test:1,>,0x08,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,63741; reference:cve,2013-5763; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-105; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21660964; reference:url,www.osvdb.org/show/osvdb/98894; classtype:attempted-user; sid:29575; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Outside In OS2 metafile parser stack buffer overflow attempt"; flow:to_server,established; file_data; content:"|D3 A8 A8|"; depth:3; offset:2; content:"|D3 A6 BB|"; within:250; content:"|D3 EE BB|"; within:130; content:"|25|"; within:4; byte_test:1,>,0x08,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,63741; reference:cve,2013-5763; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-105; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21660964; reference:url,www.osvdb.org/show/osvdb/98894; classtype:attempted-user; sid:29574; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Outside In OS2 metafile parser stack buffer overflow attempt"; flow:to_client,established; file_data; content:"|D3 A8 A8|"; depth:3; offset:2; content:"|D3 A6 BB|"; within:250; content:"|D3 EE BB|"; within:130; content:"|66|"; within:4; byte_test:1,>,0x08,0,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,63741; reference:cve,2013-5763; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-105; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21660964; reference:url,www.osvdb.org/show/osvdb/98894; classtype:attempted-user; sid:29573; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Outside In OS2 metafile parser stack buffer overflow attempt"; flow:to_client,established; file_data; content:"|D3 A8 A8|"; depth:3; offset:2; content:"|D3 A6 BB|"; within:250; content:"|D3 EE BB|"; within:130; content:"|65|"; within:4; byte_test:1,>,0x08,0,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,63741; reference:cve,2013-5763; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-105; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21660964; reference:url,www.osvdb.org/show/osvdb/98894; classtype:attempted-user; sid:29572; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Outside In OS2 metafile parser stack buffer overflow attempt"; flow:to_client,established; file_data; content:"|D3 A8 A8|"; depth:3; offset:2; content:"|D3 A6 BB|"; within:250; content:"|D3 EE BB|"; within:130; content:"|26|"; within:4; byte_test:1,>,0x08,0,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,63741; reference:cve,2013-5763; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-105; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21660964; reference:url,www.osvdb.org/show/osvdb/98894; classtype:attempted-user; sid:29571; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Outside In OS2 metafile parser stack buffer overflow attempt"; flow:to_client,established; file_data; content:"|D3 A8 A8|"; depth:3; offset:2; content:"|D3 A6 BB|"; within:250; content:"|D3 EE BB|"; within:130; content:"|25|"; within:4; byte_test:1,>,0x08,0,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,63741; reference:cve,2013-5763; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-105; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21660964; reference:url,www.osvdb.org/show/osvdb/98894; classtype:attempted-user; sid:29570; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Interactive Data eSignal stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.esignal; file_data; content:"|02 4F 10 1C 00 66 57 48 43 30 35 44 6B 53 9D 57|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-3494; reference:url,osvdb.org/show/osvdb/75456; classtype:attempted-user; sid:29527; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Interactive Data eSignal stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.esignal; file_data; content:"|02 4F 10 1C 00 66 57 48 43 30 35 44 6B 53 9D 57|"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-3494; reference:url,osvdb.org/show/osvdb/75456; classtype:attempted-user; sid:29526; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Norton Anti-Virus decompression bomb denial of service attempt"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"|08 00 FD 86 E9 30 8B 5B|"; fast_pattern:only; content:"PK|01 02|"; content:"PK|05 06|"; within:80; metadata:service smtp; reference:url,archives.neohapsis.com/archives/fulldisclosure/2004-07/0364.html; classtype:attempted-dos; sid:29661; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Norton Anti-Virus decompression bomb denial of service attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"|08 00 FD 86 E9 30 8B 5B|"; fast_pattern:only; content:"PK|01 02|"; content:"PK|05 06|"; metadata:service ftp-data, service http, service imap, service pop3; reference:url,archives.neohapsis.com/archives/fulldisclosure/2004-07/0364.html; classtype:attempted-dos; sid:29660; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"FILE-OTHER XML exponential entity expansion attack attempt"; flow:to_server,established; content:"<!DOCTYPE "; fast_pattern:only; content:"<!ENTITY"; pcre:"/<!ENTITY\s*(?P<entity1>[&\x3b\w]+)\s.*?<!ENTITY\s*(?P<entity2>[&\x3b\w]+)\s*[\x22\x27].*?&\s*(?P=entity1)\s*\x3b\s*&\s*(?P=entity1).*?<!ENTITY\s*[&\x3b\w]+\s*[\x22\x27].*?&\s*(?P=entity2)\s*\x3b\s*&\s*(?P=entity2)/smi"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2010-2076; reference:cve,2013-1664; reference:cve,2013-1665; reference:cve,2013-1821; reference:cve,2015-0677; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20150408-asa; classtype:attempted-user; sid:29800; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Clam Anti-Virus TNEF file handling denial of service attempt"; flow:to_server,established; flowbits:isset,file.tnef; file_data; content:"|02|"; depth:1; offset:6; byte_test:4,>,0x7FFFFFFF,5,relative; content:"IPM.Microsoft Mail.Note"; fast_pattern:only; metadata:service smtp; reference:bugtraq,15316; reference:cve,2005-3500; classtype:attempted-dos; sid:29889; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Clam Anti-Virus TNEF file handling denial of service attempt"; flow:to_client,established; flowbits:isset,file.tnef; file_data; content:"|02|"; depth:1; offset:6; byte_test:4,>,0x7FFFFFFF,5,relative; content:"IPM.Microsoft Mail.Note"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,15316; reference:cve,2005-3500; classtype:attempted-dos; sid:29888; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Outside In OS/2 Metafile parser stack overflow attempt"; flow:to_server,established; flowbits:isset,file.met; file_data; content:"|D3 A6 BB|"; byte_extract:2,-3,DescDataLen,relative; content:"|D3 EE BB|"; within:DescDataLen; byte_extract:2,-3,DataLen,relative; content:"|E7|"; within:DataLen; byte_test:1,>,8,0,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,64825; reference:cve,2013-5879; classtype:attempted-user; sid:30030; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Outside In OS/2 Metafile parser stack overflow attempt"; flow:to_server,established; flowbits:isset,file.met; file_data; content:"|D3 A6 BB|"; byte_extract:2,-3,DescDataLen,relative; content:"|D3 EE BB|"; within:DescDataLen; byte_extract:2,-3,DataLen,relative; content:"|E6|"; within:DataLen; byte_test:1,>,8,0,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,64825; reference:cve,2013-5879; classtype:attempted-user; sid:30029; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Outside In OS/2 Metafile parser stack overflow attempt"; flow:to_server,established; flowbits:isset,file.met; file_data; content:"|D3 A6 BB|"; byte_extract:2,-3,DescDataLen,relative; content:"|D3 EE BB|"; within:DescDataLen; byte_extract:2,-3,DataLen,relative; content:"|A7|"; within:DataLen; byte_test:1,>,8,0,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,64825; reference:cve,2013-5879; classtype:attempted-user; sid:30028; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Outside In OS/2 Metafile parser stack overflow attempt"; flow:to_server,established; flowbits:isset,file.met; file_data; content:"|D3 A6 BB|"; byte_extract:2,-3,DescDataLen,relative; content:"|D3 EE BB|"; within:DescDataLen; byte_extract:2,-3,DataLen,relative; content:"|A6|"; within:DataLen; byte_test:1,>,8,0,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,64825; reference:cve,2013-5879; classtype:attempted-user; sid:30027; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Outside In OS/2 Metafile parser stack overflow attempt"; flow:to_server,established; flowbits:isset,file.met; file_data; content:"|D3 A6 BB|"; byte_extract:2,-3,DescDataLen,relative; content:"|D3 EE BB|"; within:DescDataLen; byte_extract:2,-3,DataLen,relative; content:"|54|"; within:DataLen; byte_test:1,>,8,0,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,64825; reference:cve,2013-5879; classtype:attempted-user; sid:30026; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Outside In OS/2 Metafile parser stack overflow attempt"; flow:to_server,established; flowbits:isset,file.met; file_data; content:"|D3 A6 BB|"; byte_extract:2,-3,DescDataLen,relative; content:"|D3 EE BB|"; within:DescDataLen; byte_extract:2,-3,DataLen,relative; content:"|14|"; within:DataLen; byte_test:1,>,8,0,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,64825; reference:cve,2013-5879; classtype:attempted-user; sid:30025; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Outside In OS/2 Metafile parser stack overflow attempt"; flow:to_client,established; flowbits:isset,file.met; file_data; content:"|D3 A6 BB|"; byte_extract:2,-3,DescDataLen,relative; content:"|D3 EE BB|"; within:DescDataLen; byte_extract:2,-3,DataLen,relative; content:"|E7|"; within:DataLen; byte_test:1,>,8,0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64825; reference:cve,2013-5879; classtype:attempted-user; sid:30024; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Outside In OS/2 Metafile parser stack overflow attempt"; flow:to_client,established; flowbits:isset,file.met; file_data; content:"|D3 A6 BB|"; byte_extract:2,-3,DescDataLen,relative; content:"|D3 EE BB|"; within:DescDataLen; byte_extract:2,-3,DataLen,relative; content:"|E6|"; within:DataLen; byte_test:1,>,8,0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64825; reference:cve,2013-5879; classtype:attempted-user; sid:30023; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Outside In OS/2 Metafile parser stack overflow attempt"; flow:to_client,established; flowbits:isset,file.met; file_data; content:"|D3 A6 BB|"; byte_extract:2,-3,DescDataLen,relative; content:"|D3 EE BB|"; within:DescDataLen; byte_extract:2,-3,DataLen,relative; content:"|A7|"; within:DataLen; byte_test:1,>,8,0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64825; reference:cve,2013-5879; classtype:attempted-user; sid:30022; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Outside In OS/2 Metafile parser stack overflow attempt"; flow:to_client,established; flowbits:isset,file.met; file_data; content:"|D3 A6 BB|"; byte_extract:2,-3,DescDataLen,relative; content:"|D3 EE BB|"; within:DescDataLen; byte_extract:2,-3,DataLen,relative; content:"|A6|"; within:DataLen; byte_test:1,>,8,0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64825; reference:cve,2013-5879; classtype:attempted-user; sid:30021; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Outside In OS/2 Metafile parser stack overflow attempt"; flow:to_client,established; flowbits:isset,file.met; file_data; content:"|D3 A6 BB|"; byte_extract:2,-3,DescDataLen,relative; content:"|D3 EE BB|"; within:DescDataLen; byte_extract:2,-3,DataLen,relative; content:"|54|"; within:DataLen; byte_test:1,>,8,0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64825; reference:cve,2013-5879; classtype:attempted-user; sid:30020; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Outside In OS/2 Metafile parser stack overflow attempt"; flow:to_client,established; flowbits:isset,file.met; file_data; content:"|D3 A6 BB|"; byte_extract:2,-3,DescDataLen,relative; content:"|D3 EE BB|"; within:DescDataLen; byte_extract:2,-3,DataLen,relative; content:"|14|"; within:DataLen; byte_test:1,>,8,0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,64825; reference:cve,2013-5879; classtype:attempted-user; sid:30019; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $FTP_PORTS (msg:"FILE-OTHER ftpchk3.php malicious script upload attempt"; flow:to_server,established; content:"STOR ftpchk3.php"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp; reference:url,www.jexanalytics.com/2012/02/wordpress-sites-all-hacked; classtype:trojan-activity; sid:30101; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 20 (msg:"FILE-OTHER ftpchk3.php malicious script upload attempt"; flow:to_client,established; content:"function detect_cms()"; content:"array('JFactory::', 'Joomla!'),"; fast_pattern:only; content:"array('wp-blog-header.php', 'Wordpress'),"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp; reference:url,www.jexanalytics.com/2012/02/wordpress-sites-all-hacked; classtype:trojan-activity; sid:30100; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER ATMFD Adobe font driver reserved command denial of service attempt"; flow:to_server,established; flowbits:isset,file.otf; file_data; content:"|19 B3 FA 00 A4 1F 8C 8C 0D 0E FC 0B FB 28 15 5E 0A 13 2C 5F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3128; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-082; classtype:denial-of-service; sid:30241; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ATMFD Adobe font driver reserved command denial of service attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|19 B3 FA 00 A4 1F 8C 8C 0D 0E FC 0B FB 28 15 5E 0A 13 2C 5F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3128; reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-082; classtype:denial-of-service; sid:30240; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Kingsoft Writer long font name buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.ole|file.doc; file_data; content:"|87 7A 00 20 00 00 00 80 08 00 00 00 00 00 00 00 FF 01 00 00 00 00 00 00|"; isdataat:80,relative; content:!"|00 00|"; within:80; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,61796; reference:cve,2013-3934; classtype:attempted-user; sid:30534; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Kingsoft Writer long font name buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.ole|file.doc; file_data; content:"|87 7A 00 20 00 00 00 80 08 00 00 00 00 00 00 00 FF 01 00 00 00 00 00 00|"; isdataat:512,relative; content:!"|00 00|"; within:512; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,61796; reference:cve,2013-3934; classtype:attempted-user; sid:30533; rev:5;)
# alert tcp $EXTERNAL_NET [139,445,80] -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Briefcase integer underflow"; flow:to_client,established; content:"DDSH|02 05 01 14|"; fast_pattern; content:"C:|5C 00 00|"; within:500; distance:20; byte_test:4,<,4,4,relative,little; metadata:policy security-ips drop; reference:cve,2012-1527; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-072; classtype:attempted-user; sid:30898; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RARLAB WinRAR ZIP format filename spoof attempt"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"|50 4B 03 04|"; depth:4; content:"|00 00|"; within:2; distance:24; content:".exe"; within:64; flowbits:set,file.zip.winrar.spoof; flowbits:noalert; metadata:service smtp; reference:bugtraq,66383; reference:url,an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html; classtype:attempted-user; sid:30909; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RARLAB WinRAR ZIP format filename spoof attempt"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"|50 4B 03 04 0A 00 00 00 00 00 96 5E 81 44|"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:bugtraq,66383; reference:url,an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html; classtype:attempted-user; sid:30908; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RARLAB WinRAR ZIP format filename spoof attempt"; flow:to_server,established; flowbits:isset,file.zip.winrar.spoof; file_data; content:"|50 4B 01 02|"; content:!".exe"; within:64; distance:42; content:"|50 4B 05 06|"; distance:0; content:"|01 00|"; within:2; distance:6; metadata:service smtp; reference:bugtraq,66383; reference:url,an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html; classtype:attempted-user; sid:30907; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RARLAB WinRAR ZIP format filename spoof attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"|50 4B 03 04|"; depth:4; content:"|00 00|"; within:2; distance:24; content:".exe"; within:64; flowbits:set,file.zip.winrar.spoof; flowbits:noalert; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,66383; reference:url,an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html; classtype:attempted-user; sid:30906; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RARLAB WinRAR ZIP format filename spoof attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"|50 4B 03 04 0A 00 00 00 00 00 96 5E 81 44|"; fast_pattern:only; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,66383; reference:url,an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html; classtype:attempted-user; sid:30905; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RARLAB WinRAR ZIP format filename spoof attempt"; flow:to_client,established; flowbits:isset,file.zip.winrar.spoof; file_data; content:"|50 4B 01 02|"; content:!".exe"; within:64; distance:42; content:"|50 4B 05 06|"; distance:0; content:"|01 00|"; within:2; distance:6; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,66383; reference:url,an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html; classtype:attempted-user; sid:30904; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Acrobat EMF conversion heap buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|5F 00 00 00|"; byte_test:4,>,0xFFFF,24,relative,little; metadata:policy security-ips drop, service smtp; reference:bugtraq,67632; reference:cve,2014-0529; reference:url,helpx.adobe.com/security/products/reader/apsb14-15.html; classtype:attempted-user; sid:31030; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Acrobat EMF conversion heap buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|26 00 00 00|"; byte_test:4,>,0xFFFF,8,relative,little; metadata:policy security-ips drop, service smtp; reference:bugtraq,67632; reference:cve,2014-0529; reference:url,helpx.adobe.com/security/products/reader/apsb14-15.html; classtype:attempted-user; sid:31029; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Acrobat EMF conversion heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|5F 00 00 00|"; byte_test:4,>,0xFFFF,24,relative,little; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,67632; reference:cve,2014-0529; reference:url,helpx.adobe.com/security/products/reader/apsb14-15.html; classtype:attempted-user; sid:31028; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Acrobat EMF conversion heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|26 00 00 00|"; byte_test:4,>,0xFFFF,8,relative,little; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,67632; reference:cve,2014-0529; reference:url,helpx.adobe.com/security/products/reader/apsb14-15.html; classtype:attempted-user; sid:31027; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER invalid ELF padding field value attempt"; flow:to_server,established; file_data; content:"|7F|ELF"; depth:4; content:!"|00|"; within:1; distance:11; metadata:service smtp; reference:cve,2012-1439; classtype:trojan-activity; sid:30993; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER invalid ELF padding field value attempt"; flow:to_client,established; file_data; content:"|7F|ELF"; depth:4; content:!"|00|"; within:1; distance:11; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2012-1439; classtype:trojan-activity; sid:30992; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Sophos RAR virtual machine filters memory corruption attempt"; flow:to_server,established; file_data; content:"|69 60 00 80 00 01 A6 60 32 B8 A0 33 48 32 B9 34 C9 B7 49 62 81 5E 93 70 09 80 02 B4 D5 00 E4 C5|"; fast_pattern:only; metadata:service smtp; reference:url,www.sophos.com/en-us/support/knowledgebase/118424.aspx; classtype:attempted-user; sid:31088; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Sophos RAR virtual machine filters memory corruption attempt"; flow:to_client,established; file_data; content:"|69 60 00 80 00 01 A6 60 32 B8 A0 33 48 32 B9 34 C9 B7 49 62 81 5E 93 70 09 80 02 B4 D5 00 E4 C5|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:url,www.sophos.com/en-us/support/knowledgebase/118424.aspx; classtype:attempted-user; sid:31087; rev:1;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Autodesk AutoCAD insecure acad.fas file load attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"a|00|c|00|a|00|d|00|.|00|f|00|a|00|s|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:bugtraq,65745; reference:cve,2014-0818; classtype:attempted-user; sid:31086; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Autodesk AutoCAD insecure acad.fas file load attempt"; flow:to_server,established; content:"GET"; http_method; content:"|2F|acad.fas"; nocase; http_uri; metadata:service http; reference:bugtraq,65745; reference:cve,2014-0818; classtype:attempted-user; sid:31085; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple OSX Finder DMG volume name memory corruption attempt"; flow:to_server,established; flowbits:isset,file.dmg; file_data; content:"|00 00 00 00 00 00 00 00|LABL"; byte_test:2,>,254,12,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2007-0197; classtype:attempted-user; sid:31325; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple OSX Finder DMG volume name memory corruption attempt"; flow:to_server,established; flowbits:isset,file.dmg; file_data; content:"|01 3C 50 72 6F 6F 66 5F 6F 66 5F 43 6F 6E 63 65 70 74 5F 41 73 73 75 72|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2007-0197; classtype:attempted-user; sid:31324; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple OSX Finder DMG volume name memory corruption attempt"; flow:to_client,established; flowbits:isset,file.dmg; file_data; content:"|01 3C 50 72 6F 6F 66 5F 6F 66 5F 43 6F 6E 63 65 70 74 5F 41 73 73 75 72|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2007-0197; classtype:attempted-user; sid:31323; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows C Run-Time Library remote code execution attempt"; flow:to_server,established; flowbits:isset,file.asx; file_data; content:"<ASX"; fast_pattern; nocase; content:"VERSION"; within:50; nocase; pcre:"/<ASX[^>]*?VERSION\s*=\s*[0-9\x22\x27][0-9\x2e]{20}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-0150; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-013; classtype:attempted-user; sid:31427; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Symantec Endpoint Protection Sysplant kernel pool overflow exploit attempt"; flow:to_server,established; file_data; content:"sysfer.dll"; fast_pattern:only; content:"sysplant"; nocase; content:"222084"; content:"DeviceIoControl"; nocase; content:"IoCompletionReserve"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,68946; reference:cve,2014-3434; classtype:attempted-user; sid:31671; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Symantec Endpoint Protection Sysplant kernel pool overflow exploit attempt"; flow:to_client,established; file_data; content:"sysfer.dll"; fast_pattern:only; content:"sysplant"; nocase; content:"222084"; content:"DeviceIoControl"; nocase; content:"IoCompletionReserve"; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,68946; reference:cve,2014-3434; classtype:attempted-user; sid:31670; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Free Download Manager .torrent parsing path overflow attempt"; flow:to_server,established; flowbits:isset,file.torrent; file_data; content:"4:pathl"; nocase; byte_test:6,>,10000,0,relative,dec,string; metadata:service smtp; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:31780; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Free Download Manager .torrent parsing name overflow attempt"; flow:to_server,established; flowbits:isset,file.torrent; file_data; content:"4:name"; nocase; byte_test:6,>,10000,0,relative,dec,string; metadata:service smtp; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:31779; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Free Download Manager .torrent parsing comment overflow attempt"; flow:to_server,established; flowbits:isset,file.torrent; file_data; content:"7:comment"; nocase; byte_test:6,>,100000,0,relative,dec,string; metadata:service smtp; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:31778; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Free Download Manager .torrent parsing announce overflow attempt"; flow:to_server,established; flowbits:isset,file.torrent; file_data; content:"8:announce"; nocase; byte_test:6,>,100000,0,relative,dec,string; metadata:service smtp; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:31777; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Mozilla products clipPath element stroke-width buffer overflow attempt"; flow:to_server,established; file_data; content:"clipPath"; content:"stroke-width=|22|"; byte_test:10,>,0xFFFF,0,relative,string; metadata:service smtp; reference:cve,2007-0776; classtype:attempted-user; sid:31822; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Mozilla products clipPath element stroke-width buffer overflow attempt"; flow:to_client,established; file_data; content:"clipPath"; content:"stroke-width=|22|"; byte_test:10,>,0xFFFF,0,relative,string; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2007-0776; classtype:attempted-user; sid:31821; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Wireshark MPEG dissector stack buffer overflow attempt"; flow:to_server,established; file_data; content:"|2A 3C 86 61 7C 02 D9 62 69 09 97 61 F6 8C 98 61 2A 0A 9C 61 98 1E 84 61 1A D1 91 61 01 02 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,66066; reference:cve,2014-2299; reference:url,osvdb.org/show/osvdb/104199; classtype:attempted-user; sid:31987; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Wireshark MPEG dissector stack buffer overflow attempt"; flow:to_client,established; file_data; content:"|2A 3C 86 61 7C 02 D9 62 69 09 97 61 F6 8C 98 61 2A 0A 9C 61 98 1E 84 61 1A D1 91 61 01 02 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,66066; reference:cve,2014-2299; reference:url,osvdb.org/show/osvdb/104199; classtype:attempted-user; sid:31986; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER GNU tar PAX extended headers handling overflow attempt"; flow:to_server,established; file_data; content:"GNU.sparse.numblocks=0|0A|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,16764; reference:cve,2006-0300; classtype:attempted-dos; sid:32089; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER GNU tar PAX extended headers handling overflow attempt"; flow:to_server,established; file_data; content:"GNU.sparse.numblocks="; byte_test:5,>,65535,0,relative,string,dec; metadata:service smtp; reference:bugtraq,16764; reference:cve,2006-0300; classtype:attempted-dos; sid:32088; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GNU tar PAX extended headers handling overflow attempt"; flow:to_client,established; file_data; content:"GNU.sparse.numblocks="; byte_test:5,>,65535,0,relative,string,dec; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,16764; reference:cve,2006-0300; classtype:attempted-dos; sid:32087; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Flash Player integer overflow out-of-bounds read attempt"; flow:to_server,established; content:"|D6 46 3E 23 96 E5 C8 6F 1C D7 D2 97 45 CE 83 7D 78 1E C3 BA 5E 6D 9B 96 3E 76 E0 77 64 2F A4 7A 25 59 0A A6 B1 6B 20 6A 11 FB 94 B6 97 AF 8A 7D|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,69695; reference:cve,2014-0547; classtype:attempted-user; sid:32100; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Flash Player integer overflow out-of-bounds read attempt"; flow:to_client,established; content:"|D6 46 3E 23 96 E5 C8 6F 1C D7 D2 97 45 CE 83 7D 78 1E C3 BA 5E 6D 9B 96 3E 76 E0 77 64 2F A4 7A 25 59 0A A6 B1 6B 20 6A 11 FB 94 B6 97 AF 8A 7D|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,69695; reference:cve,2014-0547; classtype:attempted-user; sid:32099; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER GNU gzip LZH decompression make_table overflow attempt"; flow:to_server,established; file_data; content:"|1F A0 AB CD FF FF FF FF FF FF FF FF FF FF FF FF|"; depth:16; metadata:service smtp; reference:cve,2006-4335; reference:url,secunia.com/advisories/21996/; classtype:attempted-user; sid:32136; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Internet Explorer SVG heap corruption attempt"; flow:to_server,established; flowbits:isset,file.svg; file_data; content:"execCommand"; content:"SelectAll"; within:11; content:"execCommand"; distance:0; content:"Copy"; within:6; content:"execCommand"; distance:0; content:"Paste"; within:7; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4138; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32167; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Internet Explorer SVG heap corruption attempt"; flow:to_client,established; flowbits:isset,file.svg; file_data; content:"execCommand"; content:"SelectAll"; within:11; content:"execCommand"; distance:0; content:"Copy"; within:6; content:"execCommand"; distance:0; content:"Paste"; within:7; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4138; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056; classtype:attempted-user; sid:32166; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft System.Uri heap corruption attempt"; flow:to_server,established; content:"|00 26 00 69 00 65 00 3D 00 55 00 54 00 46 00 2D 00 38 00|"; fast_pattern:only; content:"|00 26 00 71 00 3D 00 25 00 46 00 34 00 25 00 38 00 30 00 25 00 38 00 30|"; content:".NETFramework,Version=v4."; pcre:"/\x00&\x00q\x00=(\x00%\x00F\x004\x00%\x008\x000\x00%\x008\x000\x00%\x00[89AB]\x00[0-9A-F]){2}/"; metadata:service smtp; reference:cve,2014-4121; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-057; classtype:attempted-user; sid:32152; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft System.Uri heap corruption attempt"; flow:to_client,established; content:"|00 26 00 69 00 65 00 3D 00 55 00 54 00 46 00 2D 00 38 00|"; fast_pattern:only; content:"|00 26 00 71 00 3D 00 25 00 46 00 34 00 25 00 38 00 30 00 25 00 38 00 30|"; content:".NETFramework,Version=v4."; pcre:"/\x00&\x00q\x00=(\x00%\x00F\x004\x00%\x008\x000\x00%\x008\x000\x00%\x00[89AB]\x00[0-9A-F]){2}/"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-4121; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-057; classtype:attempted-user; sid:32151; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft System.Uri heap corruption attempt"; flow:to_server,established; content:"|00 26 00 69 00 65 00 3D 00 55 00 54 00 46 00 2D 00 38 00|"; fast_pattern:only; content:"|00 26 00 71 00 3D 00|"; content:".NETFramework,Version=v4."; pcre:"/\x00&\x00q\x00\=(\x00%\x00E\x00D\x00%\x00A\x00[0-9A-D]\x00%\x00[89AB]\x00[0-9A-F]){2}/i"; metadata:service smtp; reference:cve,2014-4121; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-057; classtype:attempted-user; sid:32150; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft System.Uri heap corruption attempt"; flow:to_client,established; content:"|00 26 00 69 00 65 00 3D 00 55 00 54 00 46 00 2D 00 38 00|"; fast_pattern:only; content:"|00 26 00 71 00 3D 00|"; content:".NETFramework,Version=v4."; pcre:"/\x00&\x00q\x00\=(\x00%\x00E\x00D\x00%\x00A\x00[0-9A-D]\x00%\x00[89AB]\x00[0-9A-F]){2}/i"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-4121; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-057; classtype:attempted-user; sid:32149; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"ppt/embeddings/"; content:"ppt/embeddings/"; distance:0; content:"|75 FD 41 63 B2 CF 01 E3 02 89 60 63 B2 CF 01 E3|"; within:50; content:"ppt/embeddings/"; distance:0; content:"|75 FD 41 63 B2 CF 01 E3 02 89 60 63 B2 CF 01 E3|"; within:50; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4114; reference:cve,2014-6352; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060; classtype:attempted-admin; sid:32187; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"ppt/embeddings/"; content:"ppt/embeddings/"; distance:0; content:"|75 FD 41 63 B2 CF 01 E3 02 89 60 63 B2 CF 01 E3|"; within:50; content:"ppt/embeddings/"; distance:0; content:"|75 FD 41 63 B2 CF 01 E3 02 89 60 63 B2 CF 01 E3|"; within:50; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4114; reference:cve,2014-6352; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060; classtype:attempted-admin; sid:32186; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER GE Cimplicity CimView load remote file attempt"; flow:to_server,established; flowbits:isset,file.ole; file_data; content:"|53 00 63 00 72 00 65 00 65 00 6E 00 4F 00 70 00 65 00 6E 00 44 00 69 00 73 00 70 00 61 00 74 00 63 00 68 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:url,www.virustotal.com/en/file/71264a32c22e2778a1942bb8c7b0ee08a73ffdfab6b7cc890bc4598c1ee9bdf5/analysis/; classtype:attempted-admin; sid:32258; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER GE Cimplicity CimView load remote file attempt"; flow:to_server,established; flowbits:isset,file.ole; file_data; content:"|22 00 25 00 43 00 49 00 4D 00 50 00 41 00 54 00 48 00 25 00 5C 00 43 00 69 00 6D 00 43 00 4D 00 53 00 61 00 66 00 65 00 67 00 73 00 2E 00 65 00 78 00 65 00 22|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:url,www.virustotal.com/en/file/71264a32c22e2778a1942bb8c7b0ee08a73ffdfab6b7cc890bc4598c1ee9bdf5/analysis/; classtype:attempted-admin; sid:32257; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GE Cimplicity bcl file loading external file attempt"; flow:to_client,established; flowbits:isset,file.bcl; file_data; content:"|22|cmd /C start "; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/en/file/c97edaa725602f9f349d0dac8b50f45cdec687eb15606f82d1fcdce193cfe02f/analysis/; classtype:attempted-admin; sid:32256; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GE Cimplicity CimView load remote file attempt"; flow:to_client,established; flowbits:isset,file.ole; file_data; content:"|53 00 63 00 72 00 65 00 65 00 6E 00 4F 00 70 00 65 00 6E 00 44 00 69 00 73 00 70 00 61 00 74 00 63 00 68 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/en/file/71264a32c22e2778a1942bb8c7b0ee08a73ffdfab6b7cc890bc4598c1ee9bdf5/analysis/; classtype:attempted-admin; sid:32255; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GE Cimplicity CimView load remote file attempt"; flow:to_client,established; flowbits:isset,file.ole; file_data; content:"|22 00 25 00 43 00 49 00 4D 00 50 00 41 00 54 00 48 00 25 00 5C 00 43 00 69 00 6D 00 43 00 4D 00 53 00 61 00 66 00 65 00 67 00 73 00 2E 00 65 00 78 00 65 00 22|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/en/file/71264a32c22e2778a1942bb8c7b0ee08a73ffdfab6b7cc890bc4598c1ee9bdf5/analysis/; classtype:attempted-admin; sid:32254; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"; flow:to_server,established; file_data; content:"ppt/embeddings/"; content:"PK|01 02|"; distance:0; content:"ppt/embeddings/"; distance:0; content:".bin"; within:40; content:"PK|01 02|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4114; reference:cve,2014-6352; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060; classtype:attempted-admin; sid:32316; rev:1;)
alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"; flow:to_client,established; content:"PK|03 04|"; content:"ppt/slides/_rels/"; distance:0; content:"|DF 05 BF 43 B8 77 93 B6 13 11 59 BA 97 21 0C 06|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2014-4114; reference:cve,2014-6352; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060; classtype:attempted-admin; sid:32315; rev:1;)
alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"; flow:to_client,established; content:"PK|03 04|"; content:"_rels/.rels"; distance:0; content:"|6F 64 FA C9 80 66 C2 14 5B A3 20 6D CD 15 88 F6|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2014-4114; reference:cve,2014-6352; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060; classtype:attempted-admin; sid:32314; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"ppt/embeddings/"; content:"ppt/embeddings/"; distance:0; content:".bin"; distance:0; content:"MZ"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4114; reference:cve,2014-6352; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060; classtype:attempted-admin; sid:32313; rev:1;)
# alert tcp $EXTERNAL_NET [139,445,80] -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Briefcase integer overflow"; flow:to_client,established; content:"DDSH|02 05 01 14|"; fast_pattern; content:"C:|5C 00 00|"; within:500; distance:20; byte_test:4,>,0x2000000,4,relative,little; metadata:policy security-ips drop; reference:cve,2012-1528; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-072; classtype:attempted-user; sid:32361; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Internet Explorer registry symbolic link attack attempt"; flow:to_server,established; file_data; content:"n|00|e|00|t|00| |00|E|00|x|00|p|00|l|00|o|00|r|00|e|00|r|00 5C 00|L|00|o|00|w|00| |00|R|00|i|00|g|00|h|00|t|00|s|00 00 00|Open Class"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6322; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-071; classtype:attempted-user; sid:32519; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Internet Explorer registry symbolic link attack attempt"; flow:to_client,established; file_data; content:"n|00|e|00|t|00| |00|E|00|x|00|p|00|l|00|o|00|r|00|e|00|r|00 5C 00|L|00|o|00|w|00| |00|R|00|i|00|g|00|h|00|t|00|s|00 00 00|Open Class"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6322; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-071; classtype:attempted-user; sid:32518; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Java SE GSUB FeatureCount Buffer Overflow attempt"; flow:to_server, established; file_data; content:"|01 74 61 6D 6C 00 08 00 04 00 00 00 00 FF FF 82 66 00 00 00 01 00 02 00 04 00 03 00 05 00 06 61|"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service smtp; reference:url,www.oracle.com/technetwork/topics/security/javacpuapr2013-1928497.html; classtype:attempted-user; sid:32509; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java SE GSUB FeatureCount Buffer Overflow attempt"; flow:to_client, established; file_data; flowbits:isset,file.ttf; content:"|01 74 61 6D 6C 00 08 00 04 00 00 00 00 FF FF 82 66 00 00 00 01 00 02 00 04 00 03 00 05 00 06 61|"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.oracle.com/technetwork/topics/security/javacpuapr2013-1928497.html; classtype:attempted-user; sid:32508; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft XML invalid priority in xsl template"; flow:to_server,established; file_data; content:"xsl|3A|template"; content:"priority"; within:100; pcre:"/xsl\x3Atemplate[^\x3E]*priority\s*\x3D[\s\x22\x27]*[\d\x2D]*[^\s\x22\x27\d\x2d]/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-4118; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-067; classtype:attempted-user; sid:32502; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft XML invalid priority in xsl template"; flow:to_client,established; file_data; content:"xsl|3A|template"; content:"priority"; within:100; pcre:"/xsl\x3Atemplate[^\x3E]*priority\s*\x3D[\s\x22\x27]*[\d\x2D]*[^\s\x22\x27\d\x2d]/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-4118; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-067; classtype:attempted-user; sid:32501; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Internet Explorer EPM sandbox escape attempt"; flow:to_server,established; file_data; content:"|F8 70 F6 53 00 00 00 00 0C 00 00 00 14 00 00 00 E0 8A 01 00 E0 7C 01 00 00 20 00 80 01 00 00 00 22 05 93 19 04 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-6350; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:32500; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Internet Explorer EPM sandbox escape attempt"; flow:to_client,established; file_data; content:"|F8 70 F6 53 00 00 00 00 0C 00 00 00 14 00 00 00 E0 8A 01 00 E0 7C 01 00 00 20 00 80 01 00 00 00 22 05 93 19 04 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-6350; reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065; classtype:attempted-user; sid:32499; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java awt_setPixels out-of-bounds read attempt"; flow:to_client, established; file_data; content:"|CA FE BA BE|"; fast_pattern; content:"|19 05 19 08 B6 00 10|"; within:7; distance:1103; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.oracle.com/technetwork/topics/security/cpuapr2014-1972952.html#AppendixJAVA; classtype:attempted-user; sid:32562; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER MostGear EasyLanFolderShare serial key overflow attempt"; flow:to_server,established; flowbits:isset,file.reg; file_data; content:"|5B|HKEY_LOCAL_MACHINE|5C|SOFTWARE|5C|MostGear|5C|EasyLanFolderShare_V1|5C|License|5D|"; fast_pattern:only; content:"|22|Serial|22|=|22|"; isdataat:550,relative; content:!"|22|"; within:550; metadata:service smtp; reference:cve,2013-6079; reference:url,osvdb.org/show/osvdb/94390; classtype:attempted-user; sid:32620; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER MostGear EasyLanFolderShare serial key overflow attempt"; flow:to_client,established; flowbits:isset,file.reg; file_data; content:"|5B|HKEY_LOCAL_MACHINE|5C|SOFTWARE|5C|MostGear|5C|EasyLanFolderShare_V1|5C|License|5D|"; fast_pattern:only; content:"|22|Serial|22|=|22|"; isdataat:550,relative; content:!"|22|"; within:550; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-6079; reference:url,osvdb.org/show/osvdb/94390; classtype:attempted-user; sid:32619; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER fCreateShellLink function use - potential attack"; flow:to_server, established; file_data; content:"fCreateShellLink|28|"; fast_pattern:only; metadata:impact_flag red, service smtp; reference:cve,2008-2959; classtype:misc-activity; sid:32636; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER yaml_parser_scan_uri_escapes heap buffer overflow attempt"; flow:to_client,established; content:"--- !"; fast_pattern:only; content:"%"; content:"%"; within:1; distance:2; content:"%"; within:1; distance:2; content:"%"; within:1; distance:2; pcre:"/:(%[A-Z0-9][A-Z0-9]){16}/i"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-2525; classtype:attempted-user; sid:32671; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows XP .theme file remote code execution attempt"; flow:to_server,established; file_data; content:"[Theme]"; content:"SCRNSAVE.EXE=|5C 5C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0010; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-071; classtype:attempted-admin; sid:32730; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Adobe Reader MoveFileEx arbitrary file write attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|43 94 24 98 00 00 00 83 BC 24 94 00 00 00 08 52 0F 43 8C 24 84 00 00 00 51 68 70 15 00 10 FF D0|"; fast_pattern:only; metadata:service smtp; reference:cve,2014-9150; reference:url,helpx.adobe.com/security/products/reader/apsb14-28.html; classtype:misc-attack; sid:32884; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Reader MoveFileEx arbitrary file write attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|43 94 24 98 00 00 00 83 BC 24 94 00 00 00 08 52 0F 43 8C 24 84 00 00 00 51 68 70 15 00 10 FF D0|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2014-9150; reference:url,helpx.adobe.com/security/products/reader/apsb14-28.html; classtype:misc-attack; sid:32883; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft SYmbolic LinK stack overflow attempt"; flow:to_server,established; file_data; content:"ID|3B|"; depth:3; content:"|0D 0A|P|3B|"; content:!"|0D 0A|"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,48161; reference:cve,2011-1276; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-045; classtype:attempted-user; sid:32943; rev:1;)
# alert tcp $EXTERNAL_NET $ORACLE_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Database Server XML stack buffer overflow attempt"; flow:to_server, established; content:"|00 00|"; depth:2; offset:2; content:"|00 00|"; within:2; distance:2; content:"xmltype"; content:"<"; within:5; isdataat:256,relative; content:!">"; within:256; metadata:policy security-ips drop; reference:cve,2013-3751; reference:url,www.oracle.com/technetwork/topics/security/cpujul2014-1972956.html; classtype:attempted-user; sid:32904; rev:2;)
# alert tcp $EXTERNAL_NET $ORACLE_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Database Server XML stack buffer overflow attempt"; flow:to_server, established; content:"select xml"; fast_pattern:only; content:"|00 00|"; depth:2; offset:2; content:"|00 00|"; within:2; distance:2; pcre:"/xml(element|forest|concat|agg|pi|comment|root|serialize|parse|type)\s*\x28\s*\w+\s*\x27<[^>]{256}/smi"; metadata:policy security-ips drop; reference:cve,2013-3751; reference:url,www.oracle.com/technetwork/topics/security/cpujul2014-1972956.html; classtype:attempted-user; sid:32903; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Advantech ADAMView GeniDAQ display designer stack buffer overflow attempt"; flow:to_server,established; file_data; content:"AGNI"; depth:4; content:"ETSKPWPL"; byte_test:2,>,0x38,55,relative,little; metadata:policy security-ips drop, service smtp; reference:bugtraq,71191; reference:cve,2014-8386; reference:url,osvdb.org/show/osvdb/114843; classtype:attempted-admin; sid:32902; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Advantech ADAMView GeniDAQ display designer stack buffer overflow attempt"; flow:to_client,established; file_data; content:"AGNI"; depth:4; content:"ETSKPWPL"; byte_test:2,>,0x38,55,relative,little; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,71191; reference:cve,2014-8386; reference:url,osvdb.org/show/osvdb/114843; classtype:attempted-admin; sid:32901; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime invalid atom length buffer overflow attempt"; flow:to_server,established; file_data; content:"moov"; content:"rmra"; distance:0; content:"rdrf"; distance:0; content:"alis"; distance:0; content:"|00 0F|"; byte_test:2,>,0x1FE,2,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,60097; reference:cve,2013-1017; reference:url,support.apple.com/kb/HT5770; classtype:attempted-admin; sid:33023; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime invalid atom length buffer overflow attempt"; flow:to_client,established; file_data; content:"moov"; content:"rmra"; distance:0; content:"rdrf"; distance:0; content:"alis"; distance:0; content:"|00 0F|"; byte_test:2,>,0x1FE,2,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,60097; reference:cve,2013-1017; reference:url,support.apple.com/kb/HT5770; classtype:attempted-admin; sid:33022; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Poster Software Publish-It buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pui; file_data; content:"|78 6A 48 65 4E 41 75 5A 52 4A 49 67 64 58 4A 35|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,65366; reference:cve,2014-0980; reference:url,osvdb.org/show/osvdb/102911; classtype:attempted-user; sid:33040; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Poster Software Publish-It buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pui; file_data; content:"|04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,65366; reference:cve,2014-0980; reference:url,osvdb.org/show/osvdb/102911; classtype:attempted-user; sid:33039; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Poster Software Publish-It buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pui; file_data; content:"styl"; content:"ntltJKKkGLNfWl3f"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,65366; reference:cve,2014-0980; reference:url,osvdb.org/show/osvdb/102911; classtype:attempted-user; sid:33038; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Poster Software Publish-It buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pui; file_data; content:"styl"; content:"|64 78 5A 64 70 43 48 61 6E 37 75 46 76 7A 58 62|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,65366; reference:cve,2014-0980; reference:url,osvdb.org/show/osvdb/102911; classtype:attempted-user; sid:33037; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Poster Software Publish-It buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pui; file_data; content:"styl"; content:"|42 53 73 59 75 72 46 56 50 33 67 64 69 4F 6D 4E|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,65366; reference:cve,2014-0980; reference:url,osvdb.org/show/osvdb/102911; classtype:attempted-user; sid:33036; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Poster Software Publish-It buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pui; file_data; content:"styl"; content:"DefaultAAAAAAAAAA"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,65366; reference:cve,2014-0980; reference:url,osvdb.org/show/osvdb/102911; classtype:attempted-user; sid:33035; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Poster Software Publish-It buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pui; file_data; content:"|78 6A 48 65 4E 41 75 5A 52 4A 49 67 64 58 4A 35|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,65366; reference:cve,2014-0980; reference:url,osvdb.org/show/osvdb/102911; classtype:attempted-user; sid:33034; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Poster Software Publish-It buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pui; file_data; content:"|04 04 04 04 04 04 04 04 04 04 04 04 04 04 04 04|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,65366; reference:cve,2014-0980; reference:url,osvdb.org/show/osvdb/102911; classtype:attempted-user; sid:33033; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Poster Software Publish-It buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pui; file_data; content:"styl"; content:"|6E 74 6C 74 4A 4B 4B 6B 47 4C 4E 66 57 6C 33 66|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,65366; reference:cve,2014-0980; reference:url,osvdb.org/show/osvdb/102911; classtype:attempted-user; sid:33032; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Poster Software Publish-It buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pui; file_data; content:"styl"; content:"|64 78 5A 64 70 43 48 61 6E 37 75 46 76 7A 58 62|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,65366; reference:cve,2014-0980; reference:url,osvdb.org/show/osvdb/102911; classtype:attempted-user; sid:33031; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Poster Software Publish-It buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pui; file_data; content:"styl"; content:"|42 53 73 59 75 72 46 56 50 33 67 64 69 4F 6D 4E|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,65366; reference:cve,2014-0980; reference:url,osvdb.org/show/osvdb/102911; classtype:attempted-user; sid:33030; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Poster Software Publish-It buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pui; file_data; content:"styl"; content:"DefaultAAAAAAAAAA"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,65366; reference:cve,2014-0980; reference:url,osvdb.org/show/osvdb/102911; classtype:attempted-user; sid:33029; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER BulletProof FTP Client BPS file buffer overflow attempt"; flow:established,to_server; file_data; content:"This is a BulletProof FTP Client Session-File"; depth:45; content:"|98 6A C8 74|"; depth:4; offset:177; content:"w00t"; within:4; distance:18; metadata:policy security-ips drop, service smtp; reference:cve,2014-2973; reference:url,www.rapid7.com/db/modules/exploit/windows/fileformat/bpftp_client_bps_bof; classtype:attempted-user; sid:33063; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER BulletProof FTP Client BPS file buffer overflow attempt"; flow:established,to_client; file_data; content:"This is a BulletProof FTP Client Session-File"; depth:45; content:"|98 6A C8 74|"; depth:4; offset:177; content:"w00t"; within:4; distance:18; metadata:policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-2973; reference:url,www.rapid7.com/db/modules/exploit/windows/fileformat/bpftp_client_bps_bof; classtype:attempted-user; sid:33062; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER libxml2 entity reference name heap buffer overflow attempt"; flow:to_server,established; file_data; content:"|3C|!ENTITY "; content:"|22 26|"; within:150; content:!"|22|"; within:700; pcre:"/\x3C\x21ENTITY\s+.*\s+\x22\x26[^\x22]{700}/sm"; metadata:service smtp; reference:cve,2011-3919; classtype:attempted-user; sid:33310; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER libxml2 entity reference name heap buffer overflow attempt"; flow:to_client,established; file_data; content:"|3C|!ENTITY "; content:"|22 26|"; within:150; content:!"|22|"; within:700; pcre:"/\x3C\x21ENTITY\s+.*\s+\x22\x26[^\x22]{700}/sm"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2011-3919; classtype:attempted-user; sid:33309; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Visio packed object parsing memory corruption attempt"; flow:to_server,established; file_data; content:"fff|00|MMM|00|333|00 1A 1A 1A 00 99 CC FF 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 04 00 18 00 FF FF 00 D2 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2007-0936; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-030; classtype:attempted-user; sid:33308; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Visio packed object parsing memory corruption attempt"; flow:to_client,established; file_data; content:"fff|00|MMM|00|333|00 1A 1A 1A 00 99 CC FF 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 04 00 18 00 FF FF 00 D2 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2007-0936; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-030; classtype:attempted-user; sid:33307; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows True Type Font integer overflow attempt"; flow:to_server,established; flowbits:isset,file.ttf; file_data; content:"|03 03 1B 2D 39 00 00 02 01 D5 03 38 03 FD 05 4D 00 21 00 3E 00 09 40 02 37 07 00 2F 2F 30 31 01|"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0059; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-010; classtype:attempted-user; sid:33437; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows True Type Font integer overflow attempt"; flow:to_client,established; flowbits:isset,file.ttf; file_data; content:"|03 03 1B 2D 39 00 00 02 01 D5 03 38 03 FD 05 4D 00 21 00 3E 00 09 40 02 37 07 00 2F 2F 30 31 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0059; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-010; classtype:attempted-user; sid:33436; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Reader CoolType.DLL out-of-bounds memory access attempt"; flow:to_server,established; file_data; file_data; content:"|6A FB 8F 05 F0 06 DA F7 8F 05 0E 60 F9 6A 77 01 99 F7 25 03 F7 AD 4D 15 3A F5 62 F7 30 F7 18 1A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2014-9161; reference:url,www.cvedetails.com/cve/CVE-2014-9161; classtype:attempted-user; sid:33455; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Reader CoolType.DLL out-of-bounds memory access attempt"; flow:to_client,established; file_data; file_data; content:"|6A FB 8F 05 F0 06 DA F7 8F 05 0E 60 F9 6A 77 01 99 F7 25 03 F7 AD 4D 15 3A F5 62 F7 30 F7 18 1A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2014-9161; reference:url,www.cvedetails.com/cve/CVE-2014-9161; classtype:attempted-user; sid:33454; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple OSX Safari format string validation corruption attempt"; flow:to_server,established; file_data; content:"<script"; content:"window.console.log("; distance:0; fast_pattern; content:"|25|n|25|n|25|n"; within:20; pcre:"/window\.console\.log\([^)]*(\x22|\x27)[^\x22\x27]*\x25n\x25n\x25n/smi"; metadata:service smtp; reference:cve,2007-0644; classtype:attempted-user; sid:33526; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple OSX Safari format string validation corruption attempt"; flow:to_client,established; file_data; content:"<script"; content:"window.console.log("; distance:0; fast_pattern; content:"|25|n|25|n|25|n"; within:20; pcre:"/window\.console\.log\([^)]*(\x22|\x27)[^\x22\x27]*\x25n\x25n\x25n/smi"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2007-0644; classtype:attempted-user; sid:33525; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java WebStart JNLP stack buffer overflow attempt"; flow:to_client,established; file_data; content:"<jnlp spec="; fast_pattern:only; content:"codebase=|22|"; isdataat:1150; content:!"|22|"; within:1150; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2007-3655; classtype:attempted-user; sid:33588; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Reader ETB baseurl memory corruption attempt"; flow:established,to_server; file_data; content:"<x-ebx-version>"; fast_pattern:only; content:"<etd-entry>"; content:"<baseurl>"; distance:0; content:"</baseurl>"; distance:0; pcre:"/<baseurl>.*?\x25[cdefginopsux].*?<\x2fbaseurl>/i"; metadata:service smtp; reference:cve,2004-1153; classtype:attempted-user; sid:33572; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Reader ETB baseurl memory corruption attempt"; flow:established,to_client; file_data; content:"<x-ebx-version>"; fast_pattern:only; content:"<etd-entry>"; content:"<baseurl>"; distance:0; content:"</baseurl>"; distance:0; pcre:"/<baseurl>.*?\x25[cdefginopsux].*?<\x2fbaseurl>/i"; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2004-1153; classtype:attempted-user; sid:33571; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Fax Services Cover Page Editor Double Free Memory Corruption attempt"; flow:to_server,established; flowbits:isset,file.cov; file_data; content:"I|00|s|00 20 00|t|00|h|00|i|00|s|00 20 00|w|00|o|00|r|00|t|00|h|00|w|00|h|00|i|00|l|00|e|00|?|00 0A 00 00 00 00 00 FF FE FF|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,45942; reference:cve,2010-4701; classtype:attempted-user; sid:33604; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Fax Services Cover Page Editor Double Free Memory Corruption attempt"; flow:to_client,established; flowbits:isset,file.cov; file_data; content:"I|00|s|00 20 00|t|00|h|00|i|00|s|00 20 00|w|00|o|00|r|00|t|00|h|00|w|00|h|00|i|00|l|00|e|00|?|00 0A 00 00 00 00 00 FF FE FF|"; fast_pattern:only; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,45942; reference:cve,2010-4701; classtype:web-application-attack; sid:33603; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Shockwave Player SwDir.dll PlayerVersion Buffer Overflow attempt"; flow:established,to_server; file_data; content:"233C1507-6A77-46A4-9443-F871F945D258"; fast_pattern:only; nocase; content:"String|28|"; content:"|2E|PlayerVersion"; pcre:"/String\x28\s*\d{5,}\s*\x2C/i"; metadata:service smtp; reference:bugtraq,36434; reference:bugtraq,36905; reference:cve,2009-3244; reference:url,www.adobe.com/support/security/bulletins/apsb09-16.html; classtype:attempted-user; sid:33593; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Player SwDir.dll PlayerVersion Buffer Overflow attempt"; flow:established,to_client; file_data; content:"233C1507-6A77-46A4-9443-F871F945D258"; fast_pattern:only; nocase; content:"String|28|"; content:"|2E|PlayerVersion"; pcre:"/String\x28\s*\d{5,}\s*\x2c/i"; metadata:service ftp-data, service http, service imap, service pop3; reference:bugtraq,36434; reference:bugtraq,36905; reference:cve,2009-3244; reference:url,www.adobe.com/support/security/bulletins/apsb09-16.html; classtype:attempted-user; sid:33592; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Motion OZDocumentparseElement Integer Overflow attempt"; flow:to_client,established; flowbits:isset,file.motn; file_data; content:"<viewer subview=|22|"; isdataat:7; content:!"|22|"; within:7; byte_test:9,>,100000000,0,relative,string; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-6114; classtype:attempted-user; sid:33644; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Motion OZDocumentparseElement Integer Overflow attempt"; flow:to_server,established; flowbits:isset,file.motn; file_data; content:"<viewer subview=|22|"; isdataat:7; content:!"|22|"; within:7; byte_test:9,>,100000000,0,relative,string; metadata:service smtp; reference:cve,2013-6114; classtype:attempted-user; sid:33643; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_server,established; flowbits:isset,file.mid; file_data; content:"MTrk"; content:"|00 FF 03|"; within:3; distance:4; content:"|00 FF 02|"; within:200; content:"|00 FF 01|"; within:200; content:"|00 FF 58 04|"; within:200; fast_pattern; content:"|00 FF 59 02|"; within:8; content:"|00 FF 51 03|"; within:6; content:"|00 FF 2F 00|"; within:7; content:"MTrk"; within:4; pcre:"/MTrk.{4}\x00\xff\x03.{2}\w+\x00\xFF\x02.{2}\w+\x00\xff\x01.{2}\w+\x00\xff\x58\x04.{4}\x00\xff\x59\x02.{2}\x00\xff\x51\x03.{3}\x00\xff\x2f\x00MTrk/"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:33684; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Executable disguised as PIF file"; flow:to_client,established; flowbits:isset,file.pif; content:"MZ"; depth:2; metadata:service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/en/file/b534938079ff900c245c319cda47d924bd154fd5fab57166a061a0510470a496/analysis/; classtype:attempted-user; sid:33669; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows jxr information disclosure attempt"; flow:to_server,established; file_data; content:"|49 49 BC 01|"; depth:4; content:"|09 09 A0 00 04 6F FF 00 01 00 00 01 00 87 C0 00 20 43 40 C8 20 61 C4 5A 2C DF DF DF DF DF DF DF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0076; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-029; classtype:attempted-user; sid:33772; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows jxr information disclosure attempt"; flow:to_client,established; file_data; content:"|49 49 BC 01|"; depth:4; content:"|09 09 A0 00 04 6F FF 00 01 00 00 01 00 87 C0 00 20 43 40 C8 20 61 C4 5A 2C DF DF DF DF DF DF DF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0076; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-029; classtype:attempted-user; sid:33771; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft OpenType font atlmfd.dll uninitialized memory read attempt"; flow:to_server,established; file_data; content:"|06 BC 07 0A 06 BC 06 A8 06 A8 01 5E 06 9C 05 3B 01 4A 03 9E 05 BC 04 E1 05 1D 05 5A 04 34 05 36 05 23 04 42 04 88 04 C5 03 8F 05 DB 06 23 06 64|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0089; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-021; classtype:attempted-admin; sid:33733; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft OpenType font atlmfd.dll uninitialized memory read attempt"; flow:to_client,established; file_data; content:"|06 BC 07 0A 06 BC 06 A8 06 A8 01 5E 06 9C 05 3B 01 4A 03 9E 05 BC 04 E1 05 1D 05 5A 04 34 05 36 05 23 04 42 04 88 04 C5 03 8F 05 DB 06 23 06 64|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0089; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-021; classtype:attempted-admin; sid:33732; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Type 1 font blend operator negative operand code execution attempt"; flow:to_server,established; flowbits:isset,file.psfont; file_data; content:"|7C 93 40 4C DF 37 1D BC F1 DB DB 33 B8 83 32 71|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0093; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-021; classtype:attempted-user; sid:33725; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Type 1 font blend operator negative operand code execution attempt"; flow:to_client,established; flowbits:isset,file.psfont; file_data; content:"|7C 93 40 4C DF 37 1D BC F1 DB DB 33 B8 83 32 71|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0093; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-021; classtype:attempted-user; sid:33724; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Type 1 font memory out-of-bounds read attempt"; flow:to_server,established; file_data; content:"|2B 81 BB 49 EF 16 91 94 12 E4 8F 18 28 45 2C 7D 5B 5F 98 D3 1B 0D 57 5C 56 5A 29 0A 8A 5F 32 85|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0092; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-021; classtype:attempted-user; sid:33723; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Type 1 font memory out-of-bounds read attempt"; flow:to_client,established; file_data; content:"|2B 81 BB 49 EF 16 91 94 12 E4 8F 18 28 45 2C 7D 5B 5F 98 D3 1B 0D 57 5C 56 5A 29 0A 8A 5F 32 85|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0092; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-021; classtype:attempted-user; sid:33722; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 35 (msg:"FILE-OTHER Microsoft Office RTF out-of-bounds memory access attempt"; flow:to_server,established; flowbits:isset,file.rtf; file_data; content:"|5C|dppolyline|5C|dppolyline"; content:"|5C|dppolycount"; within:200; content:"|5C|dptxbx|5C|dptxbx"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0086; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-022; classtype:attempted-user; sid:33706; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office RTF out-of-bounds memory access attempt"; flow:to_client,established; flowbits:isset,file.rtf; file_data; content:"|5C|dppolyline|5C|dppolyline"; content:"|5C|dppolycount"; within:200; content:"|5C|dptxbx|5C|dptxbx"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0086; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-022; classtype:attempted-user; sid:33705; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_server,established; file_data; content:"|FF|WPC"; depth:4; content:"|07 00|"; within:2; distance:52; byte_test:2,>,0xfffc,0,relative,little; metadata:service smtp; reference:cve,2004-0573; classtype:attempted-user; sid:33959; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_server,established; file_data; content:"|FF|WPC"; depth:4; content:"|07 00|"; within:2; distance:42; byte_test:2,>,0xfffc,0,relative,little; metadata:service smtp; reference:cve,2004-0573; classtype:attempted-user; sid:33958; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_server,established; file_data; content:"|FF|WPC"; depth:4; content:"|07 00|"; within:2; distance:32; byte_test:2,>,0xfffc,0,relative,little; metadata:service smtp; reference:cve,2004-0573; classtype:attempted-user; sid:33957; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_server,established; file_data; content:"|FF|WPC"; depth:4; content:"|07 00|"; within:2; distance:22; byte_test:2,>,0xfffc,0,relative,little; metadata:service smtp; reference:cve,2004-0573; classtype:attempted-user; sid:33956; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_server,established; file_data; content:"|FF|WPC"; depth:4; byte_jump:4,18,relative,little,from_beginning; content:"|07 00|"; within:2; distance:40; byte_test:2,>,0xfffc,0,relative,little; metadata:service smtp; reference:cve,2004-0573; classtype:attempted-user; sid:33955; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_server,established; file_data; content:"|FF|WPC"; depth:4; byte_jump:4,18,relative,little,from_beginning; content:"|07 00|"; within:2; distance:30; byte_test:2,>,0xfffc,0,relative,little; metadata:service smtp; reference:cve,2004-0573; classtype:attempted-user; sid:33954; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_server,established; file_data; content:"|FF|WPC"; depth:4; byte_jump:4,18,relative,little,from_beginning; content:"|07 00|"; within:2; distance:20; byte_test:2,>,0xfffc,0,relative,little; metadata:service smtp; reference:cve,2004-0573; classtype:attempted-user; sid:33953; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_server,established; file_data; content:"|FF|WPC"; depth:4; byte_jump:4,18,relative,little,from_beginning; content:"|07 00|"; within:2; distance:10; byte_test:2,>,0xfffc,0,relative,little; metadata:service smtp; reference:cve,2004-0573; classtype:attempted-user; sid:33952; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_client,established; file_data; content:"|FF|WPC"; depth:4; content:"|07 00|"; within:2; distance:52; byte_test:2,>,0xfffc,0,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2004-0573; classtype:attempted-user; sid:33951; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_client,established; file_data; content:"|FF|WPC"; depth:4; content:"|07 00|"; within:2; distance:42; byte_test:2,>,0xfffc,0,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2004-0573; classtype:attempted-user; sid:33950; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_client,established; file_data; content:"|FF|WPC"; depth:4; content:"|07 00|"; within:2; distance:32; byte_test:2,>,0xfffc,0,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2004-0573; classtype:attempted-user; sid:33949; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_client,established; file_data; content:"|FF|WPC"; depth:4; content:"|07 00|"; within:2; distance:22; byte_test:2,>,0xfffc,0,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2004-0573; classtype:attempted-user; sid:33948; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_client,established; file_data; content:"|FF|WPC"; depth:4; byte_jump:4,18,relative,little,from_beginning; content:"|07 00|"; within:2; distance:40; byte_test:2,>,0xfffc,0,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2004-0573; classtype:attempted-user; sid:33947; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_client,established; file_data; content:"|FF|WPC"; depth:4; byte_jump:4,18,relative,little,from_beginning; content:"|07 00|"; within:2; distance:30; byte_test:2,>,0xfffc,0,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2004-0573; classtype:attempted-user; sid:33946; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_client,established; file_data; content:"|FF|WPC"; depth:4; byte_jump:4,18,relative,little,from_beginning; content:"|07 00|"; within:2; distance:20; byte_test:2,>,0xfffc,0,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2004-0573; classtype:attempted-user; sid:33945; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER WordPerfect converter buffer overflow attempt"; flow:to_client,established; file_data; content:"|FF|WPC"; depth:4; byte_jump:4,18,relative,little,from_beginning; content:"|07 00|"; within:2; distance:10; byte_test:2,>,0xfffc,0,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2004-0573; classtype:attempted-user; sid:33944; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft emf small header overwrite attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|50 00 00 00|"; byte_test:4,<,0x28,48,relative,little; metadata:service smtp; reference:cve,2015-1645; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-035; classtype:attempted-user; sid:34083; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft emf small header overwrite attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|50 00 00 00|"; byte_test:4,<,0x28,48,relative,little; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2015-1645; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-035; classtype:attempted-user; sid:34082; rev:1;)
